<!DOCTYPE html>

<html lang="zh-CN">

<head>
    
    <title>学习总结（2022.06.15-2022.06.24） - Ykuri的小角落</title>
    <meta charset="UTF-8">
    <meta name="keywords" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5">
    
    

    <link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/Ykuri98/image_repository@latest/avatar.png" type="image/x-icon" />
    <meta name="description" content="动态代理JDK动态代理JDK动态代理是基于Java的反射机制实现的，使用jdk中的接口和类实现代理对象的动态创建，但是要求代理对象必须实现接口。 JDK动态代理的实现步骤如下。  新建一个接口，作为目标接口。  1234public interface UserService &amp;#123;    public void sayHello();&amp;#125;   为接口创建实现类。  12345678">
<meta property="og:type" content="article">
<meta property="og:title" content="学习总结（2022.06.15-2022.06.24）">
<meta property="og:url" content="https://ykuri98.github.io/2022/07/04/%E5%AD%A6%E4%B9%A0%E6%80%BB%E7%BB%93%EF%BC%882022-06-15-2022-06-24%EF%BC%89/index.html">
<meta property="og:site_name" content="Ykuri的小角落">
<meta property="og:description" content="动态代理JDK动态代理JDK动态代理是基于Java的反射机制实现的，使用jdk中的接口和类实现代理对象的动态创建，但是要求代理对象必须实现接口。 JDK动态代理的实现步骤如下。  新建一个接口，作为目标接口。  1234public interface UserService &amp;#123;    public void sayHello();&amp;#125;   为接口创建实现类。  12345678">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2022-07-04T11:30:04.000Z">
<meta property="article:modified_time" content="2022-07-05T15:07:09.375Z">
<meta property="article:author" content="Ykuri98">
<meta property="article:tag" content="JavaEE">
<meta property="article:tag" content="Spring">
<meta name="twitter:card" content="summary">
    <link
        rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css"
    />
    <link
        rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"
    />
    
    <link rel="stylesheet" href="/lib/mdui_043tiny/css/mdui.css?v=1693554741061">
    <link rel="stylesheet" href="/lib/iconfont/iconfont.css?v=1693554741061">
    <link rel="stylesheet" href="/css/style.css?v=1693554741061">
     
    
<meta name="generator" content="Hexo 6.1.0"></head>

<body class="mdui-drawer-body-left">
    
    <div id="nexmoe-background">
        <div class="nexmoe-bg" style="background-image: url(https://cdn.jsdelivr.net/gh/Ykuri98/image_repository@latest/wallpaper.png)"></div>
        <div class="mdui-appbar mdui-shadow-0">
            <div class="mdui-toolbar">
                <a mdui-drawer="{target: '#drawer', swipe: true}" title="menu" class="mdui-btn mdui-btn-icon mdui-ripple"><i class="mdui-icon nexmoefont icon-menu"></i></a>
                <div class="mdui-toolbar-spacer"></div>
                <!--<a href="javascript:;" class="mdui-btn mdui-btn-icon"><i class="mdui-icon material-icons">search</i></a>-->
                <a href="/" title="Ykuri98" class="mdui-btn mdui-btn-icon"><img src="https://cdn.jsdelivr.net/gh/Ykuri98/image_repository@latest/avatar.png" alt="Ykuri98"></a>
            </div>
        </div>
    </div>
    <div id="nexmoe-header">
        <div class="nexmoe-drawer mdui-drawer" id="drawer">
    <div class="nexmoe-avatar mdui-ripple">
        <a href="/" title="Ykuri98">
            <img src="https://cdn.jsdelivr.net/gh/Ykuri98/image_repository@latest/avatar.png" alt="Ykuri98" alt="Ykuri98">
        </a>
    </div>
    <div class="nexmoe-count">
        <div><span>文章</span>46</div>
        <div><span>标签</span>14</div>
        <div><span>分类</span>1</div>
    </div>
    <div class="nexmoe-list mdui-list" mdui-collapse="{accordion: true}">
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/" title="回到首页">
            <i class="mdui-list-item-icon nexmoefont icon-home"></i>
            <div class="mdui-list-item-content">
                回到首页
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/archive.html" title="文章归档">
            <i class="mdui-list-item-icon nexmoefont icon-container"></i>
            <div class="mdui-list-item-content">
                文章归档
            </div>
        </a>
        
    </div>
    <aside id="nexmoe-sidebar">
    
    <div class="nexmoe-widget-wrap">
    <div class="nexmoe-widget nexmoe-search">
        
            <form id="search_form">
                <label><input class="st-default-search-input" id="search_value" name="q" type="search" placeholder="搜索" style="
                    font-size: 15px !important;
                    height: 56px !important;
                    background-image: none;
                "></label>
            </form>
         
    </div>
</div>
    
    <div class="nexmoe-widget-wrap">
    <div class="nexmoe-widget nexmoe-social">
        <a class="mdui-ripple" href="https://github.com/Ykuri98/" target="_blank" mdui-tooltip="{content: 'GitHub'}" style="color: rgb(25, 23, 23);background-color: rgba(25, 23, 23, .15);">
            <i class="nexmoefont icon-github"></i>
        </a>
    </div>
</div>
    
    
  <div class="nexmoe-widget-wrap">
    <h3 class="nexmoe-widget-title">文章分类</h3>
    <div class="nexmoe-widget">

      <ul class="category-list">

        


        

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/技术/">技术</a>
          <span class="category-list-count">45</span>
        </li>

        
      </ul>

    </div>
  </div>


    
    
  <div class="nexmoe-widget-wrap">
    <div id="randomtagcloud" class="nexmoe-widget tagcloud nexmoe-rainbow">
      <a href="/tags/JavaEE/" style="font-size: 15px;">JavaEE</a> <a href="/tags/Kafka/" style="font-size: 10px;">Kafka</a> <a href="/tags/Nacos/" style="font-size: 10px;">Nacos</a> <a href="/tags/Oracle/" style="font-size: 10px;">Oracle</a> <a href="/tags/RabbitMQ/" style="font-size: 10px;">RabbitMQ</a> <a href="/tags/SQL/" style="font-size: 15px;">SQL</a> <a href="/tags/Spring/" style="font-size: 10px;">Spring</a> <a href="/tags/github/" style="font-size: 10px;">github</a> <a href="/tags/hexo/" style="font-size: 12.5px;">hexo</a> <a href="/tags/java/" style="font-size: 17.5px;">java</a> <a href="/tags/%E5%89%8D%E7%AB%AF/" style="font-size: 10px;">前端</a> <a href="/tags/%E5%B7%A5%E5%85%B7/" style="font-size: 10px;">工具</a> <a href="/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1/" style="font-size: 10px;">微服务</a> <a href="/tags/%E7%AE%97%E6%B3%95/" style="font-size: 20px;">算法</a>
    </div>
    
  </div>

    
    
  <div class="nexmoe-widget-wrap">
    <h3 class="nexmoe-widget-title">文章归档</h3>
    <div class="nexmoe-widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/">2023</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/">2022</a><span class="archive-list-count">39</span></li></ul>
    </div>
  </div>



    
    
  <div class="nexmoe-widget-wrap">
    <h3 class="nexmoe-widget-title">最新文章</h3>
    <div class="nexmoe-widget">
      <ul>
        
          <li>
            <a href="/2023/09/01/%E8%AE%B0%E4%B8%80%E6%AC%A1Oracle-SQL%E8%B0%83%E4%BC%98/">记一次Oracle SQL调优</a>
          </li>
        
          <li>
            <a href="/2023/09/01/%E8%AE%B0%E4%B8%80%E6%AC%A1Nacos%E9%85%8D%E7%BD%AE%E8%BF%81%E7%A7%BB%E4%B8%8E%E6%9B%B4%E6%94%B9/">记一次Nacos配置迁移与更改</a>
          </li>
        
          <li>
            <a href="/2023/09/01/RabbitMQ%E6%B6%88%E8%B4%B9%E5%A4%9A%E4%B8%AA%E9%9B%86%E7%BE%A4%E7%9A%84%E6%B6%88%E6%81%AF/">RabbitMQ消费多个集群的消息</a>
          </li>
        
          <li>
            <a href="/2023/09/01/%E5%B7%A5%E4%BD%9C%E4%B8%AD%E7%9A%84%E4%B8%80%E4%BA%9B%E5%B0%8F%E9%97%AE%E9%A2%98%EF%BC%88%E6%8C%81%E7%BB%AD%E6%9B%B4%E6%96%B0%EF%BC%89/">工作中的一些小问题（持续更新）</a>
          </li>
        
          <li>
            <a href="/2023/09/01/%E5%85%B3%E4%BA%8E%E7%BD%91%E5%85%B3%E8%B6%85%E6%97%B6%E7%9A%84%E4%B8%80%E4%BA%9B%E6%80%9D%E8%80%83%E4%B8%8E%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/">关于网关超时的一些思考与解决方案</a>
          </li>
        
      </ul>
    </div>
  </div>

    
</aside>
    <div class="nexmoe-copyright">
        &copy; 2023 Ykuri98
        Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
        & <a href="https://github.com/theme-nexmoe/hexo-theme-nexmoe" target="_blank">Nexmoe</a>
        
    </div>
</div><!-- .nexmoe-drawer -->
    </div>
    <div id="nexmoe-content">
        <div class="nexmoe-primary">
            <div class="nexmoe-post">

  <article>
      
          <div class="nexmoe-post-cover" style="padding-bottom: 56.25%;"> 
              <img data-fancybox="gallery" src="https://cdn.jsdelivr.net/gh/Ykuri98/image_repository@latest/wallpaper.png" alt="学习总结（2022.06.15-2022.06.24）" loading="lazy">
              <h1>学习总结（2022.06.15-2022.06.24）</h1>
          </div>
      
      
      <div class="nexmoe-post-meta nexmoe-rainbow" style="margin:10px 0!important;">
    <a><i class="nexmoefont icon-calendar-fill"></i>2022年07月04日</a>
</div>

      <h2 id="动态代理"><a href="#动态代理" class="headerlink" title="动态代理"></a>动态代理</h2><h3 id="JDK动态代理"><a href="#JDK动态代理" class="headerlink" title="JDK动态代理"></a>JDK动态代理</h3><p>JDK动态代理是基于Java的反射机制实现的，使用jdk中的接口和类实现代理对象的动态创建，但是要求代理对象必须实现接口。</p>
<p>JDK动态代理的实现步骤如下。</p>
<ol>
<li>新建一个接口，作为目标接口。</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">UserService</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">sayHello</span><span class="hljs-params">()</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<ol start="2">
<li>为接口创建实现类。</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserServiceImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">UserService</span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">sayHello</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;hello spring&quot;</span>);<br>    &#125;<br>    <br>&#125;<br></code></pre></td></tr></table></figure>

<ol start="3">
<li>创建一个类实现InvocationHandler接口及其invoke方法，在<code>method.invoke()</code>前后执行对方法的增强。</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CustomInvocationHandler</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">InvocationHandler</span> &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">invoke</span><span class="hljs-params">(Object proxy, Method method, Object[] args)</span> <span class="hljs-keyword">throws</span> Throwable &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<ol start="4">
<li>在main方法中调用<code>Proxy.newProxyInstance()</code>创建JDK动态代理，使用代理对象执行方法。</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">mytest4</span><span class="hljs-params">()</span> &#123;<br>       <span class="hljs-type">UserService</span> <span class="hljs-variable">instance</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UserServiceImpl</span>(); <span class="hljs-comment">// instance 👉 method.invoke(instance,args);</span><br>       <span class="hljs-comment">// UserServiceImpl 👉 sayHello</span><br>       <span class="hljs-comment">// Proxy 👉 sayHello</span><br>       <span class="hljs-type">UserService</span> <span class="hljs-variable">userServiceProxy</span> <span class="hljs-operator">=</span> (UserService) Proxy.newProxyInstance(UserServiceImpl.class.getClassLoader(),<br>               UserServiceImpl.class.getInterfaces(),<br>               <span class="hljs-keyword">new</span> <span class="hljs-title class_">InvocationHandler</span>() &#123;<br>                   <span class="hljs-meta">@Override</span><br>                   <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">invoke</span><span class="hljs-params">(Object proxy, Method method, Object[] args)</span> <span class="hljs-keyword">throws</span> Throwable &#123;<br>                       <span class="hljs-comment">//jdsfkhjasdjyr</span><br>                       System.out.println(<span class="hljs-string">&quot;jdsfkhjasdjyr&quot;</span>);<br>                       <span class="hljs-type">Object</span> <span class="hljs-variable">invoke</span> <span class="hljs-operator">=</span> method.invoke(instance, args);<br>                       <span class="hljs-comment">//dfjkasdhjfisdya</span><br>                       System.out.println(<span class="hljs-string">&quot;dfjkasdhjfisdya&quot;</span>);<br>                       <span class="hljs-keyword">return</span> invoke;<br>                   &#125;<br>               &#125;);<br>       userServiceProxy.sayHello();<span class="hljs-comment">//invocationHandler.invoke</span><br>   &#125;<br></code></pre></td></tr></table></figure>

<h3 id="Cglib动态代理"><a href="#Cglib动态代理" class="headerlink" title="Cglib动态代理"></a>Cglib动态代理</h3><p>Cglib动态代理只针对类实现代理，不需要实现接口。</p>
<p>Cglib动态代理的实现步骤如下。</p>
<ol>
<li>创建一个类实现MethodInterceptor接口及其<code>intercept</code>方法。</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyMethodInterceptor</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">MethodInterceptor</span> &#123;<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * cglib</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> o cglib生成的代理对象</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> method 被代理对象的方法</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> objects 方法入参</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> methodProxy 代理方法</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span></span><br><span class="hljs-comment">     * <span class="hljs-doctag">@throws</span> Throwable</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">intercept</span><span class="hljs-params">(Object o, Method method, Object[] objects, MethodProxy methodProxy)</span> <span class="hljs-keyword">throws</span> Throwable &#123;<br>        System.out.println(<span class="hljs-string">&quot;before advice...&quot;</span>);<br>        <span class="hljs-type">Object</span> <span class="hljs-variable">object</span> <span class="hljs-operator">=</span> methodProxy.invokeSuper(o, objects);<br>        System.out.println(<span class="hljs-string">&quot;after advice...&quot;</span>);<br>        <span class="hljs-keyword">return</span> object;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<ol start="2">
<li>在main方法中，通过Enhancer获取代理对象。</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Main</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-comment">//通过CGLIB动态代理获取代理对象的过程</span><br>        <span class="hljs-type">Enhancer</span> <span class="hljs-variable">enhancer</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Enhancer</span>();<br>        <span class="hljs-comment">//设置enhancer对象的父类</span><br>        enhancer.setSuperclass(HelloService.class);<br>        <span class="hljs-comment">//设置enhancer的回调对象</span><br>        enhancer.setCallback(<span class="hljs-keyword">new</span> <span class="hljs-title class_">MyMethodInterceptor</span>());<br>        <span class="hljs-comment">//创建代理对象</span><br>        <span class="hljs-type">HelloService</span> <span class="hljs-variable">proxy</span> <span class="hljs-operator">=</span> (HelloService) enhancer.create();<br>        <span class="hljs-comment">//通过代理对象调用目标方法</span><br>        proxy.sayHello();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="IOC-x2F-DI"><a href="#IOC-x2F-DI" class="headerlink" title="IOC&#x2F;DI"></a>IOC&#x2F;DI</h2><p>IOC，控制反转，将生成实例的控制权交由Spring容器，容器只控制实例的生成，而开发人员只需要往容器中注册需要生成实例的类，即组件，并在需要时取出该组件的对象即可。</p>
<p>DI，依赖注入，即具体的IOC实现方式。一般通过配置文件和注解来完成依赖注入。</p>
<h3 id="XML"><a href="#XML" class="headerlink" title="XML"></a>XML</h3><p>在Spring的XML文件中注册组件。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--注册组件 → 提供信息 → 向容器中放入实例--&gt;</span><br><span class="hljs-comment">&lt;!--id属性：组件在容器中的唯一标识 → 可以省略--&gt;</span><br><span class="hljs-comment">&lt;!--class属性：组件的全限定类名--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;userDao&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.cskaoyan.dao.UserDaoImpl&quot;</span>/&gt;</span><br><br><span class="hljs-comment">&lt;!--set方法来维护组件之间的关系--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;userService&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.cskaoyan.service.UserServiceImpl&quot;</span>&gt;</span><br>    <span class="hljs-comment">&lt;!--property标签的name属性 → set方法--&gt;</span><br>    <span class="hljs-comment">&lt;!--ref属性：reference → 容器中的组件id--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;userDao&quot;</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;userDao&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;orderService&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.cskaoyan.service.OrderServiceImpl&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;userDao&quot;</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;userDao&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>取出组件。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">mytest1</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-comment">// 初始化Spring容器</span><br>    <span class="hljs-type">ApplicationContext</span> <span class="hljs-variable">applicationContext</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ClassPathXmlApplicationContext</span>(<span class="hljs-string">&quot;application.xml&quot;</span>);<br><br>    <span class="hljs-comment">// 通过id取出组件</span><br>    <span class="hljs-type">UserDao</span> <span class="hljs-variable">userDao</span> <span class="hljs-operator">=</span> (UserDao) applicationContext.getBean(<span class="hljs-string">&quot;userDao&quot;</span>);<br>    <span class="hljs-comment">// 通过类型取出组件byType → class 可以写接口、实现类 → 该类型的组件在容器中只有一个</span><br>    <span class="hljs-comment">// 建议用接口</span><br>    <span class="hljs-type">UserService</span> <span class="hljs-variable">userService1</span> <span class="hljs-operator">=</span> applicationContext.getBean(UserService.class);<br>    <span class="hljs-type">UserService</span> <span class="hljs-variable">userService2</span> <span class="hljs-operator">=</span> applicationContext.getBean(UserServiceImpl.class);<br><br>    <span class="hljs-comment">// 通过id和类型共同取出</span><br>    <span class="hljs-type">OrderService</span> <span class="hljs-variable">orderService</span> <span class="hljs-operator">=</span> applicationContext.getBean(<span class="hljs-string">&quot;orderService&quot;</span>, OrderService.class);<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="注解"><a href="#注解" class="headerlink" title="注解"></a>注解</h3><p>也可以使用注解注册组件。可以在注解中指定组件id，也可以使用默认的组件id，默认id一般为类名的首字母小写。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// 通用注解</span><br><span class="hljs-meta">@Component</span><br><br><span class="hljs-comment">// service层</span><br><span class="hljs-meta">@Service</span><br><br><span class="hljs-comment">// dao层</span><br><span class="hljs-meta">@Repository</span><br><br><span class="hljs-comment">// controller层</span><br><span class="hljs-meta">@Controller</span><br></code></pre></td></tr></table></figure>

<h3 id="配置类"><a href="#配置类" class="headerlink" title="配置类"></a>配置类</h3><p>在一个类上加上@Configuration注解，表示该类被注册为一个组件，且该类为一个配置类。类中的方法可以被@Bean注解修饰，表示该方法的返回值的实例会被注册为一个组件。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Configuration</span><br><span class="hljs-comment">// @ComponentScan注解表示扫描指定包下的所有类，并将带有@Component等相关注解的类注册为组件</span><br><span class="hljs-meta">@ComponentScan(&quot;com.cskaoyan&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SpringConfiguration</span> &#123;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 返回值类型：Spring容器中的组件类型</span><br><span class="hljs-comment">     * 返回值：返回值注册为容器中的组件</span><br><span class="hljs-comment">     * 组件ID：默认值是方法名；如果想要指定组件id，可以使用<span class="hljs-doctag">@Bean</span>的value属性</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Bean(&quot;druidDatasource&quot;)</span><br>    <span class="hljs-keyword">public</span> DataSource <span class="hljs-title function_">dataSource</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-type">DruidDataSource</span> <span class="hljs-variable">dataSource</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DruidDataSource</span>();<br>        dataSource.setDriverClassName(<span class="hljs-string">&quot;com.mysql.jdbc.Driver&quot;</span>);<br>        dataSource.setUrl(<span class="hljs-string">&quot;jdbc:mysql://localhost:3306/cskaoyan_db&quot;</span>);<br>        dataSource.setUsername(<span class="hljs-string">&quot;root&quot;</span>);<br>        dataSource.setPassword(<span class="hljs-string">&quot;123456&quot;</span>);<br><br>        <span class="hljs-keyword">return</span> dataSource;<br>    &#125;<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 形参：默认按照类型从容器中取出组件;想要指定组件id → <span class="hljs-doctag">@Qualifier</span></span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-comment">// 注册一个UserServiceImpl组件</span><br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-keyword">public</span> UserService <span class="hljs-title function_">userService</span><span class="hljs-params">(<span class="hljs-meta">@Qualifier(&quot;userDaoImpl&quot;)</span> UserDao userDao)</span> &#123;<br>        <span class="hljs-type">UserServiceImpl</span> <span class="hljs-variable">userService</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UserServiceImpl</span>();<br>        <span class="hljs-comment">// 从容器中取出userDao并且给其赋值</span><br>        userService.setUserDao(userDao);<br>        <span class="hljs-keyword">return</span> userService;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="Autowired"><a href="#Autowired" class="headerlink" title="@Autowired"></a>@Autowired</h3><p>类中的成员变量可以通过@Autowired注解注册为组件，此时该成员变量就不需要开发人员手动初始化。@Autowired的本质是利用容器提供的set方法。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Autowired</span><br><span class="hljs-comment">// 如果该类型的组件不止一个，需要使用@Qualifier来指定组件的id</span><br><span class="hljs-meta">@Qualifier(&quot;userDaoImpl2&quot;)</span><br>UserDao userDao;<br></code></pre></td></tr></table></figure>

<h2 id="组件的生命周期"><a href="#组件的生命周期" class="headerlink" title="组件的生命周期"></a>组件的生命周期</h2><p>组件可以使用@Scope注解来确定自己的作用域。如果作用域为singleton，即单例模式，那么每次从容器中取出的组件都是同一个组件；如果使用的是prototype，即原型模式，那么每次取出的都是新的实例。Spring默认使用单例模式。</p>
<p>在单例模式下，容器初始化时就会开始组件的生命周期；如果是原型模式，则只有在获得组件时才开始生命周期。</p>
<p>组件的生命周期如下。</p>
<ol>
<li><p>实例化。</p>
</li>
<li><p>给成员变量赋值。一般通过@Autowired等注解实现。</p>
</li>
<li><p>觉醒（Aware），如果组件实现了Aware相关的接口，在这时组件就可以通过该接口的set方法设置一些数据。比如，如果组件实现了<code>BeanNameAware</code>接口，那么就可以调用<code>setBeanName(String beanName)</code>方法。</p>
</li>
<li><p>BeanPostProcessor，提供了两个实现方法：<code>postProcessBeforeInitialization</code>和<code>postProcessAfterInitialization</code>，其作用范围为所有注册的组件。此时触发的是before方法。</p>
</li>
<li><p>InitializingBean的afterPropertiesSet方法 ，或是自定义的init方法。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">afterPropertiesSet</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>    System.out.println(<span class="hljs-string">&quot;InitializingBean提供的init方法&quot;</span>);<br>&#125;<br><br><span class="hljs-comment">// 自定义init方法，方法名自己定义</span><br><span class="hljs-meta">@PostConstruct</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">init</span><span class="hljs-params">()</span> &#123;<br>    System.out.println(<span class="hljs-string">&quot;自定义init&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure>
</li>
<li><p>BeanPostProcessor的after方法。</p>
</li>
<li><p>使用组件。</p>
</li>
<li><p>DisposableBean的destroy方法，或是自定义的destroy方法。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">destroy</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>    System.out.println(<span class="hljs-string">&quot;DisposableBean提供的destroy&quot;</span>);<br>&#125;<br><br><span class="hljs-meta">@PreDestroy</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">customDestroy</span><span class="hljs-params">()</span> &#123;<br>    System.out.println(<span class="hljs-string">&quot;自定义destroy&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure></li>
</ol>
<h2 id="AOP"><a href="#AOP" class="headerlink" title="AOP"></a>AOP</h2><p>AOP，面向切面编程，可以将一些与业务无关，但是所有业务都需要调用的逻辑封装起来（如日志，权限控制等），将其作为一种增强。AOP基于动态代理实现，但是相比动态代理，AOP可以更灵活的筛选需要增强的方法以及增强所要做的业务。</p>
<p>现在一般使用AspectJ框架实现AOP。</p>
<h3 id="切入点Pointcut"><a href="#切入点Pointcut" class="headerlink" title="切入点Pointcut"></a>切入点Pointcut</h3><p>使用execution指定需要增强的方法。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">aop:comfig</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">aop:pointcut</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;mypointcut1&quot;</span> <span class="hljs-attr">expression</span>=<span class="hljs-string">&quot;execution(public void</span></span><br><span class="hljs-string"><span class="hljs-tag">com.cskaoyan.service.UserServiceImpl.sayHello(String))&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">aop:pointcut</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;mypointcut2&quot;</span> <span class="hljs-attr">expression</span>=<span class="hljs-string">&quot;execution(* co*..say*(*))&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">aop:pointcut</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;mypointcut3&quot;</span> <span class="hljs-attr">expression</span>=<span class="hljs-string">&quot;execution(*</span></span><br><span class="hljs-string"><span class="hljs-tag">co*.cskaoyan..UserServiceImpl.sayHello(..))&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">aop:config</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>使用@annotation指定特殊的增强方法。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Retention(RetentionPolicy.RUNTIME)</span><br><span class="hljs-meta">@Target(ElementType.METHOD)</span><br><span class="hljs-keyword">public</span> <span class="hljs-meta">@interface</span> CountTime &#123;<br>&#125;<br></code></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">aop:config</span>&gt;</span><br><span class="hljs-comment">&lt;!--作用场景：组件中的方法，包含自定义@CountTime注解的方法生效--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">aop:pointcut</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;mypointcut&quot;</span></span><br><span class="hljs-tag"><span class="hljs-attr">expression</span>=<span class="hljs-string">&quot;@annotation(com.cskaoyan.CountTime)&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">aop:config</span>&gt;</span><br></code></pre></td></tr></table></figure>

<h3 id="通知器Advisor"><a href="#通知器Advisor" class="headerlink" title="通知器Advisor"></a>通知器Advisor</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--advisor → 新的标签 aop标签 → 引入aop的schema约束--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">aop:config</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">aop:advisor</span> <span class="hljs-attr">advice-ref</span>=<span class="hljs-string">&quot;countTimeInterceptor&quot;</span> <span class="hljs-attr">pointcut</span>=<span class="hljs-string">&quot;execution(public void com.cskaoyan.service.UserServiceImpl.sayHello(String))&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">aop:config</span>&gt;</span><br></code></pre></td></tr></table></figure>

<h3 id="切面Aspect"><a href="#切面Aspect" class="headerlink" title="切面Aspect"></a>切面Aspect</h3><p>切面是上面两种的结合，即在指定的切入点写入自定义的通知。切面有五个通知方法，分别是Before、After、Around、AfterReturning、AfterThrowing。Before和After表示在该方法的执行前后的通知；Around类似于InvocationHandler的<code>invoke()</code>和MethodInterceptor的<code>invoke()</code>，可以在执行proceed方法前后进行操作，Around也是使用的最多的通知；AfterReturning是在方法返回值后使用的通知，可以接收方法的返回值；AfterThrowing是在方法抛出异常后使用的通知，可以接收方法的异常。</p>
<p>五个通知的先后顺序是：Before-&gt;Around-&gt;After&#x2F;AfterThrowing-&gt;AfterReturning</p>
<p>可以使用@Aspect注解指定一个组件为切面组件，且在类中的方法要使用@Before、@After、@Around、@AfterReturning、@AfterThrowing注解修饰方法。</p>
<p>@Aspect<br>@Component<br>public class CustomAspect {</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Aspect</span><br><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CustomAspect</span> &#123;<br><br>    <span class="hljs-comment">//@Pointcut注解增加在方法上 → value属性写切入点表达式，方法名作为切入点的id</span><br>    <span class="hljs-meta">@Pointcut(&quot;execution(* com.cskaoyan.service..*(..))&quot;)</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">servicePointcut</span><span class="hljs-params">()</span> &#123;<br>    &#125;<br><br>    <span class="hljs-comment">// 切面组件中的方法，作为对应的通知方法 → 在对应的时间点下会执行到对应的方法</span><br>    <span class="hljs-comment">// 通知注解的value属性：可以直接写切入点表达式；也可以引用切入点方法</span><br>    <span class="hljs-meta">@Before(&quot;servicePointcut()&quot;)</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">beforex</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;before方法&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@After(&quot;servicePointcut()&quot;)</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">after</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;after通知方法&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-comment">// Around通知 → 最强通知 ：返回值为Object，要有委托类方法的执行</span><br>    <span class="hljs-comment">// 类似于InvocationHandler的invoke，类似于MethodInterceptor的invoke</span><br>    <span class="hljs-comment">// 执行委托类的方法：ProceedingJoinPoint proceed方法</span><br>    <span class="hljs-meta">@Around(&quot;servicePointcut()&quot;)</span><br>    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">around</span><span class="hljs-params">(ProceedingJoinPoint joinPoint)</span> <span class="hljs-keyword">throws</span> Throwable &#123;<br>        <span class="hljs-type">long</span> <span class="hljs-variable">start</span> <span class="hljs-operator">=</span> System.currentTimeMillis();<br>        System.out.println(<span class="hljs-string">&quot;开始时间：&quot;</span> + start);<br><br>        <span class="hljs-type">Object</span> <span class="hljs-variable">proceed</span> <span class="hljs-operator">=</span> joinPoint.proceed(); <span class="hljs-comment">// 执行委托类的方法</span><br><br>        <span class="hljs-type">long</span> <span class="hljs-variable">end</span> <span class="hljs-operator">=</span> System.currentTimeMillis();<br>        System.out.println(<span class="hljs-string">&quot;方法执行时间：&quot;</span> + (end - start));<br>        <span class="hljs-keyword">return</span> proceed; <span class="hljs-comment">// 就是作为代理对象执行方法的返回值</span><br>    &#125;<br><br>    <span class="hljs-comment">// afterReturning通知方法的形参，采用Object类型，接收委托类方法的返回值</span><br>    <span class="hljs-meta">@AfterReturning(value = &quot;servicePointcut()&quot;,returning = &quot;result&quot;)</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">afterReturning</span><span class="hljs-params">(Object result)</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;AfterReturning接收到的结果：&quot;</span> + result);<br>    &#125;<br><br>    <span class="hljs-comment">// public void afterThrowing(Exception exception) &#123;</span><br>    <span class="hljs-meta">@AfterThrowing(value = &quot;servicePointcut()&quot;,throwing = &quot;exception&quot;)</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">afterThrowing</span><span class="hljs-params">(Throwable exception)</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;afterThrowing通知：&quot;</span> + exception.getMessage());<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="连接点JoinPoint"><a href="#连接点JoinPoint" class="headerlink" title="连接点JoinPoint"></a>连接点JoinPoint</h3><p>在Before和Around通知执行过程中可以获得JoinPoint，通过它拿到一些信息，这意味着在通知中可以有更多操作空间。</p>
<p>joinPoint可以直接写在通知方法的形参中，通过调用其方法获取信息。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Before(&quot;servicePointcut()&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">beforex</span><span class="hljs-params">(JoinPoint joinPoint)</span> &#123;<br>    <span class="hljs-comment">// 代理类</span><br>    <span class="hljs-type">Object</span> <span class="hljs-variable">proxy</span> <span class="hljs-operator">=</span> joinPoint.getThis();<br>    <span class="hljs-comment">// 目标类、委托类对象</span><br>    <span class="hljs-type">Object</span> <span class="hljs-variable">target</span> <span class="hljs-operator">=</span> joinPoint.getTarget();<br>    <span class="hljs-comment">// 参数</span><br>    Object[] args = joinPoint.getArgs();<br>    <span class="hljs-comment">// 方法</span><br>    <span class="hljs-type">Signature</span> <span class="hljs-variable">signature</span> <span class="hljs-operator">=</span> joinPoint.getSignature();<br>    <span class="hljs-type">String</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span> signature.getName();<br>    System.out.println(<span class="hljs-string">&quot;正在执行的方法：&quot;</span> + name);<br><br>    System.out.println(<span class="hljs-string">&quot;before方法&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="Spring事务"><a href="#Spring事务" class="headerlink" title="Spring事务"></a>Spring事务</h2><p>Spring事务有三种事务传播行为，分别是REQUIRED、REQUIRES_NEW、NESTED。</p>
<p>REQUIRED：Spring默认。如果外围的方法不包含事务，那么被修饰的内部方法就添加一个新的事务；如果外围方法包含事务，则内部方法加入该事务，要么一起提交要么一起回滚。</p>
<p>REQUIRES_NEW：如果外围的方法不包含事务，那么内部方法就添加一个新的事务；如果外围方法包含事务，内部方法也添加一个事务，且该事务与外围的事务独立。</p>
<p>NESTED：如果外围的方法不包含事务，那么内部方法就添加一个新的事务；如果外围方法包含事务，内部方法也添加一个事务，且该事务与外围的事务成嵌套关系。</p>
<p>Spring事务的开启方式有：</p>
<ol>
<li><p>PlatFormTransactionManager，平台事务管理器</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">PlatformTransactionManager</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">TransactionManager</span> &#123;<br>    <span class="hljs-comment">// 根据事务的定义，获得事务的状态 → 开启事务</span><br>    TransactionStatus <span class="hljs-title function_">getTransaction</span><span class="hljs-params">(<span class="hljs-meta">@Nullable</span> TransactionDefinition var1)</span> <span class="hljs-keyword">throws</span> TransactionException;<br>	<span class="hljs-comment">// 提交 → 参数是TransactionStatus</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">commit</span><span class="hljs-params">(TransactionStatus var1)</span> <span class="hljs-keyword">throws</span> TransactionException;<br>	<span class="hljs-comment">// 回滚 → 参数是TransactionStatus</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">rollback</span><span class="hljs-params">(TransactionStatus var1)</span> <span class="hljs-keyword">throws</span> TransactionException;<br>&#125;<br></code></pre></td></tr></table></figure>
</li>
<li><p>TransactionTemplate </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TransferTransactionCallBack</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">TransactionCallback</span> &#123;<br><br>    AccountMapper accountMapper;<br>    Integer fromId;<br>    Integer destId;<br>    Integer fromMoney;<br>    Integer destMoney;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">TransferTransactionCallBack</span><span class="hljs-params">(AccountMapper accountMapper, Integer fromId, Integer destId, Integer fromMoney, Integer destMoney)</span> &#123;<br>        <span class="hljs-built_in">this</span>.accountMapper = accountMapper;<br>        <span class="hljs-built_in">this</span>.fromId = fromId;<br>        <span class="hljs-built_in">this</span>.destId = destId;<br>        <span class="hljs-built_in">this</span>.fromMoney = fromMoney;<br>        <span class="hljs-built_in">this</span>.destMoney = destMoney;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">doInTransaction</span><span class="hljs-params">(TransactionStatus transactionStatus)</span> &#123;<br>        <span class="hljs-comment">// 更新money</span><br>        <span class="hljs-type">int</span> <span class="hljs-variable">update1</span> <span class="hljs-operator">=</span> accountMapper.update(fromId, fromMoney);<br>        <span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span> / <span class="hljs-number">0</span>;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">update2</span> <span class="hljs-operator">=</span> accountMapper.update(destId, destMoney);<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
</li>
<li><p>在配置类使用@EnableTransactionManagement注解开启事务，在需要事务的类或方法中使用注解@Transactional。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Transactional</span><br><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">transfer</span><span class="hljs-params">(<span class="hljs-type">int</span> fromId, <span class="hljs-type">int</span> destId, Integer money)</span> &#123;<br>    <span class="hljs-comment">// 查询现有的money是多少</span><br>    <span class="hljs-type">Integer</span> <span class="hljs-variable">fromMoney</span> <span class="hljs-operator">=</span> accountMapper.select(fromId);<br>    <span class="hljs-type">Integer</span> <span class="hljs-variable">destMoney</span> <span class="hljs-operator">=</span> accountMapper.select(destId);<br><br>    <span class="hljs-comment">// 计算转账后的money是多少</span><br>    fromMoney -= money;<br>    destMoney += money;<br><br>    <span class="hljs-comment">// 更新money</span><br>    <span class="hljs-type">int</span> <span class="hljs-variable">update1</span> <span class="hljs-operator">=</span> accountMapper.update(fromId, fromMoney);<br>    <span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span> / <span class="hljs-number">0</span>;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">update2</span> <span class="hljs-operator">=</span> accountMapper.update(destId, destMoney);<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
</ol>
<h2 id="SpringMVC"><a href="#SpringMVC" class="headerlink" title="SpringMVC"></a>SpringMVC</h2><p>传统的Servlet映射过程繁琐，需要我们自己处理url和Servlet的映射关系，并根据url判断、分发接口至不同的方法中，且请求参数、响应结果都要自己手动拆封json。在SpringMVC中，则只由一个Servlet：DispatcherServlet来解决上述问题。</p>
<p>在SpringMVC中的流程如下。</p>
<ol>
<li>客户端（浏览器）发送请求，直接请求到 <code>DispatcherServlet</code>。</li>
<li><code>DispatcherServlet</code> 根据请求信息调用 <code>HandlerMapping</code>，解析请求对应的 <code>Handler</code>。</li>
<li>解析到对应的 <code>Handler</code>（也就是我们平常说的 <code>Controller</code> 控制器）后，开始由 <code>HandlerAdapter</code> 适配器处理。</li>
<li><code>HandlerAdapter</code> 会根据 <code>Handler</code>来调用真正的处理器开处理请求，并处理相应的业务逻辑。</li>
<li>处理器处理完业务后，会返回一个 <code>ModelAndView</code> 对象，<code>Model</code> 是返回的数据对象，<code>View</code> 是个逻辑上的 <code>View</code>。</li>
<li><code>ViewResolver</code> 会根据逻辑 <code>View</code> 查找实际的 <code>View</code>。</li>
<li><code>DispaterServlet</code> 把返回的 <code>Model</code> 传给 <code>View</code>（视图渲染）。</li>
<li>把 <code>View</code> 返回给请求者（浏览器）</li>
</ol>
<p>在SpringMVC中，可以完全使用JavaConfig代替配置文件，主要有：</p>
<ol>
<li><p>AACDSI（AbstractAnnotationConfigDispatcherServletInitializer）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ApplicationInitializer</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AbstractAnnotationConfigDispatcherServletInitializer</span> &#123;<br>    <br>    <span class="hljs-comment">// 加载Spring的配置文件application.xml → 配置类</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> Class&lt;?&gt;[] getRootConfigClasses() &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Class</span>[]&#123;SpringConfiguration.class&#125;;<br>    &#125;<br><br>    <span class="hljs-comment">// 加载SpringMVC的配置文件application-mvc.xml → 配置类</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> Class&lt;?&gt;[] getServletConfigClasses() &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Class</span>[]&#123;MvcConfiguration.class&#125;;<br>    &#125;<br><br>    <span class="hljs-comment">// DispatcherServlet的映射范围</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> String[] getServletMappings() &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>[]&#123;<span class="hljs-string">&quot;/&quot;</span>&#125;;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
</li>
<li><p>Spring配置类，用@Configuration修饰</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@ComponentScan(value = &quot;com.cskaoyan&quot;,</span><br><span class="hljs-meta">        excludeFilters = @ComponentScan.Filter(&#123;Controller.class, EnableWebMvc.class&#125;))</span> <span class="hljs-comment">// mvc配置类也在扫描包范围</span><br><span class="hljs-meta">@Configuration</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SpringConfiguration</span> &#123;<br>&#125;<br></code></pre></td></tr></table></figure>
</li>
<li><p>SpringMVC配置类，用@EnableWebMvc修饰</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@ComponentScan(&quot;com.cskaoyan.controller&quot;)</span><br><span class="hljs-meta">@EnableWebMvc</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MvcConfiguration</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">WebMvcConfigurer</span> &#123;<br>&#125;<br></code></pre></td></tr></table></figure></li>
</ol>
<h3 id="RequestMapping"><a href="#RequestMapping" class="headerlink" title="@RequestMapping"></a>@RequestMapping</h3><p>用于url的路径映射，可以写在类或方法上。</p>
<p>同一个RequestMapping可以映射多个路径，通过数组表示。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RequestMapping(&#123;&quot;hello&quot;,&quot;hello2&quot;,&quot;hello3&quot;&#125;)</span><br>   <span class="hljs-meta">@ResponseBody</span><br>   <span class="hljs-keyword">public</span> String <span class="hljs-title function_">hello</span><span class="hljs-params">()</span> &#123;<br>       <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;hello world&quot;</span>;<br>   &#125;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment">    * 也可以使用通配符 *</span><br><span class="hljs-comment">    */</span><br>   <span class="hljs-meta">@RequestMapping(&#123;&quot;goodbye/*&quot;, &quot;goodbye*&quot;&#125;)</span><br>   <span class="hljs-meta">@ResponseBody</span><br>   <span class="hljs-keyword">public</span> String <span class="hljs-title function_">goodbye</span><span class="hljs-params">()</span> &#123;<br>       <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;byebye&quot;</span>;<br>   &#125;<br></code></pre></td></tr></table></figure>

<p>如果请求url包含共同的前缀，可以提取至修饰类的注解中，这称为窄化请求。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Controller</span><br><span class="hljs-meta">@RequestMapping(&quot;user&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserController</span> &#123;<br><br>    <span class="hljs-comment">//@RequestMapping(&quot;user/login&quot;)</span><br>    <span class="hljs-meta">@RequestMapping(&quot;login&quot;)</span> <br>    <span class="hljs-meta">@ResponseBody</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">login</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;login&quot;</span>;<br>    &#125;<br>    <span class="hljs-comment">//@RequestMapping(&quot;user/register&quot;)</span><br>    <span class="hljs-meta">@RequestMapping(&quot;register&quot;)</span><br>    <span class="hljs-meta">@ResponseBody</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">register</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;register&quot;</span>;<br>    &#125;<br>    <span class="hljs-comment">//@RequestMapping(&quot;user/modify&quot;)</span><br>    <span class="hljs-meta">@RequestMapping(&quot;modify&quot;)</span><br>    <span class="hljs-meta">@ResponseBody</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">modify</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;modify&quot;</span>;<br>    &#125;<br>    <span class="hljs-comment">//@RequestMapping(&quot;user/remove&quot;)</span><br>    <span class="hljs-meta">@RequestMapping(&quot;remove&quot;)</span><br>    <span class="hljs-meta">@ResponseBody</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">remove</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;remove&quot;</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>@RequestMapping还有多种属性：</p>
<ul>
<li><p>method：用于限定请求方法。如GET、POST。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RequestMapping(value = &quot;get&quot;,method = RequestMethod.GET)</span><br>   <span class="hljs-meta">@ResponseBody</span><br>   <span class="hljs-keyword">public</span> String <span class="hljs-title function_">methodGet</span><span class="hljs-params">()</span> &#123;<br>       <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Method GET&quot;</span>;<br>   &#125;<br></code></pre></td></tr></table></figure>
</li>
<li><p>params：用于限定参数。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RequestMapping(value = &quot;login&quot;,params = &#123;&quot;username&quot;,&quot;password&quot;&#125;)</span> <span class="hljs-comment">// 既要携带username又要携带password</span><br>   <span class="hljs-meta">@ResponseBody</span><br>   <span class="hljs-keyword">public</span> String <span class="hljs-title function_">login</span><span class="hljs-params">()</span> &#123;<br>       <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;ok&quot;</span>;<br>   &#125;<br></code></pre></td></tr></table></figure>
</li>
<li><p>headers：用于限定请求头。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RequestMapping(value = &quot;limit&quot;, headers = &#123;&quot;abc&quot;, &quot;def&quot;&#125;)</span><span class="hljs-comment">//既要携带abc、又要携带def这两个请求头</span><br>  <span class="hljs-meta">@ResponseBody</span><br>  <span class="hljs-keyword">public</span> String <span class="hljs-title function_">headerLimit</span><span class="hljs-params">()</span> &#123;<br>      <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;header limit&quot;</span>;<br>  &#125;<br></code></pre></td></tr></table></figure>
</li>
<li><p>consumes：用于限定Content-Type的值。</p>
</li>
<li><p>produces：用于限定Accept的值</p>
</li>
</ul>
<h3 id="ResponseBody"><a href="#ResponseBody" class="headerlink" title="@ResponseBody"></a>@ResponseBody</h3><p>在Controller上添加注解@ResponseBody，即可将返回值自动包装为json。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Controller</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">JsonController</span> &#123;<br><br>    <span class="hljs-meta">@RequestMapping(&quot;json&quot;)</span><br>    <span class="hljs-meta">@ResponseBody</span><br>    <span class="hljs-keyword">public</span> User <span class="hljs-title function_">json</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>(<span class="hljs-string">&quot;123&quot;</span>,<span class="hljs-string">&quot;456&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>可以使用@RestController来代替@Controller和 @ResponseBody。</p>
<h3 id="请求参数的接收"><a href="#请求参数的接收" class="headerlink" title="请求参数的接收"></a>请求参数的接收</h3><p>如果是普通的get请求，可以使用方法形参来接收参数，但要求形参名与参数名必须一致。类型支持：</p>
<ul>
<li>字符串String</li>
<li>基本类型以及对应包装类</li>
<li>数组</li>
<li>Date（需要使用@DateTimeFormat来标准化日期格式）</li>
<li>文件</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RequestMapping(&quot;register5&quot;)</span><br><span class="hljs-keyword">public</span> BaseRespVo <span class="hljs-title function_">register5</span><span class="hljs-params">(String username, String password, Integer age,</span><br><span class="hljs-params">                            String[] hobbies, Integer[] ids,</span><br><span class="hljs-params">                            <span class="hljs-meta">@DateTimeFormat(pattern = &quot;yyyy-MM-dd&quot;)</span> Date birthday)</span> &#123;<br>    <span class="hljs-keyword">return</span> BaseRespVo.ok();<br>&#125;<br><br><span class="hljs-meta">@RequestMapping(&quot;file&quot;)</span><br><span class="hljs-keyword">public</span> BaseRespVo <span class="hljs-title function_">uploadFile</span><span class="hljs-params">(MultipartFile file)</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>    <span class="hljs-comment">// 获得上传的文件的信息</span><br>    <span class="hljs-type">String</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span> file.getName(); <span class="hljs-comment">// 请求参数名 → file</span><br>    <span class="hljs-type">String</span> <span class="hljs-variable">originalFilename</span> <span class="hljs-operator">=</span> file.getOriginalFilename(); <span class="hljs-comment">//原始文件名</span><br>    <span class="hljs-type">long</span> <span class="hljs-variable">size</span> <span class="hljs-operator">=</span> file.getSize(); <span class="hljs-comment">// 文件的大小</span><br>    <span class="hljs-type">String</span> <span class="hljs-variable">contentType</span> <span class="hljs-operator">=</span> file.getContentType(); <span class="hljs-comment">// 正文类型 → 文件类型</span><br>    <span class="hljs-comment">// MultipartFile.transferTo</span><br>    <span class="hljs-type">File</span> <span class="hljs-variable">saveFile</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(<span class="hljs-string">&quot;D:\\WorkSpace\\j40_workspace&quot;</span>, originalFilename);<br>    <span class="hljs-comment">//File saveFile = new File(&quot;D:\\WorkSpace\\j40_workspace\\dlrb.jpg&quot;);</span><br>    file.transferTo(saveFile);<br>    <span class="hljs-keyword">return</span> BaseRespVo.ok();<br>&#125;<br></code></pre></td></tr></table></figure>

<p>除了形参，还可以使用自定义的引用类型对象，如果使用引用类型的对象时，Servlet会去创建一个新的实例。看你这个类中有哪些成员变量，如果成员变量名和请求参数名相同，就会使用成员变量来接收请求参数，使用set方法来进行封装。所以要求请求参数名与引用类中的成员变量名一致。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span> &#123;<br>    String username;<br>   String password;<br>   Integer age;<br>    String[] hobbies;<br>   Integer[] ids;<br>    <span class="hljs-meta">@DateTimeFormat(pattern = &quot;yyyy-MM-dd&quot;)</span><br>    Date birthday;<br>&#125;<br></code></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RequestMapping(&quot;register6&quot;)</span><br><span class="hljs-keyword">public</span> BaseRespVo <span class="hljs-title function_">register6</span><span class="hljs-params">(User user)</span> &#123;<br>	<span class="hljs-keyword">return</span> BaseRespVo.ok();<br>&#125;<br></code></pre></td></tr></table></figure>

<p>如果是post请求，那么发送的请求参数一般是json，需要对json转换成对应的实例。此时需要增加@RequestBody注解来修饰json对应的bean类。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RequestMapping(&quot;user/login&quot;)</span><br><span class="hljs-keyword">public</span> BaseRespVo <span class="hljs-title function_">login</span><span class="hljs-params">(<span class="hljs-meta">@RequestBody</span> JsonUser user)</span> &#123;<br>    <span class="hljs-keyword">return</span> BaseRespVo.ok(user);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>如果需要获得Cookie，则不能直接获得，需要通过Request获得。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// 把所有Cookie都遍历打印一下</span><br><span class="hljs-meta">@RequestMapping(&quot;cookies&quot;)</span><br><span class="hljs-keyword">public</span> BaseRespVo <span class="hljs-title function_">cookies</span><span class="hljs-params">(HttpServletRequest request)</span> &#123;<br>    Cookie[] cookies = request.getCookies();<br>    <span class="hljs-keyword">for</span> (Cookie cookie : cookies) &#123;<br>        System.out.println(cookie.getName() + <span class="hljs-string">&quot; --&gt; &quot;</span> + cookie.getValue());<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> BaseRespVo.ok();<br>&#125;<br></code></pre></td></tr></table></figure>

<p>而session可以直接获得。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RequestMapping(&quot;session2&quot;)</span><br><span class="hljs-keyword">public</span> BaseRespVo <span class="hljs-title function_">session2</span><span class="hljs-params">(HttpSession session)</span> &#123;<br>    <span class="hljs-type">Object</span> <span class="hljs-variable">username</span> <span class="hljs-operator">=</span> session.getAttribute(<span class="hljs-string">&quot;username&quot;</span>);<br>    <span class="hljs-keyword">return</span> BaseRespVo.ok(username);<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="PathVariable"><a href="#PathVariable" class="headerlink" title="@PathVariable"></a>@PathVariable</h3><p>获取请求url中指定占位符的值，并将值赋给对应的形参。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RequestMapping(&quot;note/&#123;id&#125;&quot;)</span><br><span class="hljs-keyword">public</span> BaseRespVo <span class="hljs-title function_">note</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable(&quot;id&quot;)</span> Integer id)</span> &#123;<br>    <span class="hljs-keyword">return</span> BaseRespVo.ok();<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="Converter"><a href="#Converter" class="headerlink" title="Converter"></a>Converter</h3><p>Converter，类型转换器，使用主要是在请求参数封装的过程中，也就是Handler方法的形参。在形参并不是String的情况下会用到Converter。</p>
<p>一般情况下需要自己定义Converter。如从String转为User。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">String2UserConverter</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Converter</span>&lt;String, User&gt; &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> User <span class="hljs-title function_">convert</span><span class="hljs-params">(String s)</span> &#123;<br>        <span class="hljs-comment">// 里面的转换业务需要你自己定义</span><br>        <span class="hljs-type">User</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>();<br>        user.setUsername(s);<br>        user.setPassword(s);<br>        <span class="hljs-keyword">return</span> user;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// 提供自定义的转换器</span><br><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addFormatters</span><span class="hljs-params">(FormatterRegistry registry)</span> &#123;<br>    registry.addConverter(<span class="hljs-keyword">new</span> <span class="hljs-title class_">String2UserConverter</span>());<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="ResourceHandler"><a href="#ResourceHandler" class="headerlink" title="ResourceHandler"></a>ResourceHandler</h3><p>因为在SpringMVC中，DispatcherServlet的映射范围是&#x2F;，即除了jsp外的所有请求，之前JavaEE的访问静态资源的方式就无法使用了，所以需要使用ResourceHandler来进行静态资源映射。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addResourceHandlers</span><span class="hljs-params">(ResourceHandlerRegistry registry)</span> &#123;<br>   registry.addResourceHandler(<span class="hljs-string">&quot;/pic/**&quot;</span>).addResourceLocations(<span class="hljs-string">&quot;classpath:/&quot;</span>);<br>   registry.addResourceHandler(<span class="hljs-string">&quot;/jpg/**&quot;</span>).addResourceLocations(<span class="hljs-string">&quot;/&quot;</span>);<br>	registry.addResourceHandler(<span class="hljs-string">&quot;/png/**&quot;</span>).addResourceLocations(<span class="hljs-string">&quot;file:D:\\spring/&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="HandlerInterceptor"><a href="#HandlerInterceptor" class="headerlink" title="HandlerInterceptor"></a>HandlerInterceptor</h3><p>在Handler前执行，起到了拦截的功能。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">HandlerInterceptor</span> &#123;<br>    <span class="hljs-comment">// 在Handler方法执行之前</span><br>    <span class="hljs-comment">// 返回值为boolean，如果为true则继续流程，如果false，则中断流程</span><br>    <span class="hljs-keyword">default</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">preHandle</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    &#125;<br>	<span class="hljs-comment">// 在Handler方法执行之后</span><br>    <span class="hljs-keyword">default</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">postHandle</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Object handler, <span class="hljs-meta">@Nullable</span> ModelAndView modelAndView)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>    &#125;<br>	<span class="hljs-comment">// 在整个流程完成之后</span><br>    <span class="hljs-keyword">default</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">afterCompletion</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Object handler, <span class="hljs-meta">@Nullable</span> Exception ex)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="异常处理"><a href="#异常处理" class="headerlink" title="异常处理"></a>异常处理</h3><p>有两种异常处理方式：统一的全局异常处理 HandlerExceptionResolver和自定义异常处理 ExceptionHandler。</p>
<p>HandlerExceptionResolver是一个接口，接口里提供了resolveException方法，重写该方法来处理全局异常。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CustomHandlerExceptionResolver</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">HandlerExceptionResolver</span> &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> ModelAndView <span class="hljs-title function_">resolveException</span><span class="hljs-params">(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse, Object o, Exception e)</span> &#123;<br>        <span class="hljs-comment">// 通过它也可以做个性化的异常处理，如果要做，需要你自己来做个性化的东西</span><br>        <span class="hljs-keyword">if</span> (e <span class="hljs-keyword">instanceof</span> ArithmeticException) &#123;<br>            <span class="hljs-comment">//做个性化的异常处理</span><br>            System.out.println(e.getMessage());<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ModelAndView</span>(<span class="hljs-string">&quot;/exception.jsp&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>ExceptionHandler是一个注解，value是对应的异常，旨在用对应的方法处理对应的异常。一般放在ontrollerAdvice组件中的方法上。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@ControllerAdvice</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CustomExceptionControllerAdvice</span> &#123;<br><br>    <span class="hljs-comment">// 在形参中可以直接接收你抛出的异常，你映射的是什么异常，就可以以什么类型的形参来接收</span><br>    <span class="hljs-meta">@ExceptionHandler(ArithmeticException.class)</span><br>    <span class="hljs-meta">@ResponseBody</span><br>    <span class="hljs-keyword">public</span> BaseRespVo <span class="hljs-title function_">method1</span><span class="hljs-params">(ArithmeticException exception)</span> &#123;<br>        <span class="hljs-keyword">return</span> BaseRespVo.fail(exception.getMessage());<br>    &#125;<br>    <br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="SpringBoot"><a href="#SpringBoot" class="headerlink" title="SpringBoot"></a>SpringBoot</h2><p>SpringBoot本质上就是一个Spring框架，但是它简化了Spring的配置。在没有给具体配置前，SpringBoot会使用默认的配置，只有给到具体的配置，才采用具体的配置。</p>
<p>启动类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// 该注解就是SpringBoot应用启动类上的注解 → 会配置扫描包目录就是该类所处的包目录</span><br><span class="hljs-meta">@SpringBootApplication</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Demo1FirstSbApplication</span> &#123;<br>    <span class="hljs-comment">// 启动类中一定会包含main方法 → 就是启动SpringBoot应用程序的入口</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        SpringApplication.run(Demo1FirstSbApplication.class, args);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>

<p>SpringBoot对web的支持：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-comment"># tomcat配置</span><br><span class="hljs-attr">server:</span><br>  <span class="hljs-attr">port:</span> <span class="hljs-number">8083</span>  <span class="hljs-comment">#Tomcat的端口号配置</span><br>  <span class="hljs-attr">servlet:</span><br>    <span class="hljs-attr">context-path:</span> <span class="hljs-string">/demo1</span>   <span class="hljs-comment"># 应用程序的上下文配置（应用名）</span><br>    <br><span class="hljs-comment"># 静态资源映射</span><br><span class="hljs-attr">spring:</span><br>  <span class="hljs-attr">mvc:</span><br>    <span class="hljs-attr">static-path-pattern:</span> <span class="hljs-string">/pic/**</span><br><span class="hljs-comment">#  spring.resources  或  spring.web.resources</span><br>  <span class="hljs-attr">resources:</span><br>    <span class="hljs-attr">static-locations:</span> <span class="hljs-string">file:d:/spring/</span><br>    <br><span class="hljs-comment"># Converter</span><br><span class="hljs-comment"># Filter</span><br></code></pre></td></tr></table></figure>

<p>SpringBoot对Mybatis的支持：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">spring:</span><br>  <span class="hljs-attr">datasource:</span><br>    <span class="hljs-attr">driver-class-name:</span> <span class="hljs-string">com.mysql.jdbc.Driver</span><br>    <span class="hljs-attr">url:</span> <span class="hljs-string">jdbc:mysql://localhost:3306/cskaoyan_db?useUnicode=true&amp;characterEncoding=utf-8</span><br>    <span class="hljs-attr">username:</span> <span class="hljs-string">root</span><br>    <span class="hljs-attr">password:</span> <span class="hljs-number">123456</span><br></code></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@SpringBootApplication</span><br><span class="hljs-comment">// 需要添加@MapperScan来扫描mapper</span><br><span class="hljs-meta">@MapperScan(&quot;com.cskaoyan.mapper&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Demo1FirstSbApplication</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        SpringApplication.run(Demo1FirstSbApplication.class, args);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="逆向工程"><a href="#逆向工程" class="headerlink" title="逆向工程"></a>逆向工程</h2><p>逆向工程可以根据数据库中的表自动生成接口、方法、映射文件，只需要操作对应的Example类就可以操作数据库。</p>
<p>接口方法示例。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//升序还是降序:字段+空格+asc(desc)</span><br><span class="hljs-keyword">protected</span> String orderByClause;<br><span class="hljs-comment">//去除重复:true是选择不重复记录,false,反之</span><br><span class="hljs-keyword">protected</span> <span class="hljs-type">boolean</span> distinct;<br><span class="hljs-comment">//自定义查询条件</span><br><span class="hljs-keyword">protected</span> List&lt;Criteria&gt; oredCriteria;<br></code></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testFindUserByName</span><span class="hljs-params">()</span>&#123;<br><br>    <span class="hljs-comment">//通过criteria构造查询条件</span><br>    <span class="hljs-type">UserExample</span> <span class="hljs-variable">userExample</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UserExample</span>();<br>    userExample.setOrderByClause(<span class="hljs-string">&quot;username asc&quot;</span>); <span class="hljs-comment">//asc升序,desc降序排列</span><br>    userExample.setDistinct(<span class="hljs-literal">false</span>); <span class="hljs-comment">//去除重复,true是选择不重复记录,false反之</span><br>    UserExample.<span class="hljs-type">Criteria</span> <span class="hljs-variable">criteria</span> <span class="hljs-operator">=</span> userExample.createCriteria(); <span class="hljs-comment">//构造自定义查询条件</span><br>    criteria.andUsernameEqualTo(<span class="hljs-string">&quot;张三&quot;</span>);<br><br>    <span class="hljs-comment">//自定义查询条件可能返回多条记录,使用List接收</span><br>    List&lt;User&gt; users = userMapper.selectByExample(userExample);<br><br>    System.out.println(users);<br>&#125; <br></code></pre></td></tr></table></figure>

<p>逆向工程生成的内容会有一定问题，如果表中的字段存在sql语句中的关键字，需要自己手动在mapper.xml文件中添加转义字符。</p>
<h2 id="TypeHandler"><a href="#TypeHandler" class="headerlink" title="TypeHandler"></a>TypeHandler</h2><p>TypeHandler是Mybatis输入输出映射过程中的类型处理器，用于处理jdbcType和JavaType间的转换。</p>
<p>主要方式是实现<code>TypeHandler</code>接口。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// 类型映射配置</span><br><span class="hljs-meta">@MappedTypes(Integer[].class)</span><br><span class="hljs-meta">@MappedJdbcTypes(JdbcType.VARCHAR)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">IntegerArrayTypeHandler</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">TypeHandler</span>&lt;Integer[]&gt; &#123;<br><br>    <span class="hljs-type">ObjectMapper</span> <span class="hljs-variable">objectMapper</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectMapper</span>();<br>    <br>    <span class="hljs-comment">// 输入映射过程</span><br>    <span class="hljs-comment">// insert into market_user (id,username,password,role_ids) values (?,?,?,?)</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setParameter</span><span class="hljs-params">(PreparedStatement preparedStatement, <span class="hljs-type">int</span> index, Integer[] integers, JdbcType jdbcType)</span> <span class="hljs-keyword">throws</span> SQLException &#123;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">value</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>        <span class="hljs-keyword">try</span> &#123;<br>            value = objectMapper.writeValueAsString(integers);<br>        &#125; <span class="hljs-keyword">catch</span> (JsonProcessingException e) &#123;<br>            e.printStackTrace();<br>        &#125;<br>        <span class="hljs-comment">// 为第几个占位符提供的值是什么</span><br>        preparedStatement.setString(index,value);<br>    &#125;<br><br>    <span class="hljs-comment">// 输出映射过程</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> Integer[] getResult(ResultSet resultSet, String columName) <span class="hljs-keyword">throws</span> SQLException &#123;<br>        <span class="hljs-comment">// 获得结果</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> resultSet.getString(columName);<br>        <span class="hljs-keyword">return</span> transfer(result);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> Integer[] getResult(ResultSet resultSet, <span class="hljs-type">int</span> index) <span class="hljs-keyword">throws</span> SQLException &#123;<br>        <span class="hljs-comment">// 获得结果</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> resultSet.getString(index);<br>        <span class="hljs-keyword">return</span> transfer(result);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> Integer[] getResult(CallableStatement callableStatement, <span class="hljs-type">int</span> i) <span class="hljs-keyword">throws</span> SQLException &#123;<br>        <span class="hljs-comment">// 获得结果</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> callableStatement.getString(i);<br>        <span class="hljs-keyword">return</span> transfer(result);<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> Integer[] transfer(String result) &#123;<br>        Integer[] integers = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Integer</span>[<span class="hljs-number">0</span>];<br>        <span class="hljs-comment">// 使用jackson将字符串转换Integer[]</span><br>        <span class="hljs-keyword">try</span> &#123;<br>            integers = objectMapper.readValue(result, Integer[].class);<br>        &#125; <span class="hljs-keyword">catch</span> (JsonProcessingException e) &#123;<br>            e.printStackTrace();<br>        &#125;<br>        <span class="hljs-keyword">return</span> integers;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>配置自定义的TypeHandler</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">mybatis:</span><br>  <span class="hljs-attr">type-handlers-package:</span> <span class="hljs-string">com.cskaoyan.typehandler</span><br></code></pre></td></tr></table></figure>

<h2 id="Shiro框架"><a href="#Shiro框架" class="headerlink" title="Shiro框架"></a>Shiro框架</h2><p>Shiro安全框架，Apache Shiro是一个开源安全框架，提供身份认证、授权、密码学和会话管理。Shiro框架直观、易用，同时也能提供健壮的安全性。</p>
<p>Shiro在SpringMVC应用程序中以Filter的形式存在。</p>
<p>Shiro的一些核心术语如下。</p>
<ul>
<li>Authentication，认证是身份验证的过程 -您正在尝试证明用户是他们所说的人。为此，用户需要提供系统理解和信任的某种身份证明。认证其实就是我们通常所说的登录。</li>
<li>Authorization，授权或访问控制是指定对资源的访问权限的功能。换句话说，谁可以访问什么。比如是否允许用户编辑此数据，这些都是决定用户有权访问的内容的决定。我们当前主要针对的是URL级别的权限访问控制。</li>
<li>Subject，主体，在Shiro中所做的几乎所有操作都基于当前正在执行的用户，也就是基本上Shiro的操作都是使用Subject操作的，Subject指的就是当前操作的用户。在代码中的任何位置都可以轻松获得Subject，通过Subject可以方便的操作Shiro。比如我们可以使用Subject提供的方法来执行认证、判断是否认证等操作。</li>
<li>Principals，主体鉴定后的参数，也就是认证后的用户信息，可以是姓名、用户id、用户对象等形式。</li>
<li>Credentials，用来验证身份的秘密数据，通常指密码，生物数据比如指纹、面部、瞳孔等。</li>
<li>Realms，域或领域，安全的特殊数据存储对象（DAO），Shiro中的Realm主要是让你能够获得对应的认证信息和授权信息。</li>
<li>Token，令牌，Shiro中的Token是作为登录操作的参数。</li>
</ul>
<p>Shiro的核心组件如下：</p>
<ul>
<li>SecurityManager，安全管理器</li>
<li>Authenticator，认证器</li>
<li>SessionManager，会话管理器</li>
<li>Realm，域</li>
<li>CacheManager，缓存管理器</li>
<li>Cryptography，密码学</li>
</ul>
<p>Shiro提供的Filter类型如下。</p>
<table>
<thead>
<tr>
<th>Filter名称</th>
<th>Filter类</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>anon</td>
<td>org.apache.shiro.web.filter.authc.AnonymousFilter</td>
<td>匿名Filter，作用范围内的请求不需要认证和授权</td>
</tr>
<tr>
<td>authc</td>
<td>org.apache.shiro.web.filter.authc.FormAuthenticationFilter</td>
<td>认证Filter，作用范围内的请求需要完成认证</td>
</tr>
<tr>
<td>perms</td>
<td>org.apache.shiro.web.filter.authz.PermissionsAuthorizationFilter</td>
<td>权限Filter，作用范围内的请求需要完成认证和授权</td>
</tr>
</tbody></table>
<p>我们可以设置不同类型的Filter分别映射一些不同的URL范围，当请求发送到应用程序时，根据请求URL分别判断使用哪一些Filter，在Filter中决定是否继续访问流程。在SpringBoot中，主要在配置文件中配置。</p>
<h3 id="Realm"><a href="#Realm" class="headerlink" title="Realm"></a>Realm</h3><p>Shiro中的Realm主要是让你能够获得对应的认证信息和授权信息。</p>
<p>一般通过自定义Realm来使用，需要继承一个抽象类AuthorizingRealm，并实现两个抽象方法：</p>
<ul>
<li>doGetAuthenticationInfo ：获得认证信息，即根据token中的用户名查询该用户在系统中的Credentials，并且构造AuthenInfo。</li>
<li>doGetAuthorizationInfo ：获得授权信息，即根据Principal（放入AuthenInfo中的第一个参数）查询该用户在系统中的权限信息。</li>
</ul>
<p>在这两个方法中去写获得用户认证信息和授权信息的业务代码。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CustomRealm</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AuthorizingRealm</span> &#123;<br>    <span class="hljs-comment">//通常把doGetAuthenticationInfo方法放在上面</span><br><br>    <span class="hljs-comment">//该方法的形参 → 来源于subject的login方法</span><br>    <span class="hljs-comment">// 传入该值，为了根据用户名查询到该用户在系统中的密码（数据库中维护） → 来构造认证信息</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> AuthenticationInfo <span class="hljs-title function_">doGetAuthenticationInfo</span><span class="hljs-params">(AuthenticationToken authenticationToken)</span> <span class="hljs-keyword">throws</span> AuthenticationException &#123;<br>        <span class="hljs-type">UsernamePasswordToken</span> <span class="hljs-variable">token</span> <span class="hljs-operator">=</span> (UsernamePasswordToken) authenticationToken;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">username</span> <span class="hljs-operator">=</span> token.getUsername();<br><br>        <span class="hljs-comment">//根据username查询数据库中对应password</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">password</span> <span class="hljs-operator">=</span> selectPasswordByUsername(username);<br><br>        <span class="hljs-comment">// principal信息 → 当前放的是什么信息，后续取出的就是什么信息</span><br>        <span class="hljs-comment">// 密码   → 该密码会和Token中的password做比较</span><br>        <span class="hljs-comment">// realm名称 → 没啥用</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SimpleAuthenticationInfo</span>(username,password,getName());<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> AuthorizationInfo <span class="hljs-title function_">doGetAuthorizationInfo</span><span class="hljs-params">(PrincipalCollection principalCollection)</span> &#123;<br>        <span class="hljs-comment">// 根据用户信息拿到所有的权限（数据库）</span><br>        <span class="hljs-comment">// doGetAuthenticationInfo方法返回值的第一个参数就是用户信息</span><br>        <span class="hljs-comment">// 在第21行代码放入的是字符串类型的Principal信息，取出的时候就可以以字符串格式取出</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">primaryPrincipal</span> <span class="hljs-operator">=</span> (String) principalCollection.getPrimaryPrincipal();<br>        List&lt;String&gt; permissions = getPermissionsByUsername(primaryPrincipal);<br><br>        <span class="hljs-type">SimpleAuthorizationInfo</span> <span class="hljs-variable">simpleAuthorizationInfo</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SimpleAuthorizationInfo</span>();<br>        simpleAuthorizationInfo.addStringPermissions(permissions);<br>        <span class="hljs-keyword">return</span> simpleAuthorizationInfo;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> String <span class="hljs-title function_">selectPasswordByUsername</span><span class="hljs-params">(String username)</span> &#123;<br>        <span class="hljs-comment">// 应该通过MyBatis根据用户名查询获得结果</span><br><br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;123456&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> List&lt;String&gt; <span class="hljs-title function_">getPermissionsByUsername</span><span class="hljs-params">(String username)</span> &#123;<br>        <span class="hljs-comment">// 应该通过MyBatis根据用户名查询获得结果</span><br>        <span class="hljs-keyword">return</span> Arrays.asList(<span class="hljs-string">&quot;admin:user:list&quot;</span>, <span class="hljs-string">&quot;admin:admin:list&quot;</span>);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="认证"><a href="#认证" class="headerlink" title="认证"></a>认证</h3><p>在对应请求中获得subject，并执行subject的login方法。</p>
<ul>
<li>因为登录请求不需要权限，需要将其权限设为anon</li>
<li>subject对象可以在所有组件中获得，方式为<code>Subject subject = SecurityUtils.getSubject()</code></li>
<li>在绝大多数场景下，login方法的参数都为AuthenticationToken接口，可以直接使用其实现类UsernamePasswordToken：<code> subject.login(new UsernamePasswordToken(username,password))</code></li>
<li>如果需要获得sessionId，可以使用subject获得：<code> subject.getSession().getId()</code></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@PostMapping(&quot;login&quot;)</span><br><span class="hljs-keyword">public</span> BaseRespVo&lt;LoginUserData&gt; <span class="hljs-title function_">login</span><span class="hljs-params">(<span class="hljs-meta">@RequestBody</span> Map map)</span> &#123;<br>    <span class="hljs-type">String</span> <span class="hljs-variable">username</span> <span class="hljs-operator">=</span> (String)map.get(<span class="hljs-string">&quot;username&quot;</span>);<br>    <span class="hljs-type">String</span> <span class="hljs-variable">password</span> <span class="hljs-operator">=</span> (String)map.get(<span class="hljs-string">&quot;password&quot;</span>);<br><br>    <span class="hljs-comment">// 整合Shiro</span><br>    <span class="hljs-comment">// 获得操作的主体</span><br>    <span class="hljs-type">Subject</span> <span class="hljs-variable">subject</span> <span class="hljs-operator">=</span> SecurityUtils.getSubject();<br>    <span class="hljs-comment">// login方法传入的参数AuthenticationToken → 认证的令牌</span><br>    <span class="hljs-comment">// subject执行login → 认证器执行认证方法 → realm.doGetAuthenticationInfo</span><br>    <span class="hljs-comment">// AuthenticationToken → UsernamePasswordToken → 直接封装了username和password</span><br>    <span class="hljs-comment">// username和password通过Handler方法的形参传入</span><br>    subject.login(<span class="hljs-keyword">new</span> <span class="hljs-title class_">UsernamePasswordToken</span>(username,password));<br><br>    <span class="hljs-keyword">if</span> (subject.isAuthenticated()) &#123;<br>        System.out.println(<span class="hljs-string">&quot;认证成功&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-type">LoginUserData</span> <span class="hljs-variable">loginUserData</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">LoginUserData</span>();<br>    <span class="hljs-type">AdminInfoBean</span> <span class="hljs-variable">adminInfo</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AdminInfoBean</span>();<br>    adminInfo.setAvatar(<span class="hljs-string">&quot;https://wpimg.wallstcn.com/f778738c-e4f8-4870-b634-56703b4acafe.gif&quot;</span>);<br>    adminInfo.setNickName(<span class="hljs-string">&quot;admin123&quot;</span>);<br>    loginUserData.setAdminInfo(adminInfo);<br>    <span class="hljs-comment">// 携带SessionId信息</span><br>    loginUserData.setToken((String) subject.getSession().getId());<br>    <span class="hljs-keyword">return</span> BaseRespVo.ok(loginUserData);<br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>认证后可以通过<code>subject.getPrincipals().getPrimaryPrincipal()</code>来获取用户在数据库中的其他信息。该方法的返回值为Object，可以直接转换为对应的用户信息PO类。</li>
<li>可以通过<code>subject.logout()</code>登出用户。</li>
</ul>
<h2 id="HibernateValidation"><a href="#HibernateValidation" class="headerlink" title="HibernateValidation"></a>HibernateValidation</h2><p>在需要对一些参数进行校验时，可以在Handler方法的形参上增加注解@Valid或@Validated，或在引用类型中的成员变量上增加校验功能的注解。</p>
<p>常见注解如下。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java">常见的注解 （Bean Validation 中内置的 constraint）     <br><span class="hljs-meta">@Null</span>   被注释的元素必须为 <span class="hljs-literal">null</span>     <br><span class="hljs-meta">@NotNull</span>    被注释的元素必须不为 <span class="hljs-literal">null</span>     <br><span class="hljs-meta">@Size(max=, min=)</span>   被注释的元素的大小必须在指定的范围内     <br><span class="hljs-meta">@AssertTrue</span>     被注释的元素必须为 <span class="hljs-literal">true</span>     <br><span class="hljs-meta">@AssertFalse</span>    被注释的元素必须为 <span class="hljs-literal">false</span>     <br><span class="hljs-meta">@Min(value)</span>     被注释的元素必须是一个数字，其值必须大于等于指定的最小值     <br><span class="hljs-meta">@Max(value)</span>     被注释的元素必须是一个数字，其值必须小于等于指定的最大值     <br><span class="hljs-meta">@DecimalMin(value)</span>  被注释的元素必须是一个数字，其值必须大于等于指定的最小值     <br><span class="hljs-meta">@DecimalMax(value)</span>  被注释的元素必须是一个数字，其值必须小于等于指定的最大值     <br><span class="hljs-meta">@Digits</span> (integer, fraction)     被注释的元素必须是一个数字，其值必须在可接受的范围内     <br><span class="hljs-meta">@Past</span>   被注释的元素必须是一个过去的日期 Date    <br><span class="hljs-meta">@Future</span>     被注释的元素必须是一个将来的日期     <br><span class="hljs-meta">@Pattern(regex=,flag=)</span>  被注释的元素必须符合指定的正则表达式     <br>Hibernate Validator 附加的 constraint     <br><span class="hljs-meta">@NotBlank(message =)</span>   验证字符串非<span class="hljs-literal">null</span>，且长度必须大于<span class="hljs-number">0</span>     <br><span class="hljs-meta">@Email</span>  被注释的元素必须是电子邮箱地址     <br><span class="hljs-meta">@Length(min=,max=)</span>  被注释的字符串的大小必须在指定的范围内     <br><span class="hljs-meta">@NotEmpty</span>   被注释的字符串的必须非空     <br><span class="hljs-meta">@Range(min=,max=,message=)</span>  被注释的元素必须在合适的范围内<br></code></pre></td></tr></table></figure>


  </article>

  
      
    <div class="nexmoe-post-copyright">
        <strong>本文作者：</strong>Ykuri98<br>
        <strong>本文链接：</strong><a href="https://ykuri98.github.io/2022/07/04/%E5%AD%A6%E4%B9%A0%E6%80%BB%E7%BB%93%EF%BC%882022-06-15-2022-06-24%EF%BC%89/" title="https:&#x2F;&#x2F;ykuri98.github.io&#x2F;2022&#x2F;07&#x2F;04&#x2F;%E5%AD%A6%E4%B9%A0%E6%80%BB%E7%BB%93%EF%BC%882022-06-15-2022-06-24%EF%BC%89&#x2F;" target="_blank" rel="noopener">https:&#x2F;&#x2F;ykuri98.github.io&#x2F;2022&#x2F;07&#x2F;04&#x2F;%E5%AD%A6%E4%B9%A0%E6%80%BB%E7%BB%93%EF%BC%882022-06-15-2022-06-24%EF%BC%89&#x2F;</a><br>
        
            <strong>版权声明：</strong>本文采用 <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/cn/deed.zh" target="_blank">CC BY-NC-SA 3.0 CN</a> 协议进行许可
        
    </div>


  
  
  <div class="nexmoe-post-meta nexmoe-rainbow">
    
        <a class="nexmoefont icon-appstore-fill -link" href="/categories/%E6%8A%80%E6%9C%AF/">技术</a>
    
    
        <a class="nexmoefont icon-tag-fill -none-link" href="/tags/JavaEE/" rel="tag">JavaEE</a> <a class="nexmoefont icon-tag-fill -none-link" href="/tags/Spring/" rel="tag">Spring</a>
    
</div>

  
      <div class="nexmoe-post-footer">
          <section class="nexmoe-comment">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.css">
<div id="gitalk"></div>
<script src="https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js"></script>
<script type="text/javascript">
    var gitalk = new Gitalk({
        clientID: 'ff024b5293a92e4461fd',
        clientSecret: 'c749602a0b62efd70c6ec86e7c4f0f62a5a8904c',
        id: window.location.pathname,
        repo: 'issue_repository',
        owner: 'Ykuri98',
        admin: 'Ykuri98'
    })
    gitalk.render('gitalk')
</script>
</section>
      </div>
  
</div>
            <div class="nexmoe-post-right">
              <div class="nexmoe-fixed">
                  <div class="nexmoe-tool"> 
                    
                      
                        
                          
                          
                              <button class="mdui-fab catalog" style="overflow:unset;">
                                  <i class="nexmoefont icon-i-catalog"></i>
                                  <div class="nexmoe-toc">
                                      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86"><span class="toc-number">1.</span> <span class="toc-text">动态代理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#JDK%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86"><span class="toc-number">1.1.</span> <span class="toc-text">JDK动态代理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Cglib%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86"><span class="toc-number">1.2.</span> <span class="toc-text">Cglib动态代理</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#IOC-x2F-DI"><span class="toc-number">2.</span> <span class="toc-text">IOC&#x2F;DI</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#XML"><span class="toc-number">2.1.</span> <span class="toc-text">XML</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B3%A8%E8%A7%A3"><span class="toc-number">2.2.</span> <span class="toc-text">注解</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E7%B1%BB"><span class="toc-number">2.3.</span> <span class="toc-text">配置类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Autowired"><span class="toc-number">2.4.</span> <span class="toc-text">@Autowired</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%84%E4%BB%B6%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="toc-number">3.</span> <span class="toc-text">组件的生命周期</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#AOP"><span class="toc-number">4.</span> <span class="toc-text">AOP</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%87%E5%85%A5%E7%82%B9Pointcut"><span class="toc-number">4.1.</span> <span class="toc-text">切入点Pointcut</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%9A%E7%9F%A5%E5%99%A8Advisor"><span class="toc-number">4.2.</span> <span class="toc-text">通知器Advisor</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%87%E9%9D%A2Aspect"><span class="toc-number">4.3.</span> <span class="toc-text">切面Aspect</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%9E%E6%8E%A5%E7%82%B9JoinPoint"><span class="toc-number">4.4.</span> <span class="toc-text">连接点JoinPoint</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Spring%E4%BA%8B%E5%8A%A1"><span class="toc-number">5.</span> <span class="toc-text">Spring事务</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SpringMVC"><span class="toc-number">6.</span> <span class="toc-text">SpringMVC</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#RequestMapping"><span class="toc-number">6.1.</span> <span class="toc-text">@RequestMapping</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ResponseBody"><span class="toc-number">6.2.</span> <span class="toc-text">@ResponseBody</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0%E7%9A%84%E6%8E%A5%E6%94%B6"><span class="toc-number">6.3.</span> <span class="toc-text">请求参数的接收</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PathVariable"><span class="toc-number">6.4.</span> <span class="toc-text">@PathVariable</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Converter"><span class="toc-number">6.5.</span> <span class="toc-text">Converter</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ResourceHandler"><span class="toc-number">6.6.</span> <span class="toc-text">ResourceHandler</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HandlerInterceptor"><span class="toc-number">6.7.</span> <span class="toc-text">HandlerInterceptor</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86"><span class="toc-number">6.8.</span> <span class="toc-text">异常处理</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SpringBoot"><span class="toc-number">7.</span> <span class="toc-text">SpringBoot</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B"><span class="toc-number">8.</span> <span class="toc-text">逆向工程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#TypeHandler"><span class="toc-number">9.</span> <span class="toc-text">TypeHandler</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Shiro%E6%A1%86%E6%9E%B6"><span class="toc-number">10.</span> <span class="toc-text">Shiro框架</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Realm"><span class="toc-number">10.1.</span> <span class="toc-text">Realm</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%A4%E8%AF%81"><span class="toc-number">10.2.</span> <span class="toc-text">认证</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HibernateValidation"><span class="toc-number">11.</span> <span class="toc-text">HibernateValidation</span></a></li></ol>
                                  </div>
                              </button>
                          
                          
                      
                    
                      <a href="#nexmoe-content" class="toc-link" aria-label="回到顶部" title="top"><button class="mdui-fab mdui-ripple"><i class="nexmoefont icon-caret-top"></i></button></a>
                  </div>
              </div>
            </div>
        </div>
    </div>
     
    <div id="nexmoe-search-space">
        <div class="search-container">
            <div class="search-header">
                <div class="search-input-container">
                    <input class="search-input" type="text" placeholder="搜索" oninput="sinput();">
                </div>
                <a class="search-close" onclick="sclose();">×</a>
            </div>
            <div class="search-body"></div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/mdui@0.4.3/dist/js/mdui.min.js?v=1"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@4.0/dist/fancybox.umd.js"></script>

 

<script async src="/js/app.js?v=1693554741067"></script>


	<script async src="/js/search.js?v=1693554741067"></script>


<script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js"></script>
<script>
	$(".justified-gallery").justifiedGallery({
		rowHeight: 160,
		margins: 10,
	});
</script>


    





    <!-- baidu Analytics -->
<script>
    var _hmt = _hmt || [];
    (function() {var hm = document.createElement('script');
    hm.src = 'https://hm.baidu.com/hm.js?ed4931f4a887a0876dd7a237254a9600';
    var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/hijiki.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false});</script></body>

</html>
