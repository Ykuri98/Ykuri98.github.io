<!DOCTYPE html>

<html lang="zh-CN">

<head>
    
    <title>å­¦ä¹ æ€»ç»“ï¼ˆ2022.06.15-2022.06.24ï¼‰ - Ykuriçš„å°è§’è½</title>
    <meta charset="UTF-8">
    <meta name="keywords" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5">
    
    

    <link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/Ykuri98/image_repository@latest/avatar.png" type="image/x-icon" />
    <meta name="description" content="åŠ¨æ€ä»£ç†JDKåŠ¨æ€ä»£ç†JDKåŠ¨æ€ä»£ç†æ˜¯åŸºäºJavaçš„åå°„æœºåˆ¶å®ç°çš„ï¼Œä½¿ç”¨jdkä¸­çš„æ¥å£å’Œç±»å®ç°ä»£ç†å¯¹è±¡çš„åŠ¨æ€åˆ›å»ºï¼Œä½†æ˜¯è¦æ±‚ä»£ç†å¯¹è±¡å¿…é¡»å®ç°æ¥å£ã€‚ JDKåŠ¨æ€ä»£ç†çš„å®ç°æ­¥éª¤å¦‚ä¸‹ã€‚  æ–°å»ºä¸€ä¸ªæ¥å£ï¼Œä½œä¸ºç›®æ ‡æ¥å£ã€‚  1234public interface UserService &amp;#123;    public void sayHello();&amp;#125;   ä¸ºæ¥å£åˆ›å»ºå®ç°ç±»ã€‚  12345678">
<meta property="og:type" content="article">
<meta property="og:title" content="å­¦ä¹ æ€»ç»“ï¼ˆ2022.06.15-2022.06.24ï¼‰">
<meta property="og:url" content="https://ykuri98.github.io/2022/07/04/%E5%AD%A6%E4%B9%A0%E6%80%BB%E7%BB%93%EF%BC%882022-06-15-2022-06-24%EF%BC%89/index.html">
<meta property="og:site_name" content="Ykuriçš„å°è§’è½">
<meta property="og:description" content="åŠ¨æ€ä»£ç†JDKåŠ¨æ€ä»£ç†JDKåŠ¨æ€ä»£ç†æ˜¯åŸºäºJavaçš„åå°„æœºåˆ¶å®ç°çš„ï¼Œä½¿ç”¨jdkä¸­çš„æ¥å£å’Œç±»å®ç°ä»£ç†å¯¹è±¡çš„åŠ¨æ€åˆ›å»ºï¼Œä½†æ˜¯è¦æ±‚ä»£ç†å¯¹è±¡å¿…é¡»å®ç°æ¥å£ã€‚ JDKåŠ¨æ€ä»£ç†çš„å®ç°æ­¥éª¤å¦‚ä¸‹ã€‚  æ–°å»ºä¸€ä¸ªæ¥å£ï¼Œä½œä¸ºç›®æ ‡æ¥å£ã€‚  1234public interface UserService &amp;#123;    public void sayHello();&amp;#125;   ä¸ºæ¥å£åˆ›å»ºå®ç°ç±»ã€‚  12345678">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2022-07-04T11:30:04.000Z">
<meta property="article:modified_time" content="2022-07-05T15:07:09.375Z">
<meta property="article:author" content="Ykuri98">
<meta property="article:tag" content="JavaEE">
<meta property="article:tag" content="Spring">
<meta name="twitter:card" content="summary">
    <link
        rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css"
    />
    <link
        rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"
    />
    
    <link rel="stylesheet" href="/lib/mdui_043tiny/css/mdui.css?v=1693554741061">
    <link rel="stylesheet" href="/lib/iconfont/iconfont.css?v=1693554741061">
    <link rel="stylesheet" href="/css/style.css?v=1693554741061">
     
    
<meta name="generator" content="Hexo 6.1.0"></head>

<body class="mdui-drawer-body-left">
    
    <div id="nexmoe-background">
        <div class="nexmoe-bg" style="background-image: url(https://cdn.jsdelivr.net/gh/Ykuri98/image_repository@latest/wallpaper.png)"></div>
        <div class="mdui-appbar mdui-shadow-0">
            <div class="mdui-toolbar">
                <a mdui-drawer="{target: '#drawer', swipe: true}" title="menu" class="mdui-btn mdui-btn-icon mdui-ripple"><i class="mdui-icon nexmoefont icon-menu"></i></a>
                <div class="mdui-toolbar-spacer"></div>
                <!--<a href="javascript:;" class="mdui-btn mdui-btn-icon"><i class="mdui-icon material-icons">search</i></a>-->
                <a href="/" title="Ykuri98" class="mdui-btn mdui-btn-icon"><img src="https://cdn.jsdelivr.net/gh/Ykuri98/image_repository@latest/avatar.png" alt="Ykuri98"></a>
            </div>
        </div>
    </div>
    <div id="nexmoe-header">
        <div class="nexmoe-drawer mdui-drawer" id="drawer">
    <div class="nexmoe-avatar mdui-ripple">
        <a href="/" title="Ykuri98">
            <img src="https://cdn.jsdelivr.net/gh/Ykuri98/image_repository@latest/avatar.png" alt="Ykuri98" alt="Ykuri98">
        </a>
    </div>
    <div class="nexmoe-count">
        <div><span>æ–‡ç« </span>46</div>
        <div><span>æ ‡ç­¾</span>14</div>
        <div><span>åˆ†ç±»</span>1</div>
    </div>
    <div class="nexmoe-list mdui-list" mdui-collapse="{accordion: true}">
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/" title="å›åˆ°é¦–é¡µ">
            <i class="mdui-list-item-icon nexmoefont icon-home"></i>
            <div class="mdui-list-item-content">
                å›åˆ°é¦–é¡µ
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/archive.html" title="æ–‡ç« å½’æ¡£">
            <i class="mdui-list-item-icon nexmoefont icon-container"></i>
            <div class="mdui-list-item-content">
                æ–‡ç« å½’æ¡£
            </div>
        </a>
        
    </div>
    <aside id="nexmoe-sidebar">
    
    <div class="nexmoe-widget-wrap">
    <div class="nexmoe-widget nexmoe-search">
        
            <form id="search_form">
                <label><input class="st-default-search-input" id="search_value" name="q" type="search" placeholder="æœç´¢" style="
                    font-size: 15px !important;
                    height: 56px !important;
                    background-image: none;
                "></label>
            </form>
         
    </div>
</div>
    
    <div class="nexmoe-widget-wrap">
    <div class="nexmoe-widget nexmoe-social">
        <a class="mdui-ripple" href="https://github.com/Ykuri98/" target="_blank" mdui-tooltip="{content: 'GitHub'}" style="color: rgb(25, 23, 23);background-color: rgba(25, 23, 23, .15);">
            <i class="nexmoefont icon-github"></i>
        </a>
    </div>
</div>
    
    
  <div class="nexmoe-widget-wrap">
    <h3 class="nexmoe-widget-title">æ–‡ç« åˆ†ç±»</h3>
    <div class="nexmoe-widget">

      <ul class="category-list">

        


        

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/æŠ€æœ¯/">æŠ€æœ¯</a>
          <span class="category-list-count">45</span>
        </li>

        
      </ul>

    </div>
  </div>


    
    
  <div class="nexmoe-widget-wrap">
    <div id="randomtagcloud" class="nexmoe-widget tagcloud nexmoe-rainbow">
      <a href="/tags/JavaEE/" style="font-size: 15px;">JavaEE</a> <a href="/tags/Kafka/" style="font-size: 10px;">Kafka</a> <a href="/tags/Nacos/" style="font-size: 10px;">Nacos</a> <a href="/tags/Oracle/" style="font-size: 10px;">Oracle</a> <a href="/tags/RabbitMQ/" style="font-size: 10px;">RabbitMQ</a> <a href="/tags/SQL/" style="font-size: 15px;">SQL</a> <a href="/tags/Spring/" style="font-size: 10px;">Spring</a> <a href="/tags/github/" style="font-size: 10px;">github</a> <a href="/tags/hexo/" style="font-size: 12.5px;">hexo</a> <a href="/tags/java/" style="font-size: 17.5px;">java</a> <a href="/tags/%E5%89%8D%E7%AB%AF/" style="font-size: 10px;">å‰ç«¯</a> <a href="/tags/%E5%B7%A5%E5%85%B7/" style="font-size: 10px;">å·¥å…·</a> <a href="/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1/" style="font-size: 10px;">å¾®æœåŠ¡</a> <a href="/tags/%E7%AE%97%E6%B3%95/" style="font-size: 20px;">ç®—æ³•</a>
    </div>
    
  </div>

    
    
  <div class="nexmoe-widget-wrap">
    <h3 class="nexmoe-widget-title">æ–‡ç« å½’æ¡£</h3>
    <div class="nexmoe-widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/">2023</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/">2022</a><span class="archive-list-count">39</span></li></ul>
    </div>
  </div>



    
    
  <div class="nexmoe-widget-wrap">
    <h3 class="nexmoe-widget-title">æœ€æ–°æ–‡ç« </h3>
    <div class="nexmoe-widget">
      <ul>
        
          <li>
            <a href="/2023/09/01/%E8%AE%B0%E4%B8%80%E6%AC%A1Oracle-SQL%E8%B0%83%E4%BC%98/">è®°ä¸€æ¬¡Oracle SQLè°ƒä¼˜</a>
          </li>
        
          <li>
            <a href="/2023/09/01/%E8%AE%B0%E4%B8%80%E6%AC%A1Nacos%E9%85%8D%E7%BD%AE%E8%BF%81%E7%A7%BB%E4%B8%8E%E6%9B%B4%E6%94%B9/">è®°ä¸€æ¬¡Nacosé…ç½®è¿ç§»ä¸æ›´æ”¹</a>
          </li>
        
          <li>
            <a href="/2023/09/01/RabbitMQ%E6%B6%88%E8%B4%B9%E5%A4%9A%E4%B8%AA%E9%9B%86%E7%BE%A4%E7%9A%84%E6%B6%88%E6%81%AF/">RabbitMQæ¶ˆè´¹å¤šä¸ªé›†ç¾¤çš„æ¶ˆæ¯</a>
          </li>
        
          <li>
            <a href="/2023/09/01/%E5%B7%A5%E4%BD%9C%E4%B8%AD%E7%9A%84%E4%B8%80%E4%BA%9B%E5%B0%8F%E9%97%AE%E9%A2%98%EF%BC%88%E6%8C%81%E7%BB%AD%E6%9B%B4%E6%96%B0%EF%BC%89/">å·¥ä½œä¸­çš„ä¸€äº›å°é—®é¢˜ï¼ˆæŒç»­æ›´æ–°ï¼‰</a>
          </li>
        
          <li>
            <a href="/2023/09/01/%E5%85%B3%E4%BA%8E%E7%BD%91%E5%85%B3%E8%B6%85%E6%97%B6%E7%9A%84%E4%B8%80%E4%BA%9B%E6%80%9D%E8%80%83%E4%B8%8E%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/">å…³äºç½‘å…³è¶…æ—¶çš„ä¸€äº›æ€è€ƒä¸è§£å†³æ–¹æ¡ˆ</a>
          </li>
        
      </ul>
    </div>
  </div>

    
</aside>
    <div class="nexmoe-copyright">
        &copy; 2023 Ykuri98
        Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
        & <a href="https://github.com/theme-nexmoe/hexo-theme-nexmoe" target="_blank">Nexmoe</a>
        
    </div>
</div><!-- .nexmoe-drawer -->
    </div>
    <div id="nexmoe-content">
        <div class="nexmoe-primary">
            <div class="nexmoe-post">

  <article>
      
          <div class="nexmoe-post-cover" style="padding-bottom: 56.25%;"> 
              <img data-fancybox="gallery" src="https://cdn.jsdelivr.net/gh/Ykuri98/image_repository@latest/wallpaper.png" alt="å­¦ä¹ æ€»ç»“ï¼ˆ2022.06.15-2022.06.24ï¼‰" loading="lazy">
              <h1>å­¦ä¹ æ€»ç»“ï¼ˆ2022.06.15-2022.06.24ï¼‰</h1>
          </div>
      
      
      <div class="nexmoe-post-meta nexmoe-rainbow" style="margin:10px 0!important;">
    <a><i class="nexmoefont icon-calendar-fill"></i>2022å¹´07æœˆ04æ—¥</a>
</div>

      <h2 id="åŠ¨æ€ä»£ç†"><a href="#åŠ¨æ€ä»£ç†" class="headerlink" title="åŠ¨æ€ä»£ç†"></a>åŠ¨æ€ä»£ç†</h2><h3 id="JDKåŠ¨æ€ä»£ç†"><a href="#JDKåŠ¨æ€ä»£ç†" class="headerlink" title="JDKåŠ¨æ€ä»£ç†"></a>JDKåŠ¨æ€ä»£ç†</h3><p>JDKåŠ¨æ€ä»£ç†æ˜¯åŸºäºJavaçš„åå°„æœºåˆ¶å®ç°çš„ï¼Œä½¿ç”¨jdkä¸­çš„æ¥å£å’Œç±»å®ç°ä»£ç†å¯¹è±¡çš„åŠ¨æ€åˆ›å»ºï¼Œä½†æ˜¯è¦æ±‚ä»£ç†å¯¹è±¡å¿…é¡»å®ç°æ¥å£ã€‚</p>
<p>JDKåŠ¨æ€ä»£ç†çš„å®ç°æ­¥éª¤å¦‚ä¸‹ã€‚</p>
<ol>
<li>æ–°å»ºä¸€ä¸ªæ¥å£ï¼Œä½œä¸ºç›®æ ‡æ¥å£ã€‚</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">UserService</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">sayHello</span><span class="hljs-params">()</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<ol start="2">
<li>ä¸ºæ¥å£åˆ›å»ºå®ç°ç±»ã€‚</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserServiceImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">UserService</span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">sayHello</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;hello spring&quot;</span>);<br>    &#125;<br>    <br>&#125;<br></code></pre></td></tr></table></figure>

<ol start="3">
<li>åˆ›å»ºä¸€ä¸ªç±»å®ç°InvocationHandleræ¥å£åŠå…¶invokeæ–¹æ³•ï¼Œåœ¨<code>method.invoke()</code>å‰åæ‰§è¡Œå¯¹æ–¹æ³•çš„å¢å¼ºã€‚</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CustomInvocationHandler</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">InvocationHandler</span> &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">invoke</span><span class="hljs-params">(Object proxy, Method method, Object[] args)</span> <span class="hljs-keyword">throws</span> Throwable &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<ol start="4">
<li>åœ¨mainæ–¹æ³•ä¸­è°ƒç”¨<code>Proxy.newProxyInstance()</code>åˆ›å»ºJDKåŠ¨æ€ä»£ç†ï¼Œä½¿ç”¨ä»£ç†å¯¹è±¡æ‰§è¡Œæ–¹æ³•ã€‚</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">mytest4</span><span class="hljs-params">()</span> &#123;<br>       <span class="hljs-type">UserService</span> <span class="hljs-variable">instance</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UserServiceImpl</span>(); <span class="hljs-comment">// instance ğŸ‘‰ method.invoke(instance,args);</span><br>       <span class="hljs-comment">// UserServiceImpl ğŸ‘‰ sayHello</span><br>       <span class="hljs-comment">// Proxy ğŸ‘‰ sayHello</span><br>       <span class="hljs-type">UserService</span> <span class="hljs-variable">userServiceProxy</span> <span class="hljs-operator">=</span> (UserService) Proxy.newProxyInstance(UserServiceImpl.class.getClassLoader(),<br>               UserServiceImpl.class.getInterfaces(),<br>               <span class="hljs-keyword">new</span> <span class="hljs-title class_">InvocationHandler</span>() &#123;<br>                   <span class="hljs-meta">@Override</span><br>                   <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">invoke</span><span class="hljs-params">(Object proxy, Method method, Object[] args)</span> <span class="hljs-keyword">throws</span> Throwable &#123;<br>                       <span class="hljs-comment">//jdsfkhjasdjyr</span><br>                       System.out.println(<span class="hljs-string">&quot;jdsfkhjasdjyr&quot;</span>);<br>                       <span class="hljs-type">Object</span> <span class="hljs-variable">invoke</span> <span class="hljs-operator">=</span> method.invoke(instance, args);<br>                       <span class="hljs-comment">//dfjkasdhjfisdya</span><br>                       System.out.println(<span class="hljs-string">&quot;dfjkasdhjfisdya&quot;</span>);<br>                       <span class="hljs-keyword">return</span> invoke;<br>                   &#125;<br>               &#125;);<br>       userServiceProxy.sayHello();<span class="hljs-comment">//invocationHandler.invoke</span><br>   &#125;<br></code></pre></td></tr></table></figure>

<h3 id="CglibåŠ¨æ€ä»£ç†"><a href="#CglibåŠ¨æ€ä»£ç†" class="headerlink" title="CglibåŠ¨æ€ä»£ç†"></a>CglibåŠ¨æ€ä»£ç†</h3><p>CglibåŠ¨æ€ä»£ç†åªé’ˆå¯¹ç±»å®ç°ä»£ç†ï¼Œä¸éœ€è¦å®ç°æ¥å£ã€‚</p>
<p>CglibåŠ¨æ€ä»£ç†çš„å®ç°æ­¥éª¤å¦‚ä¸‹ã€‚</p>
<ol>
<li>åˆ›å»ºä¸€ä¸ªç±»å®ç°MethodInterceptoræ¥å£åŠå…¶<code>intercept</code>æ–¹æ³•ã€‚</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyMethodInterceptor</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">MethodInterceptor</span> &#123;<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * cglib</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> o cglibç”Ÿæˆçš„ä»£ç†å¯¹è±¡</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> method è¢«ä»£ç†å¯¹è±¡çš„æ–¹æ³•</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> objects æ–¹æ³•å…¥å‚</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> methodProxy ä»£ç†æ–¹æ³•</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span></span><br><span class="hljs-comment">     * <span class="hljs-doctag">@throws</span> Throwable</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">intercept</span><span class="hljs-params">(Object o, Method method, Object[] objects, MethodProxy methodProxy)</span> <span class="hljs-keyword">throws</span> Throwable &#123;<br>        System.out.println(<span class="hljs-string">&quot;before advice...&quot;</span>);<br>        <span class="hljs-type">Object</span> <span class="hljs-variable">object</span> <span class="hljs-operator">=</span> methodProxy.invokeSuper(o, objects);<br>        System.out.println(<span class="hljs-string">&quot;after advice...&quot;</span>);<br>        <span class="hljs-keyword">return</span> object;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<ol start="2">
<li>åœ¨mainæ–¹æ³•ä¸­ï¼Œé€šè¿‡Enhancerè·å–ä»£ç†å¯¹è±¡ã€‚</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Main</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-comment">//é€šè¿‡CGLIBåŠ¨æ€ä»£ç†è·å–ä»£ç†å¯¹è±¡çš„è¿‡ç¨‹</span><br>        <span class="hljs-type">Enhancer</span> <span class="hljs-variable">enhancer</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Enhancer</span>();<br>        <span class="hljs-comment">//è®¾ç½®enhancerå¯¹è±¡çš„çˆ¶ç±»</span><br>        enhancer.setSuperclass(HelloService.class);<br>        <span class="hljs-comment">//è®¾ç½®enhancerçš„å›è°ƒå¯¹è±¡</span><br>        enhancer.setCallback(<span class="hljs-keyword">new</span> <span class="hljs-title class_">MyMethodInterceptor</span>());<br>        <span class="hljs-comment">//åˆ›å»ºä»£ç†å¯¹è±¡</span><br>        <span class="hljs-type">HelloService</span> <span class="hljs-variable">proxy</span> <span class="hljs-operator">=</span> (HelloService) enhancer.create();<br>        <span class="hljs-comment">//é€šè¿‡ä»£ç†å¯¹è±¡è°ƒç”¨ç›®æ ‡æ–¹æ³•</span><br>        proxy.sayHello();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="IOC-x2F-DI"><a href="#IOC-x2F-DI" class="headerlink" title="IOC&#x2F;DI"></a>IOC&#x2F;DI</h2><p>IOCï¼Œæ§åˆ¶åè½¬ï¼Œå°†ç”Ÿæˆå®ä¾‹çš„æ§åˆ¶æƒäº¤ç”±Springå®¹å™¨ï¼Œå®¹å™¨åªæ§åˆ¶å®ä¾‹çš„ç”Ÿæˆï¼Œè€Œå¼€å‘äººå‘˜åªéœ€è¦å¾€å®¹å™¨ä¸­æ³¨å†Œéœ€è¦ç”Ÿæˆå®ä¾‹çš„ç±»ï¼Œå³ç»„ä»¶ï¼Œå¹¶åœ¨éœ€è¦æ—¶å–å‡ºè¯¥ç»„ä»¶çš„å¯¹è±¡å³å¯ã€‚</p>
<p>DIï¼Œä¾èµ–æ³¨å…¥ï¼Œå³å…·ä½“çš„IOCå®ç°æ–¹å¼ã€‚ä¸€èˆ¬é€šè¿‡é…ç½®æ–‡ä»¶å’Œæ³¨è§£æ¥å®Œæˆä¾èµ–æ³¨å…¥ã€‚</p>
<h3 id="XML"><a href="#XML" class="headerlink" title="XML"></a>XML</h3><p>åœ¨Springçš„XMLæ–‡ä»¶ä¸­æ³¨å†Œç»„ä»¶ã€‚</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--æ³¨å†Œç»„ä»¶ â†’ æä¾›ä¿¡æ¯ â†’ å‘å®¹å™¨ä¸­æ”¾å…¥å®ä¾‹--&gt;</span><br><span class="hljs-comment">&lt;!--idå±æ€§ï¼šç»„ä»¶åœ¨å®¹å™¨ä¸­çš„å”¯ä¸€æ ‡è¯† â†’ å¯ä»¥çœç•¥--&gt;</span><br><span class="hljs-comment">&lt;!--classå±æ€§ï¼šç»„ä»¶çš„å…¨é™å®šç±»å--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;userDao&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.cskaoyan.dao.UserDaoImpl&quot;</span>/&gt;</span><br><br><span class="hljs-comment">&lt;!--setæ–¹æ³•æ¥ç»´æŠ¤ç»„ä»¶ä¹‹é—´çš„å…³ç³»--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;userService&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.cskaoyan.service.UserServiceImpl&quot;</span>&gt;</span><br>    <span class="hljs-comment">&lt;!--propertyæ ‡ç­¾çš„nameå±æ€§ â†’ setæ–¹æ³•--&gt;</span><br>    <span class="hljs-comment">&lt;!--refå±æ€§ï¼šreference â†’ å®¹å™¨ä¸­çš„ç»„ä»¶id--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;userDao&quot;</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;userDao&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;orderService&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.cskaoyan.service.OrderServiceImpl&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;userDao&quot;</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;userDao&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>å–å‡ºç»„ä»¶ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">mytest1</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-comment">// åˆå§‹åŒ–Springå®¹å™¨</span><br>    <span class="hljs-type">ApplicationContext</span> <span class="hljs-variable">applicationContext</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ClassPathXmlApplicationContext</span>(<span class="hljs-string">&quot;application.xml&quot;</span>);<br><br>    <span class="hljs-comment">// é€šè¿‡idå–å‡ºç»„ä»¶</span><br>    <span class="hljs-type">UserDao</span> <span class="hljs-variable">userDao</span> <span class="hljs-operator">=</span> (UserDao) applicationContext.getBean(<span class="hljs-string">&quot;userDao&quot;</span>);<br>    <span class="hljs-comment">// é€šè¿‡ç±»å‹å–å‡ºç»„ä»¶byType â†’ class å¯ä»¥å†™æ¥å£ã€å®ç°ç±» â†’ è¯¥ç±»å‹çš„ç»„ä»¶åœ¨å®¹å™¨ä¸­åªæœ‰ä¸€ä¸ª</span><br>    <span class="hljs-comment">// å»ºè®®ç”¨æ¥å£</span><br>    <span class="hljs-type">UserService</span> <span class="hljs-variable">userService1</span> <span class="hljs-operator">=</span> applicationContext.getBean(UserService.class);<br>    <span class="hljs-type">UserService</span> <span class="hljs-variable">userService2</span> <span class="hljs-operator">=</span> applicationContext.getBean(UserServiceImpl.class);<br><br>    <span class="hljs-comment">// é€šè¿‡idå’Œç±»å‹å…±åŒå–å‡º</span><br>    <span class="hljs-type">OrderService</span> <span class="hljs-variable">orderService</span> <span class="hljs-operator">=</span> applicationContext.getBean(<span class="hljs-string">&quot;orderService&quot;</span>, OrderService.class);<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="æ³¨è§£"><a href="#æ³¨è§£" class="headerlink" title="æ³¨è§£"></a>æ³¨è§£</h3><p>ä¹Ÿå¯ä»¥ä½¿ç”¨æ³¨è§£æ³¨å†Œç»„ä»¶ã€‚å¯ä»¥åœ¨æ³¨è§£ä¸­æŒ‡å®šç»„ä»¶idï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨é»˜è®¤çš„ç»„ä»¶idï¼Œé»˜è®¤idä¸€èˆ¬ä¸ºç±»åçš„é¦–å­—æ¯å°å†™ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// é€šç”¨æ³¨è§£</span><br><span class="hljs-meta">@Component</span><br><br><span class="hljs-comment">// serviceå±‚</span><br><span class="hljs-meta">@Service</span><br><br><span class="hljs-comment">// daoå±‚</span><br><span class="hljs-meta">@Repository</span><br><br><span class="hljs-comment">// controllerå±‚</span><br><span class="hljs-meta">@Controller</span><br></code></pre></td></tr></table></figure>

<h3 id="é…ç½®ç±»"><a href="#é…ç½®ç±»" class="headerlink" title="é…ç½®ç±»"></a>é…ç½®ç±»</h3><p>åœ¨ä¸€ä¸ªç±»ä¸ŠåŠ ä¸Š@Configurationæ³¨è§£ï¼Œè¡¨ç¤ºè¯¥ç±»è¢«æ³¨å†Œä¸ºä¸€ä¸ªç»„ä»¶ï¼Œä¸”è¯¥ç±»ä¸ºä¸€ä¸ªé…ç½®ç±»ã€‚ç±»ä¸­çš„æ–¹æ³•å¯ä»¥è¢«@Beanæ³¨è§£ä¿®é¥°ï¼Œè¡¨ç¤ºè¯¥æ–¹æ³•çš„è¿”å›å€¼çš„å®ä¾‹ä¼šè¢«æ³¨å†Œä¸ºä¸€ä¸ªç»„ä»¶ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Configuration</span><br><span class="hljs-comment">// @ComponentScanæ³¨è§£è¡¨ç¤ºæ‰«ææŒ‡å®šåŒ…ä¸‹çš„æ‰€æœ‰ç±»ï¼Œå¹¶å°†å¸¦æœ‰@Componentç­‰ç›¸å…³æ³¨è§£çš„ç±»æ³¨å†Œä¸ºç»„ä»¶</span><br><span class="hljs-meta">@ComponentScan(&quot;com.cskaoyan&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SpringConfiguration</span> &#123;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * è¿”å›å€¼ç±»å‹ï¼šSpringå®¹å™¨ä¸­çš„ç»„ä»¶ç±»å‹</span><br><span class="hljs-comment">     * è¿”å›å€¼ï¼šè¿”å›å€¼æ³¨å†Œä¸ºå®¹å™¨ä¸­çš„ç»„ä»¶</span><br><span class="hljs-comment">     * ç»„ä»¶IDï¼šé»˜è®¤å€¼æ˜¯æ–¹æ³•åï¼›å¦‚æœæƒ³è¦æŒ‡å®šç»„ä»¶idï¼Œå¯ä»¥ä½¿ç”¨<span class="hljs-doctag">@Bean</span>çš„valueå±æ€§</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Bean(&quot;druidDatasource&quot;)</span><br>    <span class="hljs-keyword">public</span> DataSource <span class="hljs-title function_">dataSource</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-type">DruidDataSource</span> <span class="hljs-variable">dataSource</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DruidDataSource</span>();<br>        dataSource.setDriverClassName(<span class="hljs-string">&quot;com.mysql.jdbc.Driver&quot;</span>);<br>        dataSource.setUrl(<span class="hljs-string">&quot;jdbc:mysql://localhost:3306/cskaoyan_db&quot;</span>);<br>        dataSource.setUsername(<span class="hljs-string">&quot;root&quot;</span>);<br>        dataSource.setPassword(<span class="hljs-string">&quot;123456&quot;</span>);<br><br>        <span class="hljs-keyword">return</span> dataSource;<br>    &#125;<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * å½¢å‚ï¼šé»˜è®¤æŒ‰ç…§ç±»å‹ä»å®¹å™¨ä¸­å–å‡ºç»„ä»¶;æƒ³è¦æŒ‡å®šç»„ä»¶id â†’ <span class="hljs-doctag">@Qualifier</span></span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-comment">// æ³¨å†Œä¸€ä¸ªUserServiceImplç»„ä»¶</span><br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-keyword">public</span> UserService <span class="hljs-title function_">userService</span><span class="hljs-params">(<span class="hljs-meta">@Qualifier(&quot;userDaoImpl&quot;)</span> UserDao userDao)</span> &#123;<br>        <span class="hljs-type">UserServiceImpl</span> <span class="hljs-variable">userService</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UserServiceImpl</span>();<br>        <span class="hljs-comment">// ä»å®¹å™¨ä¸­å–å‡ºuserDaoå¹¶ä¸”ç»™å…¶èµ‹å€¼</span><br>        userService.setUserDao(userDao);<br>        <span class="hljs-keyword">return</span> userService;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="Autowired"><a href="#Autowired" class="headerlink" title="@Autowired"></a>@Autowired</h3><p>ç±»ä¸­çš„æˆå‘˜å˜é‡å¯ä»¥é€šè¿‡@Autowiredæ³¨è§£æ³¨å†Œä¸ºç»„ä»¶ï¼Œæ­¤æ—¶è¯¥æˆå‘˜å˜é‡å°±ä¸éœ€è¦å¼€å‘äººå‘˜æ‰‹åŠ¨åˆå§‹åŒ–ã€‚@Autowiredçš„æœ¬è´¨æ˜¯åˆ©ç”¨å®¹å™¨æä¾›çš„setæ–¹æ³•ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Autowired</span><br><span class="hljs-comment">// å¦‚æœè¯¥ç±»å‹çš„ç»„ä»¶ä¸æ­¢ä¸€ä¸ªï¼Œéœ€è¦ä½¿ç”¨@Qualifieræ¥æŒ‡å®šç»„ä»¶çš„id</span><br><span class="hljs-meta">@Qualifier(&quot;userDaoImpl2&quot;)</span><br>UserDao userDao;<br></code></pre></td></tr></table></figure>

<h2 id="ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸ"><a href="#ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸ"></a>ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸ</h2><p>ç»„ä»¶å¯ä»¥ä½¿ç”¨@Scopeæ³¨è§£æ¥ç¡®å®šè‡ªå·±çš„ä½œç”¨åŸŸã€‚å¦‚æœä½œç”¨åŸŸä¸ºsingletonï¼Œå³å•ä¾‹æ¨¡å¼ï¼Œé‚£ä¹ˆæ¯æ¬¡ä»å®¹å™¨ä¸­å–å‡ºçš„ç»„ä»¶éƒ½æ˜¯åŒä¸€ä¸ªç»„ä»¶ï¼›å¦‚æœä½¿ç”¨çš„æ˜¯prototypeï¼Œå³åŸå‹æ¨¡å¼ï¼Œé‚£ä¹ˆæ¯æ¬¡å–å‡ºçš„éƒ½æ˜¯æ–°çš„å®ä¾‹ã€‚Springé»˜è®¤ä½¿ç”¨å•ä¾‹æ¨¡å¼ã€‚</p>
<p>åœ¨å•ä¾‹æ¨¡å¼ä¸‹ï¼Œå®¹å™¨åˆå§‹åŒ–æ—¶å°±ä¼šå¼€å§‹ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸï¼›å¦‚æœæ˜¯åŸå‹æ¨¡å¼ï¼Œåˆ™åªæœ‰åœ¨è·å¾—ç»„ä»¶æ—¶æ‰å¼€å§‹ç”Ÿå‘½å‘¨æœŸã€‚</p>
<p>ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸå¦‚ä¸‹ã€‚</p>
<ol>
<li><p>å®ä¾‹åŒ–ã€‚</p>
</li>
<li><p>ç»™æˆå‘˜å˜é‡èµ‹å€¼ã€‚ä¸€èˆ¬é€šè¿‡@Autowiredç­‰æ³¨è§£å®ç°ã€‚</p>
</li>
<li><p>è§‰é†’ï¼ˆAwareï¼‰ï¼Œå¦‚æœç»„ä»¶å®ç°äº†Awareç›¸å…³çš„æ¥å£ï¼Œåœ¨è¿™æ—¶ç»„ä»¶å°±å¯ä»¥é€šè¿‡è¯¥æ¥å£çš„setæ–¹æ³•è®¾ç½®ä¸€äº›æ•°æ®ã€‚æ¯”å¦‚ï¼Œå¦‚æœç»„ä»¶å®ç°äº†<code>BeanNameAware</code>æ¥å£ï¼Œé‚£ä¹ˆå°±å¯ä»¥è°ƒç”¨<code>setBeanName(String beanName)</code>æ–¹æ³•ã€‚</p>
</li>
<li><p>BeanPostProcessorï¼Œæä¾›äº†ä¸¤ä¸ªå®ç°æ–¹æ³•ï¼š<code>postProcessBeforeInitialization</code>å’Œ<code>postProcessAfterInitialization</code>ï¼Œå…¶ä½œç”¨èŒƒå›´ä¸ºæ‰€æœ‰æ³¨å†Œçš„ç»„ä»¶ã€‚æ­¤æ—¶è§¦å‘çš„æ˜¯beforeæ–¹æ³•ã€‚</p>
</li>
<li><p>InitializingBeançš„afterPropertiesSetæ–¹æ³• ï¼Œæˆ–æ˜¯è‡ªå®šä¹‰çš„initæ–¹æ³•ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">afterPropertiesSet</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>    System.out.println(<span class="hljs-string">&quot;InitializingBeanæä¾›çš„initæ–¹æ³•&quot;</span>);<br>&#125;<br><br><span class="hljs-comment">// è‡ªå®šä¹‰initæ–¹æ³•ï¼Œæ–¹æ³•åè‡ªå·±å®šä¹‰</span><br><span class="hljs-meta">@PostConstruct</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">init</span><span class="hljs-params">()</span> &#123;<br>    System.out.println(<span class="hljs-string">&quot;è‡ªå®šä¹‰init&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure>
</li>
<li><p>BeanPostProcessorçš„afteræ–¹æ³•ã€‚</p>
</li>
<li><p>ä½¿ç”¨ç»„ä»¶ã€‚</p>
</li>
<li><p>DisposableBeançš„destroyæ–¹æ³•ï¼Œæˆ–æ˜¯è‡ªå®šä¹‰çš„destroyæ–¹æ³•ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">destroy</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>    System.out.println(<span class="hljs-string">&quot;DisposableBeanæä¾›çš„destroy&quot;</span>);<br>&#125;<br><br><span class="hljs-meta">@PreDestroy</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">customDestroy</span><span class="hljs-params">()</span> &#123;<br>    System.out.println(<span class="hljs-string">&quot;è‡ªå®šä¹‰destroy&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure></li>
</ol>
<h2 id="AOP"><a href="#AOP" class="headerlink" title="AOP"></a>AOP</h2><p>AOPï¼Œé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼Œå¯ä»¥å°†ä¸€äº›ä¸ä¸šåŠ¡æ— å…³ï¼Œä½†æ˜¯æ‰€æœ‰ä¸šåŠ¡éƒ½éœ€è¦è°ƒç”¨çš„é€»è¾‘å°è£…èµ·æ¥ï¼ˆå¦‚æ—¥å¿—ï¼Œæƒé™æ§åˆ¶ç­‰ï¼‰ï¼Œå°†å…¶ä½œä¸ºä¸€ç§å¢å¼ºã€‚AOPåŸºäºåŠ¨æ€ä»£ç†å®ç°ï¼Œä½†æ˜¯ç›¸æ¯”åŠ¨æ€ä»£ç†ï¼ŒAOPå¯ä»¥æ›´çµæ´»çš„ç­›é€‰éœ€è¦å¢å¼ºçš„æ–¹æ³•ä»¥åŠå¢å¼ºæ‰€è¦åšçš„ä¸šåŠ¡ã€‚</p>
<p>ç°åœ¨ä¸€èˆ¬ä½¿ç”¨AspectJæ¡†æ¶å®ç°AOPã€‚</p>
<h3 id="åˆ‡å…¥ç‚¹Pointcut"><a href="#åˆ‡å…¥ç‚¹Pointcut" class="headerlink" title="åˆ‡å…¥ç‚¹Pointcut"></a>åˆ‡å…¥ç‚¹Pointcut</h3><p>ä½¿ç”¨executionæŒ‡å®šéœ€è¦å¢å¼ºçš„æ–¹æ³•ã€‚</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">aop:comfig</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">aop:pointcut</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;mypointcut1&quot;</span> <span class="hljs-attr">expression</span>=<span class="hljs-string">&quot;execution(public void</span></span><br><span class="hljs-string"><span class="hljs-tag">com.cskaoyan.service.UserServiceImpl.sayHello(String))&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">aop:pointcut</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;mypointcut2&quot;</span> <span class="hljs-attr">expression</span>=<span class="hljs-string">&quot;execution(* co*..say*(*))&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">aop:pointcut</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;mypointcut3&quot;</span> <span class="hljs-attr">expression</span>=<span class="hljs-string">&quot;execution(*</span></span><br><span class="hljs-string"><span class="hljs-tag">co*.cskaoyan..UserServiceImpl.sayHello(..))&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">aop:config</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>ä½¿ç”¨@annotationæŒ‡å®šç‰¹æ®Šçš„å¢å¼ºæ–¹æ³•ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Retention(RetentionPolicy.RUNTIME)</span><br><span class="hljs-meta">@Target(ElementType.METHOD)</span><br><span class="hljs-keyword">public</span> <span class="hljs-meta">@interface</span> CountTime &#123;<br>&#125;<br></code></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">aop:config</span>&gt;</span><br><span class="hljs-comment">&lt;!--ä½œç”¨åœºæ™¯ï¼šç»„ä»¶ä¸­çš„æ–¹æ³•ï¼ŒåŒ…å«è‡ªå®šä¹‰@CountTimeæ³¨è§£çš„æ–¹æ³•ç”Ÿæ•ˆ--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">aop:pointcut</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;mypointcut&quot;</span></span><br><span class="hljs-tag"><span class="hljs-attr">expression</span>=<span class="hljs-string">&quot;@annotation(com.cskaoyan.CountTime)&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">aop:config</span>&gt;</span><br></code></pre></td></tr></table></figure>

<h3 id="é€šçŸ¥å™¨Advisor"><a href="#é€šçŸ¥å™¨Advisor" class="headerlink" title="é€šçŸ¥å™¨Advisor"></a>é€šçŸ¥å™¨Advisor</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--advisor â†’ æ–°çš„æ ‡ç­¾ aopæ ‡ç­¾ â†’ å¼•å…¥aopçš„schemaçº¦æŸ--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">aop:config</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">aop:advisor</span> <span class="hljs-attr">advice-ref</span>=<span class="hljs-string">&quot;countTimeInterceptor&quot;</span> <span class="hljs-attr">pointcut</span>=<span class="hljs-string">&quot;execution(public void com.cskaoyan.service.UserServiceImpl.sayHello(String))&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">aop:config</span>&gt;</span><br></code></pre></td></tr></table></figure>

<h3 id="åˆ‡é¢Aspect"><a href="#åˆ‡é¢Aspect" class="headerlink" title="åˆ‡é¢Aspect"></a>åˆ‡é¢Aspect</h3><p>åˆ‡é¢æ˜¯ä¸Šé¢ä¸¤ç§çš„ç»“åˆï¼Œå³åœ¨æŒ‡å®šçš„åˆ‡å…¥ç‚¹å†™å…¥è‡ªå®šä¹‰çš„é€šçŸ¥ã€‚åˆ‡é¢æœ‰äº”ä¸ªé€šçŸ¥æ–¹æ³•ï¼Œåˆ†åˆ«æ˜¯Beforeã€Afterã€Aroundã€AfterReturningã€AfterThrowingã€‚Beforeå’ŒAfterè¡¨ç¤ºåœ¨è¯¥æ–¹æ³•çš„æ‰§è¡Œå‰åçš„é€šçŸ¥ï¼›Aroundç±»ä¼¼äºInvocationHandlerçš„<code>invoke()</code>å’ŒMethodInterceptorçš„<code>invoke()</code>ï¼Œå¯ä»¥åœ¨æ‰§è¡Œproceedæ–¹æ³•å‰åè¿›è¡Œæ“ä½œï¼ŒAroundä¹Ÿæ˜¯ä½¿ç”¨çš„æœ€å¤šçš„é€šçŸ¥ï¼›AfterReturningæ˜¯åœ¨æ–¹æ³•è¿”å›å€¼åä½¿ç”¨çš„é€šçŸ¥ï¼Œå¯ä»¥æ¥æ”¶æ–¹æ³•çš„è¿”å›å€¼ï¼›AfterThrowingæ˜¯åœ¨æ–¹æ³•æŠ›å‡ºå¼‚å¸¸åä½¿ç”¨çš„é€šçŸ¥ï¼Œå¯ä»¥æ¥æ”¶æ–¹æ³•çš„å¼‚å¸¸ã€‚</p>
<p>äº”ä¸ªé€šçŸ¥çš„å…ˆåé¡ºåºæ˜¯ï¼šBefore-&gt;Around-&gt;After&#x2F;AfterThrowing-&gt;AfterReturning</p>
<p>å¯ä»¥ä½¿ç”¨@Aspectæ³¨è§£æŒ‡å®šä¸€ä¸ªç»„ä»¶ä¸ºåˆ‡é¢ç»„ä»¶ï¼Œä¸”åœ¨ç±»ä¸­çš„æ–¹æ³•è¦ä½¿ç”¨@Beforeã€@Afterã€@Aroundã€@AfterReturningã€@AfterThrowingæ³¨è§£ä¿®é¥°æ–¹æ³•ã€‚</p>
<p>@Aspect<br>@Component<br>public class CustomAspect {</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Aspect</span><br><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CustomAspect</span> &#123;<br><br>    <span class="hljs-comment">//@Pointcutæ³¨è§£å¢åŠ åœ¨æ–¹æ³•ä¸Š â†’ valueå±æ€§å†™åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ï¼Œæ–¹æ³•åä½œä¸ºåˆ‡å…¥ç‚¹çš„id</span><br>    <span class="hljs-meta">@Pointcut(&quot;execution(* com.cskaoyan.service..*(..))&quot;)</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">servicePointcut</span><span class="hljs-params">()</span> &#123;<br>    &#125;<br><br>    <span class="hljs-comment">// åˆ‡é¢ç»„ä»¶ä¸­çš„æ–¹æ³•ï¼Œä½œä¸ºå¯¹åº”çš„é€šçŸ¥æ–¹æ³• â†’ åœ¨å¯¹åº”çš„æ—¶é—´ç‚¹ä¸‹ä¼šæ‰§è¡Œåˆ°å¯¹åº”çš„æ–¹æ³•</span><br>    <span class="hljs-comment">// é€šçŸ¥æ³¨è§£çš„valueå±æ€§ï¼šå¯ä»¥ç›´æ¥å†™åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ï¼›ä¹Ÿå¯ä»¥å¼•ç”¨åˆ‡å…¥ç‚¹æ–¹æ³•</span><br>    <span class="hljs-meta">@Before(&quot;servicePointcut()&quot;)</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">beforex</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;beforeæ–¹æ³•&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@After(&quot;servicePointcut()&quot;)</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">after</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;afteré€šçŸ¥æ–¹æ³•&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-comment">// Aroundé€šçŸ¥ â†’ æœ€å¼ºé€šçŸ¥ ï¼šè¿”å›å€¼ä¸ºObjectï¼Œè¦æœ‰å§”æ‰˜ç±»æ–¹æ³•çš„æ‰§è¡Œ</span><br>    <span class="hljs-comment">// ç±»ä¼¼äºInvocationHandlerçš„invokeï¼Œç±»ä¼¼äºMethodInterceptorçš„invoke</span><br>    <span class="hljs-comment">// æ‰§è¡Œå§”æ‰˜ç±»çš„æ–¹æ³•ï¼šProceedingJoinPoint proceedæ–¹æ³•</span><br>    <span class="hljs-meta">@Around(&quot;servicePointcut()&quot;)</span><br>    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">around</span><span class="hljs-params">(ProceedingJoinPoint joinPoint)</span> <span class="hljs-keyword">throws</span> Throwable &#123;<br>        <span class="hljs-type">long</span> <span class="hljs-variable">start</span> <span class="hljs-operator">=</span> System.currentTimeMillis();<br>        System.out.println(<span class="hljs-string">&quot;å¼€å§‹æ—¶é—´ï¼š&quot;</span> + start);<br><br>        <span class="hljs-type">Object</span> <span class="hljs-variable">proceed</span> <span class="hljs-operator">=</span> joinPoint.proceed(); <span class="hljs-comment">// æ‰§è¡Œå§”æ‰˜ç±»çš„æ–¹æ³•</span><br><br>        <span class="hljs-type">long</span> <span class="hljs-variable">end</span> <span class="hljs-operator">=</span> System.currentTimeMillis();<br>        System.out.println(<span class="hljs-string">&quot;æ–¹æ³•æ‰§è¡Œæ—¶é—´ï¼š&quot;</span> + (end - start));<br>        <span class="hljs-keyword">return</span> proceed; <span class="hljs-comment">// å°±æ˜¯ä½œä¸ºä»£ç†å¯¹è±¡æ‰§è¡Œæ–¹æ³•çš„è¿”å›å€¼</span><br>    &#125;<br><br>    <span class="hljs-comment">// afterReturningé€šçŸ¥æ–¹æ³•çš„å½¢å‚ï¼Œé‡‡ç”¨Objectç±»å‹ï¼Œæ¥æ”¶å§”æ‰˜ç±»æ–¹æ³•çš„è¿”å›å€¼</span><br>    <span class="hljs-meta">@AfterReturning(value = &quot;servicePointcut()&quot;,returning = &quot;result&quot;)</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">afterReturning</span><span class="hljs-params">(Object result)</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;AfterReturningæ¥æ”¶åˆ°çš„ç»“æœï¼š&quot;</span> + result);<br>    &#125;<br><br>    <span class="hljs-comment">// public void afterThrowing(Exception exception) &#123;</span><br>    <span class="hljs-meta">@AfterThrowing(value = &quot;servicePointcut()&quot;,throwing = &quot;exception&quot;)</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">afterThrowing</span><span class="hljs-params">(Throwable exception)</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;afterThrowingé€šçŸ¥ï¼š&quot;</span> + exception.getMessage());<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="è¿æ¥ç‚¹JoinPoint"><a href="#è¿æ¥ç‚¹JoinPoint" class="headerlink" title="è¿æ¥ç‚¹JoinPoint"></a>è¿æ¥ç‚¹JoinPoint</h3><p>åœ¨Beforeå’ŒAroundé€šçŸ¥æ‰§è¡Œè¿‡ç¨‹ä¸­å¯ä»¥è·å¾—JoinPointï¼Œé€šè¿‡å®ƒæ‹¿åˆ°ä¸€äº›ä¿¡æ¯ï¼Œè¿™æ„å‘³ç€åœ¨é€šçŸ¥ä¸­å¯ä»¥æœ‰æ›´å¤šæ“ä½œç©ºé—´ã€‚</p>
<p>joinPointå¯ä»¥ç›´æ¥å†™åœ¨é€šçŸ¥æ–¹æ³•çš„å½¢å‚ä¸­ï¼Œé€šè¿‡è°ƒç”¨å…¶æ–¹æ³•è·å–ä¿¡æ¯ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Before(&quot;servicePointcut()&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">beforex</span><span class="hljs-params">(JoinPoint joinPoint)</span> &#123;<br>    <span class="hljs-comment">// ä»£ç†ç±»</span><br>    <span class="hljs-type">Object</span> <span class="hljs-variable">proxy</span> <span class="hljs-operator">=</span> joinPoint.getThis();<br>    <span class="hljs-comment">// ç›®æ ‡ç±»ã€å§”æ‰˜ç±»å¯¹è±¡</span><br>    <span class="hljs-type">Object</span> <span class="hljs-variable">target</span> <span class="hljs-operator">=</span> joinPoint.getTarget();<br>    <span class="hljs-comment">// å‚æ•°</span><br>    Object[] args = joinPoint.getArgs();<br>    <span class="hljs-comment">// æ–¹æ³•</span><br>    <span class="hljs-type">Signature</span> <span class="hljs-variable">signature</span> <span class="hljs-operator">=</span> joinPoint.getSignature();<br>    <span class="hljs-type">String</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span> signature.getName();<br>    System.out.println(<span class="hljs-string">&quot;æ­£åœ¨æ‰§è¡Œçš„æ–¹æ³•ï¼š&quot;</span> + name);<br><br>    System.out.println(<span class="hljs-string">&quot;beforeæ–¹æ³•&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="Springäº‹åŠ¡"><a href="#Springäº‹åŠ¡" class="headerlink" title="Springäº‹åŠ¡"></a>Springäº‹åŠ¡</h2><p>Springäº‹åŠ¡æœ‰ä¸‰ç§äº‹åŠ¡ä¼ æ’­è¡Œä¸ºï¼Œåˆ†åˆ«æ˜¯REQUIREDã€REQUIRES_NEWã€NESTEDã€‚</p>
<p>REQUIREDï¼šSpringé»˜è®¤ã€‚å¦‚æœå¤–å›´çš„æ–¹æ³•ä¸åŒ…å«äº‹åŠ¡ï¼Œé‚£ä¹ˆè¢«ä¿®é¥°çš„å†…éƒ¨æ–¹æ³•å°±æ·»åŠ ä¸€ä¸ªæ–°çš„äº‹åŠ¡ï¼›å¦‚æœå¤–å›´æ–¹æ³•åŒ…å«äº‹åŠ¡ï¼Œåˆ™å†…éƒ¨æ–¹æ³•åŠ å…¥è¯¥äº‹åŠ¡ï¼Œè¦ä¹ˆä¸€èµ·æäº¤è¦ä¹ˆä¸€èµ·å›æ»šã€‚</p>
<p>REQUIRES_NEWï¼šå¦‚æœå¤–å›´çš„æ–¹æ³•ä¸åŒ…å«äº‹åŠ¡ï¼Œé‚£ä¹ˆå†…éƒ¨æ–¹æ³•å°±æ·»åŠ ä¸€ä¸ªæ–°çš„äº‹åŠ¡ï¼›å¦‚æœå¤–å›´æ–¹æ³•åŒ…å«äº‹åŠ¡ï¼Œå†…éƒ¨æ–¹æ³•ä¹Ÿæ·»åŠ ä¸€ä¸ªäº‹åŠ¡ï¼Œä¸”è¯¥äº‹åŠ¡ä¸å¤–å›´çš„äº‹åŠ¡ç‹¬ç«‹ã€‚</p>
<p>NESTEDï¼šå¦‚æœå¤–å›´çš„æ–¹æ³•ä¸åŒ…å«äº‹åŠ¡ï¼Œé‚£ä¹ˆå†…éƒ¨æ–¹æ³•å°±æ·»åŠ ä¸€ä¸ªæ–°çš„äº‹åŠ¡ï¼›å¦‚æœå¤–å›´æ–¹æ³•åŒ…å«äº‹åŠ¡ï¼Œå†…éƒ¨æ–¹æ³•ä¹Ÿæ·»åŠ ä¸€ä¸ªäº‹åŠ¡ï¼Œä¸”è¯¥äº‹åŠ¡ä¸å¤–å›´çš„äº‹åŠ¡æˆåµŒå¥—å…³ç³»ã€‚</p>
<p>Springäº‹åŠ¡çš„å¼€å¯æ–¹å¼æœ‰ï¼š</p>
<ol>
<li><p>PlatFormTransactionManagerï¼Œå¹³å°äº‹åŠ¡ç®¡ç†å™¨</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">PlatformTransactionManager</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">TransactionManager</span> &#123;<br>    <span class="hljs-comment">// æ ¹æ®äº‹åŠ¡çš„å®šä¹‰ï¼Œè·å¾—äº‹åŠ¡çš„çŠ¶æ€ â†’ å¼€å¯äº‹åŠ¡</span><br>    TransactionStatus <span class="hljs-title function_">getTransaction</span><span class="hljs-params">(<span class="hljs-meta">@Nullable</span> TransactionDefinition var1)</span> <span class="hljs-keyword">throws</span> TransactionException;<br>	<span class="hljs-comment">// æäº¤ â†’ å‚æ•°æ˜¯TransactionStatus</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">commit</span><span class="hljs-params">(TransactionStatus var1)</span> <span class="hljs-keyword">throws</span> TransactionException;<br>	<span class="hljs-comment">// å›æ»š â†’ å‚æ•°æ˜¯TransactionStatus</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">rollback</span><span class="hljs-params">(TransactionStatus var1)</span> <span class="hljs-keyword">throws</span> TransactionException;<br>&#125;<br></code></pre></td></tr></table></figure>
</li>
<li><p>TransactionTemplate </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TransferTransactionCallBack</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">TransactionCallback</span> &#123;<br><br>    AccountMapper accountMapper;<br>    Integer fromId;<br>    Integer destId;<br>    Integer fromMoney;<br>    Integer destMoney;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">TransferTransactionCallBack</span><span class="hljs-params">(AccountMapper accountMapper, Integer fromId, Integer destId, Integer fromMoney, Integer destMoney)</span> &#123;<br>        <span class="hljs-built_in">this</span>.accountMapper = accountMapper;<br>        <span class="hljs-built_in">this</span>.fromId = fromId;<br>        <span class="hljs-built_in">this</span>.destId = destId;<br>        <span class="hljs-built_in">this</span>.fromMoney = fromMoney;<br>        <span class="hljs-built_in">this</span>.destMoney = destMoney;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">doInTransaction</span><span class="hljs-params">(TransactionStatus transactionStatus)</span> &#123;<br>        <span class="hljs-comment">// æ›´æ–°money</span><br>        <span class="hljs-type">int</span> <span class="hljs-variable">update1</span> <span class="hljs-operator">=</span> accountMapper.update(fromId, fromMoney);<br>        <span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span> / <span class="hljs-number">0</span>;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">update2</span> <span class="hljs-operator">=</span> accountMapper.update(destId, destMoney);<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
</li>
<li><p>åœ¨é…ç½®ç±»ä½¿ç”¨@EnableTransactionManagementæ³¨è§£å¼€å¯äº‹åŠ¡ï¼Œåœ¨éœ€è¦äº‹åŠ¡çš„ç±»æˆ–æ–¹æ³•ä¸­ä½¿ç”¨æ³¨è§£@Transactionalã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Transactional</span><br><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">transfer</span><span class="hljs-params">(<span class="hljs-type">int</span> fromId, <span class="hljs-type">int</span> destId, Integer money)</span> &#123;<br>    <span class="hljs-comment">// æŸ¥è¯¢ç°æœ‰çš„moneyæ˜¯å¤šå°‘</span><br>    <span class="hljs-type">Integer</span> <span class="hljs-variable">fromMoney</span> <span class="hljs-operator">=</span> accountMapper.select(fromId);<br>    <span class="hljs-type">Integer</span> <span class="hljs-variable">destMoney</span> <span class="hljs-operator">=</span> accountMapper.select(destId);<br><br>    <span class="hljs-comment">// è®¡ç®—è½¬è´¦åçš„moneyæ˜¯å¤šå°‘</span><br>    fromMoney -= money;<br>    destMoney += money;<br><br>    <span class="hljs-comment">// æ›´æ–°money</span><br>    <span class="hljs-type">int</span> <span class="hljs-variable">update1</span> <span class="hljs-operator">=</span> accountMapper.update(fromId, fromMoney);<br>    <span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span> / <span class="hljs-number">0</span>;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">update2</span> <span class="hljs-operator">=</span> accountMapper.update(destId, destMoney);<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
</ol>
<h2 id="SpringMVC"><a href="#SpringMVC" class="headerlink" title="SpringMVC"></a>SpringMVC</h2><p>ä¼ ç»Ÿçš„Servletæ˜ å°„è¿‡ç¨‹ç¹çï¼Œéœ€è¦æˆ‘ä»¬è‡ªå·±å¤„ç†urlå’ŒServletçš„æ˜ å°„å…³ç³»ï¼Œå¹¶æ ¹æ®urlåˆ¤æ–­ã€åˆ†å‘æ¥å£è‡³ä¸åŒçš„æ–¹æ³•ä¸­ï¼Œä¸”è¯·æ±‚å‚æ•°ã€å“åº”ç»“æœéƒ½è¦è‡ªå·±æ‰‹åŠ¨æ‹†å°jsonã€‚åœ¨SpringMVCä¸­ï¼Œåˆ™åªç”±ä¸€ä¸ªServletï¼šDispatcherServletæ¥è§£å†³ä¸Šè¿°é—®é¢˜ã€‚</p>
<p>åœ¨SpringMVCä¸­çš„æµç¨‹å¦‚ä¸‹ã€‚</p>
<ol>
<li>å®¢æˆ·ç«¯ï¼ˆæµè§ˆå™¨ï¼‰å‘é€è¯·æ±‚ï¼Œç›´æ¥è¯·æ±‚åˆ° <code>DispatcherServlet</code>ã€‚</li>
<li><code>DispatcherServlet</code> æ ¹æ®è¯·æ±‚ä¿¡æ¯è°ƒç”¨ <code>HandlerMapping</code>ï¼Œè§£æè¯·æ±‚å¯¹åº”çš„ <code>Handler</code>ã€‚</li>
<li>è§£æåˆ°å¯¹åº”çš„ <code>Handler</code>ï¼ˆä¹Ÿå°±æ˜¯æˆ‘ä»¬å¹³å¸¸è¯´çš„ <code>Controller</code> æ§åˆ¶å™¨ï¼‰åï¼Œå¼€å§‹ç”± <code>HandlerAdapter</code> é€‚é…å™¨å¤„ç†ã€‚</li>
<li><code>HandlerAdapter</code> ä¼šæ ¹æ® <code>Handler</code>æ¥è°ƒç”¨çœŸæ­£çš„å¤„ç†å™¨å¼€å¤„ç†è¯·æ±‚ï¼Œå¹¶å¤„ç†ç›¸åº”çš„ä¸šåŠ¡é€»è¾‘ã€‚</li>
<li>å¤„ç†å™¨å¤„ç†å®Œä¸šåŠ¡åï¼Œä¼šè¿”å›ä¸€ä¸ª <code>ModelAndView</code> å¯¹è±¡ï¼Œ<code>Model</code> æ˜¯è¿”å›çš„æ•°æ®å¯¹è±¡ï¼Œ<code>View</code> æ˜¯ä¸ªé€»è¾‘ä¸Šçš„ <code>View</code>ã€‚</li>
<li><code>ViewResolver</code> ä¼šæ ¹æ®é€»è¾‘ <code>View</code> æŸ¥æ‰¾å®é™…çš„ <code>View</code>ã€‚</li>
<li><code>DispaterServlet</code> æŠŠè¿”å›çš„ <code>Model</code> ä¼ ç»™ <code>View</code>ï¼ˆè§†å›¾æ¸²æŸ“ï¼‰ã€‚</li>
<li>æŠŠ <code>View</code> è¿”å›ç»™è¯·æ±‚è€…ï¼ˆæµè§ˆå™¨ï¼‰</li>
</ol>
<p>åœ¨SpringMVCä¸­ï¼Œå¯ä»¥å®Œå…¨ä½¿ç”¨JavaConfigä»£æ›¿é…ç½®æ–‡ä»¶ï¼Œä¸»è¦æœ‰ï¼š</p>
<ol>
<li><p>AACDSIï¼ˆAbstractAnnotationConfigDispatcherServletInitializerï¼‰</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ApplicationInitializer</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AbstractAnnotationConfigDispatcherServletInitializer</span> &#123;<br>    <br>    <span class="hljs-comment">// åŠ è½½Springçš„é…ç½®æ–‡ä»¶application.xml â†’ é…ç½®ç±»</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> Class&lt;?&gt;[] getRootConfigClasses() &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Class</span>[]&#123;SpringConfiguration.class&#125;;<br>    &#125;<br><br>    <span class="hljs-comment">// åŠ è½½SpringMVCçš„é…ç½®æ–‡ä»¶application-mvc.xml â†’ é…ç½®ç±»</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> Class&lt;?&gt;[] getServletConfigClasses() &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Class</span>[]&#123;MvcConfiguration.class&#125;;<br>    &#125;<br><br>    <span class="hljs-comment">// DispatcherServletçš„æ˜ å°„èŒƒå›´</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> String[] getServletMappings() &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>[]&#123;<span class="hljs-string">&quot;/&quot;</span>&#125;;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
</li>
<li><p>Springé…ç½®ç±»ï¼Œç”¨@Configurationä¿®é¥°</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@ComponentScan(value = &quot;com.cskaoyan&quot;,</span><br><span class="hljs-meta">        excludeFilters = @ComponentScan.Filter(&#123;Controller.class, EnableWebMvc.class&#125;))</span> <span class="hljs-comment">// mvcé…ç½®ç±»ä¹Ÿåœ¨æ‰«æåŒ…èŒƒå›´</span><br><span class="hljs-meta">@Configuration</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SpringConfiguration</span> &#123;<br>&#125;<br></code></pre></td></tr></table></figure>
</li>
<li><p>SpringMVCé…ç½®ç±»ï¼Œç”¨@EnableWebMvcä¿®é¥°</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@ComponentScan(&quot;com.cskaoyan.controller&quot;)</span><br><span class="hljs-meta">@EnableWebMvc</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MvcConfiguration</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">WebMvcConfigurer</span> &#123;<br>&#125;<br></code></pre></td></tr></table></figure></li>
</ol>
<h3 id="RequestMapping"><a href="#RequestMapping" class="headerlink" title="@RequestMapping"></a>@RequestMapping</h3><p>ç”¨äºurlçš„è·¯å¾„æ˜ å°„ï¼Œå¯ä»¥å†™åœ¨ç±»æˆ–æ–¹æ³•ä¸Šã€‚</p>
<p>åŒä¸€ä¸ªRequestMappingå¯ä»¥æ˜ å°„å¤šä¸ªè·¯å¾„ï¼Œé€šè¿‡æ•°ç»„è¡¨ç¤ºã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RequestMapping(&#123;&quot;hello&quot;,&quot;hello2&quot;,&quot;hello3&quot;&#125;)</span><br>   <span class="hljs-meta">@ResponseBody</span><br>   <span class="hljs-keyword">public</span> String <span class="hljs-title function_">hello</span><span class="hljs-params">()</span> &#123;<br>       <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;hello world&quot;</span>;<br>   &#125;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment">    * ä¹Ÿå¯ä»¥ä½¿ç”¨é€šé…ç¬¦ *</span><br><span class="hljs-comment">    */</span><br>   <span class="hljs-meta">@RequestMapping(&#123;&quot;goodbye/*&quot;, &quot;goodbye*&quot;&#125;)</span><br>   <span class="hljs-meta">@ResponseBody</span><br>   <span class="hljs-keyword">public</span> String <span class="hljs-title function_">goodbye</span><span class="hljs-params">()</span> &#123;<br>       <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;byebye&quot;</span>;<br>   &#125;<br></code></pre></td></tr></table></figure>

<p>å¦‚æœè¯·æ±‚urlåŒ…å«å…±åŒçš„å‰ç¼€ï¼Œå¯ä»¥æå–è‡³ä¿®é¥°ç±»çš„æ³¨è§£ä¸­ï¼Œè¿™ç§°ä¸ºçª„åŒ–è¯·æ±‚ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Controller</span><br><span class="hljs-meta">@RequestMapping(&quot;user&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserController</span> &#123;<br><br>    <span class="hljs-comment">//@RequestMapping(&quot;user/login&quot;)</span><br>    <span class="hljs-meta">@RequestMapping(&quot;login&quot;)</span> <br>    <span class="hljs-meta">@ResponseBody</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">login</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;login&quot;</span>;<br>    &#125;<br>    <span class="hljs-comment">//@RequestMapping(&quot;user/register&quot;)</span><br>    <span class="hljs-meta">@RequestMapping(&quot;register&quot;)</span><br>    <span class="hljs-meta">@ResponseBody</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">register</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;register&quot;</span>;<br>    &#125;<br>    <span class="hljs-comment">//@RequestMapping(&quot;user/modify&quot;)</span><br>    <span class="hljs-meta">@RequestMapping(&quot;modify&quot;)</span><br>    <span class="hljs-meta">@ResponseBody</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">modify</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;modify&quot;</span>;<br>    &#125;<br>    <span class="hljs-comment">//@RequestMapping(&quot;user/remove&quot;)</span><br>    <span class="hljs-meta">@RequestMapping(&quot;remove&quot;)</span><br>    <span class="hljs-meta">@ResponseBody</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">remove</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;remove&quot;</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>@RequestMappingè¿˜æœ‰å¤šç§å±æ€§ï¼š</p>
<ul>
<li><p>methodï¼šç”¨äºé™å®šè¯·æ±‚æ–¹æ³•ã€‚å¦‚GETã€POSTã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RequestMapping(value = &quot;get&quot;,method = RequestMethod.GET)</span><br>   <span class="hljs-meta">@ResponseBody</span><br>   <span class="hljs-keyword">public</span> String <span class="hljs-title function_">methodGet</span><span class="hljs-params">()</span> &#123;<br>       <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Method GET&quot;</span>;<br>   &#125;<br></code></pre></td></tr></table></figure>
</li>
<li><p>paramsï¼šç”¨äºé™å®šå‚æ•°ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RequestMapping(value = &quot;login&quot;,params = &#123;&quot;username&quot;,&quot;password&quot;&#125;)</span> <span class="hljs-comment">// æ—¢è¦æºå¸¦usernameåˆè¦æºå¸¦password</span><br>   <span class="hljs-meta">@ResponseBody</span><br>   <span class="hljs-keyword">public</span> String <span class="hljs-title function_">login</span><span class="hljs-params">()</span> &#123;<br>       <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;ok&quot;</span>;<br>   &#125;<br></code></pre></td></tr></table></figure>
</li>
<li><p>headersï¼šç”¨äºé™å®šè¯·æ±‚å¤´ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RequestMapping(value = &quot;limit&quot;, headers = &#123;&quot;abc&quot;, &quot;def&quot;&#125;)</span><span class="hljs-comment">//æ—¢è¦æºå¸¦abcã€åˆè¦æºå¸¦defè¿™ä¸¤ä¸ªè¯·æ±‚å¤´</span><br>  <span class="hljs-meta">@ResponseBody</span><br>  <span class="hljs-keyword">public</span> String <span class="hljs-title function_">headerLimit</span><span class="hljs-params">()</span> &#123;<br>      <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;header limit&quot;</span>;<br>  &#125;<br></code></pre></td></tr></table></figure>
</li>
<li><p>consumesï¼šç”¨äºé™å®šContent-Typeçš„å€¼ã€‚</p>
</li>
<li><p>producesï¼šç”¨äºé™å®šAcceptçš„å€¼</p>
</li>
</ul>
<h3 id="ResponseBody"><a href="#ResponseBody" class="headerlink" title="@ResponseBody"></a>@ResponseBody</h3><p>åœ¨Controllerä¸Šæ·»åŠ æ³¨è§£@ResponseBodyï¼Œå³å¯å°†è¿”å›å€¼è‡ªåŠ¨åŒ…è£…ä¸ºjsonã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Controller</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">JsonController</span> &#123;<br><br>    <span class="hljs-meta">@RequestMapping(&quot;json&quot;)</span><br>    <span class="hljs-meta">@ResponseBody</span><br>    <span class="hljs-keyword">public</span> User <span class="hljs-title function_">json</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>(<span class="hljs-string">&quot;123&quot;</span>,<span class="hljs-string">&quot;456&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>å¯ä»¥ä½¿ç”¨@RestControlleræ¥ä»£æ›¿@Controllerå’Œ @ResponseBodyã€‚</p>
<h3 id="è¯·æ±‚å‚æ•°çš„æ¥æ”¶"><a href="#è¯·æ±‚å‚æ•°çš„æ¥æ”¶" class="headerlink" title="è¯·æ±‚å‚æ•°çš„æ¥æ”¶"></a>è¯·æ±‚å‚æ•°çš„æ¥æ”¶</h3><p>å¦‚æœæ˜¯æ™®é€šçš„getè¯·æ±‚ï¼Œå¯ä»¥ä½¿ç”¨æ–¹æ³•å½¢å‚æ¥æ¥æ”¶å‚æ•°ï¼Œä½†è¦æ±‚å½¢å‚åä¸å‚æ•°åå¿…é¡»ä¸€è‡´ã€‚ç±»å‹æ”¯æŒï¼š</p>
<ul>
<li>å­—ç¬¦ä¸²String</li>
<li>åŸºæœ¬ç±»å‹ä»¥åŠå¯¹åº”åŒ…è£…ç±»</li>
<li>æ•°ç»„</li>
<li>Dateï¼ˆéœ€è¦ä½¿ç”¨@DateTimeFormatæ¥æ ‡å‡†åŒ–æ—¥æœŸæ ¼å¼ï¼‰</li>
<li>æ–‡ä»¶</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RequestMapping(&quot;register5&quot;)</span><br><span class="hljs-keyword">public</span> BaseRespVo <span class="hljs-title function_">register5</span><span class="hljs-params">(String username, String password, Integer age,</span><br><span class="hljs-params">                            String[] hobbies, Integer[] ids,</span><br><span class="hljs-params">                            <span class="hljs-meta">@DateTimeFormat(pattern = &quot;yyyy-MM-dd&quot;)</span> Date birthday)</span> &#123;<br>    <span class="hljs-keyword">return</span> BaseRespVo.ok();<br>&#125;<br><br><span class="hljs-meta">@RequestMapping(&quot;file&quot;)</span><br><span class="hljs-keyword">public</span> BaseRespVo <span class="hljs-title function_">uploadFile</span><span class="hljs-params">(MultipartFile file)</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>    <span class="hljs-comment">// è·å¾—ä¸Šä¼ çš„æ–‡ä»¶çš„ä¿¡æ¯</span><br>    <span class="hljs-type">String</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span> file.getName(); <span class="hljs-comment">// è¯·æ±‚å‚æ•°å â†’ file</span><br>    <span class="hljs-type">String</span> <span class="hljs-variable">originalFilename</span> <span class="hljs-operator">=</span> file.getOriginalFilename(); <span class="hljs-comment">//åŸå§‹æ–‡ä»¶å</span><br>    <span class="hljs-type">long</span> <span class="hljs-variable">size</span> <span class="hljs-operator">=</span> file.getSize(); <span class="hljs-comment">// æ–‡ä»¶çš„å¤§å°</span><br>    <span class="hljs-type">String</span> <span class="hljs-variable">contentType</span> <span class="hljs-operator">=</span> file.getContentType(); <span class="hljs-comment">// æ­£æ–‡ç±»å‹ â†’ æ–‡ä»¶ç±»å‹</span><br>    <span class="hljs-comment">// MultipartFile.transferTo</span><br>    <span class="hljs-type">File</span> <span class="hljs-variable">saveFile</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(<span class="hljs-string">&quot;D:\\WorkSpace\\j40_workspace&quot;</span>, originalFilename);<br>    <span class="hljs-comment">//File saveFile = new File(&quot;D:\\WorkSpace\\j40_workspace\\dlrb.jpg&quot;);</span><br>    file.transferTo(saveFile);<br>    <span class="hljs-keyword">return</span> BaseRespVo.ok();<br>&#125;<br></code></pre></td></tr></table></figure>

<p>é™¤äº†å½¢å‚ï¼Œè¿˜å¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰çš„å¼•ç”¨ç±»å‹å¯¹è±¡ï¼Œå¦‚æœä½¿ç”¨å¼•ç”¨ç±»å‹çš„å¯¹è±¡æ—¶ï¼ŒServletä¼šå»åˆ›å»ºä¸€ä¸ªæ–°çš„å®ä¾‹ã€‚çœ‹ä½ è¿™ä¸ªç±»ä¸­æœ‰å“ªäº›æˆå‘˜å˜é‡ï¼Œå¦‚æœæˆå‘˜å˜é‡åå’Œè¯·æ±‚å‚æ•°åç›¸åŒï¼Œå°±ä¼šä½¿ç”¨æˆå‘˜å˜é‡æ¥æ¥æ”¶è¯·æ±‚å‚æ•°ï¼Œä½¿ç”¨setæ–¹æ³•æ¥è¿›è¡Œå°è£…ã€‚æ‰€ä»¥è¦æ±‚è¯·æ±‚å‚æ•°åä¸å¼•ç”¨ç±»ä¸­çš„æˆå‘˜å˜é‡åä¸€è‡´ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span> &#123;<br>    String username;<br>   String password;<br>   Integer age;<br>    String[] hobbies;<br>   Integer[] ids;<br>    <span class="hljs-meta">@DateTimeFormat(pattern = &quot;yyyy-MM-dd&quot;)</span><br>    Date birthday;<br>&#125;<br></code></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RequestMapping(&quot;register6&quot;)</span><br><span class="hljs-keyword">public</span> BaseRespVo <span class="hljs-title function_">register6</span><span class="hljs-params">(User user)</span> &#123;<br>	<span class="hljs-keyword">return</span> BaseRespVo.ok();<br>&#125;<br></code></pre></td></tr></table></figure>

<p>å¦‚æœæ˜¯postè¯·æ±‚ï¼Œé‚£ä¹ˆå‘é€çš„è¯·æ±‚å‚æ•°ä¸€èˆ¬æ˜¯jsonï¼Œéœ€è¦å¯¹jsonè½¬æ¢æˆå¯¹åº”çš„å®ä¾‹ã€‚æ­¤æ—¶éœ€è¦å¢åŠ @RequestBodyæ³¨è§£æ¥ä¿®é¥°jsonå¯¹åº”çš„beanç±»ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RequestMapping(&quot;user/login&quot;)</span><br><span class="hljs-keyword">public</span> BaseRespVo <span class="hljs-title function_">login</span><span class="hljs-params">(<span class="hljs-meta">@RequestBody</span> JsonUser user)</span> &#123;<br>    <span class="hljs-keyword">return</span> BaseRespVo.ok(user);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>å¦‚æœéœ€è¦è·å¾—Cookieï¼Œåˆ™ä¸èƒ½ç›´æ¥è·å¾—ï¼Œéœ€è¦é€šè¿‡Requestè·å¾—ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// æŠŠæ‰€æœ‰Cookieéƒ½éå†æ‰“å°ä¸€ä¸‹</span><br><span class="hljs-meta">@RequestMapping(&quot;cookies&quot;)</span><br><span class="hljs-keyword">public</span> BaseRespVo <span class="hljs-title function_">cookies</span><span class="hljs-params">(HttpServletRequest request)</span> &#123;<br>    Cookie[] cookies = request.getCookies();<br>    <span class="hljs-keyword">for</span> (Cookie cookie : cookies) &#123;<br>        System.out.println(cookie.getName() + <span class="hljs-string">&quot; --&gt; &quot;</span> + cookie.getValue());<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> BaseRespVo.ok();<br>&#125;<br></code></pre></td></tr></table></figure>

<p>è€Œsessionå¯ä»¥ç›´æ¥è·å¾—ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RequestMapping(&quot;session2&quot;)</span><br><span class="hljs-keyword">public</span> BaseRespVo <span class="hljs-title function_">session2</span><span class="hljs-params">(HttpSession session)</span> &#123;<br>    <span class="hljs-type">Object</span> <span class="hljs-variable">username</span> <span class="hljs-operator">=</span> session.getAttribute(<span class="hljs-string">&quot;username&quot;</span>);<br>    <span class="hljs-keyword">return</span> BaseRespVo.ok(username);<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="PathVariable"><a href="#PathVariable" class="headerlink" title="@PathVariable"></a>@PathVariable</h3><p>è·å–è¯·æ±‚urlä¸­æŒ‡å®šå ä½ç¬¦çš„å€¼ï¼Œå¹¶å°†å€¼èµ‹ç»™å¯¹åº”çš„å½¢å‚ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RequestMapping(&quot;note/&#123;id&#125;&quot;)</span><br><span class="hljs-keyword">public</span> BaseRespVo <span class="hljs-title function_">note</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable(&quot;id&quot;)</span> Integer id)</span> &#123;<br>    <span class="hljs-keyword">return</span> BaseRespVo.ok();<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="Converter"><a href="#Converter" class="headerlink" title="Converter"></a>Converter</h3><p>Converterï¼Œç±»å‹è½¬æ¢å™¨ï¼Œä½¿ç”¨ä¸»è¦æ˜¯åœ¨è¯·æ±‚å‚æ•°å°è£…çš„è¿‡ç¨‹ä¸­ï¼Œä¹Ÿå°±æ˜¯Handleræ–¹æ³•çš„å½¢å‚ã€‚åœ¨å½¢å‚å¹¶ä¸æ˜¯Stringçš„æƒ…å†µä¸‹ä¼šç”¨åˆ°Converterã€‚</p>
<p>ä¸€èˆ¬æƒ…å†µä¸‹éœ€è¦è‡ªå·±å®šä¹‰Converterã€‚å¦‚ä»Stringè½¬ä¸ºUserã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">String2UserConverter</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Converter</span>&lt;String, User&gt; &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> User <span class="hljs-title function_">convert</span><span class="hljs-params">(String s)</span> &#123;<br>        <span class="hljs-comment">// é‡Œé¢çš„è½¬æ¢ä¸šåŠ¡éœ€è¦ä½ è‡ªå·±å®šä¹‰</span><br>        <span class="hljs-type">User</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>();<br>        user.setUsername(s);<br>        user.setPassword(s);<br>        <span class="hljs-keyword">return</span> user;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// æä¾›è‡ªå®šä¹‰çš„è½¬æ¢å™¨</span><br><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addFormatters</span><span class="hljs-params">(FormatterRegistry registry)</span> &#123;<br>    registry.addConverter(<span class="hljs-keyword">new</span> <span class="hljs-title class_">String2UserConverter</span>());<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="ResourceHandler"><a href="#ResourceHandler" class="headerlink" title="ResourceHandler"></a>ResourceHandler</h3><p>å› ä¸ºåœ¨SpringMVCä¸­ï¼ŒDispatcherServletçš„æ˜ å°„èŒƒå›´æ˜¯&#x2F;ï¼Œå³é™¤äº†jspå¤–çš„æ‰€æœ‰è¯·æ±‚ï¼Œä¹‹å‰JavaEEçš„è®¿é—®é™æ€èµ„æºçš„æ–¹å¼å°±æ— æ³•ä½¿ç”¨äº†ï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨ResourceHandleræ¥è¿›è¡Œé™æ€èµ„æºæ˜ å°„ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addResourceHandlers</span><span class="hljs-params">(ResourceHandlerRegistry registry)</span> &#123;<br>   registry.addResourceHandler(<span class="hljs-string">&quot;/pic/**&quot;</span>).addResourceLocations(<span class="hljs-string">&quot;classpath:/&quot;</span>);<br>   registry.addResourceHandler(<span class="hljs-string">&quot;/jpg/**&quot;</span>).addResourceLocations(<span class="hljs-string">&quot;/&quot;</span>);<br>	registry.addResourceHandler(<span class="hljs-string">&quot;/png/**&quot;</span>).addResourceLocations(<span class="hljs-string">&quot;file:D:\\spring/&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="HandlerInterceptor"><a href="#HandlerInterceptor" class="headerlink" title="HandlerInterceptor"></a>HandlerInterceptor</h3><p>åœ¨Handlerå‰æ‰§è¡Œï¼Œèµ·åˆ°äº†æ‹¦æˆªçš„åŠŸèƒ½ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">HandlerInterceptor</span> &#123;<br>    <span class="hljs-comment">// åœ¨Handleræ–¹æ³•æ‰§è¡Œä¹‹å‰</span><br>    <span class="hljs-comment">// è¿”å›å€¼ä¸ºbooleanï¼Œå¦‚æœä¸ºtrueåˆ™ç»§ç»­æµç¨‹ï¼Œå¦‚æœfalseï¼Œåˆ™ä¸­æ–­æµç¨‹</span><br>    <span class="hljs-keyword">default</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">preHandle</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    &#125;<br>	<span class="hljs-comment">// åœ¨Handleræ–¹æ³•æ‰§è¡Œä¹‹å</span><br>    <span class="hljs-keyword">default</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">postHandle</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Object handler, <span class="hljs-meta">@Nullable</span> ModelAndView modelAndView)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>    &#125;<br>	<span class="hljs-comment">// åœ¨æ•´ä¸ªæµç¨‹å®Œæˆä¹‹å</span><br>    <span class="hljs-keyword">default</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">afterCompletion</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Object handler, <span class="hljs-meta">@Nullable</span> Exception ex)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="å¼‚å¸¸å¤„ç†"><a href="#å¼‚å¸¸å¤„ç†" class="headerlink" title="å¼‚å¸¸å¤„ç†"></a>å¼‚å¸¸å¤„ç†</h3><p>æœ‰ä¸¤ç§å¼‚å¸¸å¤„ç†æ–¹å¼ï¼šç»Ÿä¸€çš„å…¨å±€å¼‚å¸¸å¤„ç† HandlerExceptionResolverå’Œè‡ªå®šä¹‰å¼‚å¸¸å¤„ç† ExceptionHandlerã€‚</p>
<p>HandlerExceptionResolveræ˜¯ä¸€ä¸ªæ¥å£ï¼Œæ¥å£é‡Œæä¾›äº†resolveExceptionæ–¹æ³•ï¼Œé‡å†™è¯¥æ–¹æ³•æ¥å¤„ç†å…¨å±€å¼‚å¸¸ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CustomHandlerExceptionResolver</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">HandlerExceptionResolver</span> &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> ModelAndView <span class="hljs-title function_">resolveException</span><span class="hljs-params">(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse, Object o, Exception e)</span> &#123;<br>        <span class="hljs-comment">// é€šè¿‡å®ƒä¹Ÿå¯ä»¥åšä¸ªæ€§åŒ–çš„å¼‚å¸¸å¤„ç†ï¼Œå¦‚æœè¦åšï¼Œéœ€è¦ä½ è‡ªå·±æ¥åšä¸ªæ€§åŒ–çš„ä¸œè¥¿</span><br>        <span class="hljs-keyword">if</span> (e <span class="hljs-keyword">instanceof</span> ArithmeticException) &#123;<br>            <span class="hljs-comment">//åšä¸ªæ€§åŒ–çš„å¼‚å¸¸å¤„ç†</span><br>            System.out.println(e.getMessage());<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ModelAndView</span>(<span class="hljs-string">&quot;/exception.jsp&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>ExceptionHandleræ˜¯ä¸€ä¸ªæ³¨è§£ï¼Œvalueæ˜¯å¯¹åº”çš„å¼‚å¸¸ï¼Œæ—¨åœ¨ç”¨å¯¹åº”çš„æ–¹æ³•å¤„ç†å¯¹åº”çš„å¼‚å¸¸ã€‚ä¸€èˆ¬æ”¾åœ¨ontrollerAdviceç»„ä»¶ä¸­çš„æ–¹æ³•ä¸Šã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@ControllerAdvice</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CustomExceptionControllerAdvice</span> &#123;<br><br>    <span class="hljs-comment">// åœ¨å½¢å‚ä¸­å¯ä»¥ç›´æ¥æ¥æ”¶ä½ æŠ›å‡ºçš„å¼‚å¸¸ï¼Œä½ æ˜ å°„çš„æ˜¯ä»€ä¹ˆå¼‚å¸¸ï¼Œå°±å¯ä»¥ä»¥ä»€ä¹ˆç±»å‹çš„å½¢å‚æ¥æ¥æ”¶</span><br>    <span class="hljs-meta">@ExceptionHandler(ArithmeticException.class)</span><br>    <span class="hljs-meta">@ResponseBody</span><br>    <span class="hljs-keyword">public</span> BaseRespVo <span class="hljs-title function_">method1</span><span class="hljs-params">(ArithmeticException exception)</span> &#123;<br>        <span class="hljs-keyword">return</span> BaseRespVo.fail(exception.getMessage());<br>    &#125;<br>    <br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="SpringBoot"><a href="#SpringBoot" class="headerlink" title="SpringBoot"></a>SpringBoot</h2><p>SpringBootæœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªSpringæ¡†æ¶ï¼Œä½†æ˜¯å®ƒç®€åŒ–äº†Springçš„é…ç½®ã€‚åœ¨æ²¡æœ‰ç»™å…·ä½“é…ç½®å‰ï¼ŒSpringBootä¼šä½¿ç”¨é»˜è®¤çš„é…ç½®ï¼Œåªæœ‰ç»™åˆ°å…·ä½“çš„é…ç½®ï¼Œæ‰é‡‡ç”¨å…·ä½“çš„é…ç½®ã€‚</p>
<p>å¯åŠ¨ç±»ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// è¯¥æ³¨è§£å°±æ˜¯SpringBootåº”ç”¨å¯åŠ¨ç±»ä¸Šçš„æ³¨è§£ â†’ ä¼šé…ç½®æ‰«æåŒ…ç›®å½•å°±æ˜¯è¯¥ç±»æ‰€å¤„çš„åŒ…ç›®å½•</span><br><span class="hljs-meta">@SpringBootApplication</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Demo1FirstSbApplication</span> &#123;<br>    <span class="hljs-comment">// å¯åŠ¨ç±»ä¸­ä¸€å®šä¼šåŒ…å«mainæ–¹æ³• â†’ å°±æ˜¯å¯åŠ¨SpringBootåº”ç”¨ç¨‹åºçš„å…¥å£</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        SpringApplication.run(Demo1FirstSbApplication.class, args);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>

<p>SpringBootå¯¹webçš„æ”¯æŒï¼š</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-comment"># tomcaté…ç½®</span><br><span class="hljs-attr">server:</span><br>  <span class="hljs-attr">port:</span> <span class="hljs-number">8083</span>  <span class="hljs-comment">#Tomcatçš„ç«¯å£å·é…ç½®</span><br>  <span class="hljs-attr">servlet:</span><br>    <span class="hljs-attr">context-path:</span> <span class="hljs-string">/demo1</span>   <span class="hljs-comment"># åº”ç”¨ç¨‹åºçš„ä¸Šä¸‹æ–‡é…ç½®ï¼ˆåº”ç”¨åï¼‰</span><br>    <br><span class="hljs-comment"># é™æ€èµ„æºæ˜ å°„</span><br><span class="hljs-attr">spring:</span><br>  <span class="hljs-attr">mvc:</span><br>    <span class="hljs-attr">static-path-pattern:</span> <span class="hljs-string">/pic/**</span><br><span class="hljs-comment">#  spring.resources  æˆ–  spring.web.resources</span><br>  <span class="hljs-attr">resources:</span><br>    <span class="hljs-attr">static-locations:</span> <span class="hljs-string">file:d:/spring/</span><br>    <br><span class="hljs-comment"># Converter</span><br><span class="hljs-comment"># Filter</span><br></code></pre></td></tr></table></figure>

<p>SpringBootå¯¹Mybatisçš„æ”¯æŒï¼š</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">spring:</span><br>  <span class="hljs-attr">datasource:</span><br>    <span class="hljs-attr">driver-class-name:</span> <span class="hljs-string">com.mysql.jdbc.Driver</span><br>    <span class="hljs-attr">url:</span> <span class="hljs-string">jdbc:mysql://localhost:3306/cskaoyan_db?useUnicode=true&amp;characterEncoding=utf-8</span><br>    <span class="hljs-attr">username:</span> <span class="hljs-string">root</span><br>    <span class="hljs-attr">password:</span> <span class="hljs-number">123456</span><br></code></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@SpringBootApplication</span><br><span class="hljs-comment">// éœ€è¦æ·»åŠ @MapperScanæ¥æ‰«æmapper</span><br><span class="hljs-meta">@MapperScan(&quot;com.cskaoyan.mapper&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Demo1FirstSbApplication</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        SpringApplication.run(Demo1FirstSbApplication.class, args);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="é€†å‘å·¥ç¨‹"><a href="#é€†å‘å·¥ç¨‹" class="headerlink" title="é€†å‘å·¥ç¨‹"></a>é€†å‘å·¥ç¨‹</h2><p>é€†å‘å·¥ç¨‹å¯ä»¥æ ¹æ®æ•°æ®åº“ä¸­çš„è¡¨è‡ªåŠ¨ç”Ÿæˆæ¥å£ã€æ–¹æ³•ã€æ˜ å°„æ–‡ä»¶ï¼Œåªéœ€è¦æ“ä½œå¯¹åº”çš„Exampleç±»å°±å¯ä»¥æ“ä½œæ•°æ®åº“ã€‚</p>
<p>æ¥å£æ–¹æ³•ç¤ºä¾‹ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//å‡åºè¿˜æ˜¯é™åº:å­—æ®µ+ç©ºæ ¼+asc(desc)</span><br><span class="hljs-keyword">protected</span> String orderByClause;<br><span class="hljs-comment">//å»é™¤é‡å¤:trueæ˜¯é€‰æ‹©ä¸é‡å¤è®°å½•,false,åä¹‹</span><br><span class="hljs-keyword">protected</span> <span class="hljs-type">boolean</span> distinct;<br><span class="hljs-comment">//è‡ªå®šä¹‰æŸ¥è¯¢æ¡ä»¶</span><br><span class="hljs-keyword">protected</span> List&lt;Criteria&gt; oredCriteria;<br></code></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testFindUserByName</span><span class="hljs-params">()</span>&#123;<br><br>    <span class="hljs-comment">//é€šè¿‡criteriaæ„é€ æŸ¥è¯¢æ¡ä»¶</span><br>    <span class="hljs-type">UserExample</span> <span class="hljs-variable">userExample</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UserExample</span>();<br>    userExample.setOrderByClause(<span class="hljs-string">&quot;username asc&quot;</span>); <span class="hljs-comment">//ascå‡åº,descé™åºæ’åˆ—</span><br>    userExample.setDistinct(<span class="hljs-literal">false</span>); <span class="hljs-comment">//å»é™¤é‡å¤,trueæ˜¯é€‰æ‹©ä¸é‡å¤è®°å½•,falseåä¹‹</span><br>    UserExample.<span class="hljs-type">Criteria</span> <span class="hljs-variable">criteria</span> <span class="hljs-operator">=</span> userExample.createCriteria(); <span class="hljs-comment">//æ„é€ è‡ªå®šä¹‰æŸ¥è¯¢æ¡ä»¶</span><br>    criteria.andUsernameEqualTo(<span class="hljs-string">&quot;å¼ ä¸‰&quot;</span>);<br><br>    <span class="hljs-comment">//è‡ªå®šä¹‰æŸ¥è¯¢æ¡ä»¶å¯èƒ½è¿”å›å¤šæ¡è®°å½•,ä½¿ç”¨Listæ¥æ”¶</span><br>    List&lt;User&gt; users = userMapper.selectByExample(userExample);<br><br>    System.out.println(users);<br>&#125; <br></code></pre></td></tr></table></figure>

<p>é€†å‘å·¥ç¨‹ç”Ÿæˆçš„å†…å®¹ä¼šæœ‰ä¸€å®šé—®é¢˜ï¼Œå¦‚æœè¡¨ä¸­çš„å­—æ®µå­˜åœ¨sqlè¯­å¥ä¸­çš„å…³é”®å­—ï¼Œéœ€è¦è‡ªå·±æ‰‹åŠ¨åœ¨mapper.xmlæ–‡ä»¶ä¸­æ·»åŠ è½¬ä¹‰å­—ç¬¦ã€‚</p>
<h2 id="TypeHandler"><a href="#TypeHandler" class="headerlink" title="TypeHandler"></a>TypeHandler</h2><p>TypeHandleræ˜¯Mybatisè¾“å…¥è¾“å‡ºæ˜ å°„è¿‡ç¨‹ä¸­çš„ç±»å‹å¤„ç†å™¨ï¼Œç”¨äºå¤„ç†jdbcTypeå’ŒJavaTypeé—´çš„è½¬æ¢ã€‚</p>
<p>ä¸»è¦æ–¹å¼æ˜¯å®ç°<code>TypeHandler</code>æ¥å£ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// ç±»å‹æ˜ å°„é…ç½®</span><br><span class="hljs-meta">@MappedTypes(Integer[].class)</span><br><span class="hljs-meta">@MappedJdbcTypes(JdbcType.VARCHAR)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">IntegerArrayTypeHandler</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">TypeHandler</span>&lt;Integer[]&gt; &#123;<br><br>    <span class="hljs-type">ObjectMapper</span> <span class="hljs-variable">objectMapper</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectMapper</span>();<br>    <br>    <span class="hljs-comment">// è¾“å…¥æ˜ å°„è¿‡ç¨‹</span><br>    <span class="hljs-comment">// insert into market_user (id,username,password,role_ids) values (?,?,?,?)</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setParameter</span><span class="hljs-params">(PreparedStatement preparedStatement, <span class="hljs-type">int</span> index, Integer[] integers, JdbcType jdbcType)</span> <span class="hljs-keyword">throws</span> SQLException &#123;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">value</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>        <span class="hljs-keyword">try</span> &#123;<br>            value = objectMapper.writeValueAsString(integers);<br>        &#125; <span class="hljs-keyword">catch</span> (JsonProcessingException e) &#123;<br>            e.printStackTrace();<br>        &#125;<br>        <span class="hljs-comment">// ä¸ºç¬¬å‡ ä¸ªå ä½ç¬¦æä¾›çš„å€¼æ˜¯ä»€ä¹ˆ</span><br>        preparedStatement.setString(index,value);<br>    &#125;<br><br>    <span class="hljs-comment">// è¾“å‡ºæ˜ å°„è¿‡ç¨‹</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> Integer[] getResult(ResultSet resultSet, String columName) <span class="hljs-keyword">throws</span> SQLException &#123;<br>        <span class="hljs-comment">// è·å¾—ç»“æœ</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> resultSet.getString(columName);<br>        <span class="hljs-keyword">return</span> transfer(result);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> Integer[] getResult(ResultSet resultSet, <span class="hljs-type">int</span> index) <span class="hljs-keyword">throws</span> SQLException &#123;<br>        <span class="hljs-comment">// è·å¾—ç»“æœ</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> resultSet.getString(index);<br>        <span class="hljs-keyword">return</span> transfer(result);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> Integer[] getResult(CallableStatement callableStatement, <span class="hljs-type">int</span> i) <span class="hljs-keyword">throws</span> SQLException &#123;<br>        <span class="hljs-comment">// è·å¾—ç»“æœ</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> callableStatement.getString(i);<br>        <span class="hljs-keyword">return</span> transfer(result);<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> Integer[] transfer(String result) &#123;<br>        Integer[] integers = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Integer</span>[<span class="hljs-number">0</span>];<br>        <span class="hljs-comment">// ä½¿ç”¨jacksonå°†å­—ç¬¦ä¸²è½¬æ¢Integer[]</span><br>        <span class="hljs-keyword">try</span> &#123;<br>            integers = objectMapper.readValue(result, Integer[].class);<br>        &#125; <span class="hljs-keyword">catch</span> (JsonProcessingException e) &#123;<br>            e.printStackTrace();<br>        &#125;<br>        <span class="hljs-keyword">return</span> integers;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>é…ç½®è‡ªå®šä¹‰çš„TypeHandler</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">mybatis:</span><br>  <span class="hljs-attr">type-handlers-package:</span> <span class="hljs-string">com.cskaoyan.typehandler</span><br></code></pre></td></tr></table></figure>

<h2 id="Shiroæ¡†æ¶"><a href="#Shiroæ¡†æ¶" class="headerlink" title="Shiroæ¡†æ¶"></a>Shiroæ¡†æ¶</h2><p>Shiroå®‰å…¨æ¡†æ¶ï¼ŒApache Shiroæ˜¯ä¸€ä¸ªå¼€æºå®‰å…¨æ¡†æ¶ï¼Œæä¾›èº«ä»½è®¤è¯ã€æˆæƒã€å¯†ç å­¦å’Œä¼šè¯ç®¡ç†ã€‚Shiroæ¡†æ¶ç›´è§‚ã€æ˜“ç”¨ï¼ŒåŒæ—¶ä¹Ÿèƒ½æä¾›å¥å£®çš„å®‰å…¨æ€§ã€‚</p>
<p>Shiroåœ¨SpringMVCåº”ç”¨ç¨‹åºä¸­ä»¥Filterçš„å½¢å¼å­˜åœ¨ã€‚</p>
<p>Shiroçš„ä¸€äº›æ ¸å¿ƒæœ¯è¯­å¦‚ä¸‹ã€‚</p>
<ul>
<li>Authenticationï¼Œè®¤è¯æ˜¯èº«ä»½éªŒè¯çš„è¿‡ç¨‹ -æ‚¨æ­£åœ¨å°è¯•è¯æ˜ç”¨æˆ·æ˜¯ä»–ä»¬æ‰€è¯´çš„äººã€‚ä¸ºæ­¤ï¼Œç”¨æˆ·éœ€è¦æä¾›ç³»ç»Ÿç†è§£å’Œä¿¡ä»»çš„æŸç§èº«ä»½è¯æ˜ã€‚è®¤è¯å…¶å®å°±æ˜¯æˆ‘ä»¬é€šå¸¸æ‰€è¯´çš„ç™»å½•ã€‚</li>
<li>Authorizationï¼Œæˆæƒæˆ–è®¿é—®æ§åˆ¶æ˜¯æŒ‡å®šå¯¹èµ„æºçš„è®¿é—®æƒé™çš„åŠŸèƒ½ã€‚æ¢å¥è¯è¯´ï¼Œè°å¯ä»¥è®¿é—®ä»€ä¹ˆã€‚æ¯”å¦‚æ˜¯å¦å…è®¸ç”¨æˆ·ç¼–è¾‘æ­¤æ•°æ®ï¼Œè¿™äº›éƒ½æ˜¯å†³å®šç”¨æˆ·æœ‰æƒè®¿é—®çš„å†…å®¹çš„å†³å®šã€‚æˆ‘ä»¬å½“å‰ä¸»è¦é’ˆå¯¹çš„æ˜¯URLçº§åˆ«çš„æƒé™è®¿é—®æ§åˆ¶ã€‚</li>
<li>Subjectï¼Œä¸»ä½“ï¼Œåœ¨Shiroä¸­æ‰€åšçš„å‡ ä¹æ‰€æœ‰æ“ä½œéƒ½åŸºäºå½“å‰æ­£åœ¨æ‰§è¡Œçš„ç”¨æˆ·ï¼Œä¹Ÿå°±æ˜¯åŸºæœ¬ä¸ŠShiroçš„æ“ä½œéƒ½æ˜¯ä½¿ç”¨Subjectæ“ä½œçš„ï¼ŒSubjectæŒ‡çš„å°±æ˜¯å½“å‰æ“ä½œçš„ç”¨æˆ·ã€‚åœ¨ä»£ç ä¸­çš„ä»»ä½•ä½ç½®éƒ½å¯ä»¥è½»æ¾è·å¾—Subjectï¼Œé€šè¿‡Subjectå¯ä»¥æ–¹ä¾¿çš„æ“ä½œShiroã€‚æ¯”å¦‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨Subjectæä¾›çš„æ–¹æ³•æ¥æ‰§è¡Œè®¤è¯ã€åˆ¤æ–­æ˜¯å¦è®¤è¯ç­‰æ“ä½œã€‚</li>
<li>Principalsï¼Œä¸»ä½“é‰´å®šåçš„å‚æ•°ï¼Œä¹Ÿå°±æ˜¯è®¤è¯åçš„ç”¨æˆ·ä¿¡æ¯ï¼Œå¯ä»¥æ˜¯å§“åã€ç”¨æˆ·idã€ç”¨æˆ·å¯¹è±¡ç­‰å½¢å¼ã€‚</li>
<li>Credentialsï¼Œç”¨æ¥éªŒè¯èº«ä»½çš„ç§˜å¯†æ•°æ®ï¼Œé€šå¸¸æŒ‡å¯†ç ï¼Œç”Ÿç‰©æ•°æ®æ¯”å¦‚æŒ‡çº¹ã€é¢éƒ¨ã€ç³å­”ç­‰ã€‚</li>
<li>Realmsï¼ŒåŸŸæˆ–é¢†åŸŸï¼Œå®‰å…¨çš„ç‰¹æ®Šæ•°æ®å­˜å‚¨å¯¹è±¡ï¼ˆDAOï¼‰ï¼ŒShiroä¸­çš„Realmä¸»è¦æ˜¯è®©ä½ èƒ½å¤Ÿè·å¾—å¯¹åº”çš„è®¤è¯ä¿¡æ¯å’Œæˆæƒä¿¡æ¯ã€‚</li>
<li>Tokenï¼Œä»¤ç‰Œï¼ŒShiroä¸­çš„Tokenæ˜¯ä½œä¸ºç™»å½•æ“ä½œçš„å‚æ•°ã€‚</li>
</ul>
<p>Shiroçš„æ ¸å¿ƒç»„ä»¶å¦‚ä¸‹ï¼š</p>
<ul>
<li>SecurityManagerï¼Œå®‰å…¨ç®¡ç†å™¨</li>
<li>Authenticatorï¼Œè®¤è¯å™¨</li>
<li>SessionManagerï¼Œä¼šè¯ç®¡ç†å™¨</li>
<li>Realmï¼ŒåŸŸ</li>
<li>CacheManagerï¼Œç¼“å­˜ç®¡ç†å™¨</li>
<li>Cryptographyï¼Œå¯†ç å­¦</li>
</ul>
<p>Shiroæä¾›çš„Filterç±»å‹å¦‚ä¸‹ã€‚</p>
<table>
<thead>
<tr>
<th>Filteråç§°</th>
<th>Filterç±»</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>anon</td>
<td>org.apache.shiro.web.filter.authc.AnonymousFilter</td>
<td>åŒ¿åFilterï¼Œä½œç”¨èŒƒå›´å†…çš„è¯·æ±‚ä¸éœ€è¦è®¤è¯å’Œæˆæƒ</td>
</tr>
<tr>
<td>authc</td>
<td>org.apache.shiro.web.filter.authc.FormAuthenticationFilter</td>
<td>è®¤è¯Filterï¼Œä½œç”¨èŒƒå›´å†…çš„è¯·æ±‚éœ€è¦å®Œæˆè®¤è¯</td>
</tr>
<tr>
<td>perms</td>
<td>org.apache.shiro.web.filter.authz.PermissionsAuthorizationFilter</td>
<td>æƒé™Filterï¼Œä½œç”¨èŒƒå›´å†…çš„è¯·æ±‚éœ€è¦å®Œæˆè®¤è¯å’Œæˆæƒ</td>
</tr>
</tbody></table>
<p>æˆ‘ä»¬å¯ä»¥è®¾ç½®ä¸åŒç±»å‹çš„Filteråˆ†åˆ«æ˜ å°„ä¸€äº›ä¸åŒçš„URLèŒƒå›´ï¼Œå½“è¯·æ±‚å‘é€åˆ°åº”ç”¨ç¨‹åºæ—¶ï¼Œæ ¹æ®è¯·æ±‚URLåˆ†åˆ«åˆ¤æ–­ä½¿ç”¨å“ªä¸€äº›Filterï¼Œåœ¨Filterä¸­å†³å®šæ˜¯å¦ç»§ç»­è®¿é—®æµç¨‹ã€‚åœ¨SpringBootä¸­ï¼Œä¸»è¦åœ¨é…ç½®æ–‡ä»¶ä¸­é…ç½®ã€‚</p>
<h3 id="Realm"><a href="#Realm" class="headerlink" title="Realm"></a>Realm</h3><p>Shiroä¸­çš„Realmä¸»è¦æ˜¯è®©ä½ èƒ½å¤Ÿè·å¾—å¯¹åº”çš„è®¤è¯ä¿¡æ¯å’Œæˆæƒä¿¡æ¯ã€‚</p>
<p>ä¸€èˆ¬é€šè¿‡è‡ªå®šä¹‰Realmæ¥ä½¿ç”¨ï¼Œéœ€è¦ç»§æ‰¿ä¸€ä¸ªæŠ½è±¡ç±»AuthorizingRealmï¼Œå¹¶å®ç°ä¸¤ä¸ªæŠ½è±¡æ–¹æ³•ï¼š</p>
<ul>
<li>doGetAuthenticationInfo ï¼šè·å¾—è®¤è¯ä¿¡æ¯ï¼Œå³æ ¹æ®tokenä¸­çš„ç”¨æˆ·åæŸ¥è¯¢è¯¥ç”¨æˆ·åœ¨ç³»ç»Ÿä¸­çš„Credentialsï¼Œå¹¶ä¸”æ„é€ AuthenInfoã€‚</li>
<li>doGetAuthorizationInfo ï¼šè·å¾—æˆæƒä¿¡æ¯ï¼Œå³æ ¹æ®Principalï¼ˆæ”¾å…¥AuthenInfoä¸­çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼‰æŸ¥è¯¢è¯¥ç”¨æˆ·åœ¨ç³»ç»Ÿä¸­çš„æƒé™ä¿¡æ¯ã€‚</li>
</ul>
<p>åœ¨è¿™ä¸¤ä¸ªæ–¹æ³•ä¸­å»å†™è·å¾—ç”¨æˆ·è®¤è¯ä¿¡æ¯å’Œæˆæƒä¿¡æ¯çš„ä¸šåŠ¡ä»£ç ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CustomRealm</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AuthorizingRealm</span> &#123;<br>    <span class="hljs-comment">//é€šå¸¸æŠŠdoGetAuthenticationInfoæ–¹æ³•æ”¾åœ¨ä¸Šé¢</span><br><br>    <span class="hljs-comment">//è¯¥æ–¹æ³•çš„å½¢å‚ â†’ æ¥æºäºsubjectçš„loginæ–¹æ³•</span><br>    <span class="hljs-comment">// ä¼ å…¥è¯¥å€¼ï¼Œä¸ºäº†æ ¹æ®ç”¨æˆ·åæŸ¥è¯¢åˆ°è¯¥ç”¨æˆ·åœ¨ç³»ç»Ÿä¸­çš„å¯†ç ï¼ˆæ•°æ®åº“ä¸­ç»´æŠ¤ï¼‰ â†’ æ¥æ„é€ è®¤è¯ä¿¡æ¯</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> AuthenticationInfo <span class="hljs-title function_">doGetAuthenticationInfo</span><span class="hljs-params">(AuthenticationToken authenticationToken)</span> <span class="hljs-keyword">throws</span> AuthenticationException &#123;<br>        <span class="hljs-type">UsernamePasswordToken</span> <span class="hljs-variable">token</span> <span class="hljs-operator">=</span> (UsernamePasswordToken) authenticationToken;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">username</span> <span class="hljs-operator">=</span> token.getUsername();<br><br>        <span class="hljs-comment">//æ ¹æ®usernameæŸ¥è¯¢æ•°æ®åº“ä¸­å¯¹åº”password</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">password</span> <span class="hljs-operator">=</span> selectPasswordByUsername(username);<br><br>        <span class="hljs-comment">// principalä¿¡æ¯ â†’ å½“å‰æ”¾çš„æ˜¯ä»€ä¹ˆä¿¡æ¯ï¼Œåç»­å–å‡ºçš„å°±æ˜¯ä»€ä¹ˆä¿¡æ¯</span><br>        <span class="hljs-comment">// å¯†ç    â†’ è¯¥å¯†ç ä¼šå’ŒTokenä¸­çš„passwordåšæ¯”è¾ƒ</span><br>        <span class="hljs-comment">// realmåç§° â†’ æ²¡å•¥ç”¨</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SimpleAuthenticationInfo</span>(username,password,getName());<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> AuthorizationInfo <span class="hljs-title function_">doGetAuthorizationInfo</span><span class="hljs-params">(PrincipalCollection principalCollection)</span> &#123;<br>        <span class="hljs-comment">// æ ¹æ®ç”¨æˆ·ä¿¡æ¯æ‹¿åˆ°æ‰€æœ‰çš„æƒé™ï¼ˆæ•°æ®åº“ï¼‰</span><br>        <span class="hljs-comment">// doGetAuthenticationInfoæ–¹æ³•è¿”å›å€¼çš„ç¬¬ä¸€ä¸ªå‚æ•°å°±æ˜¯ç”¨æˆ·ä¿¡æ¯</span><br>        <span class="hljs-comment">// åœ¨ç¬¬21è¡Œä»£ç æ”¾å…¥çš„æ˜¯å­—ç¬¦ä¸²ç±»å‹çš„Principalä¿¡æ¯ï¼Œå–å‡ºçš„æ—¶å€™å°±å¯ä»¥ä»¥å­—ç¬¦ä¸²æ ¼å¼å–å‡º</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">primaryPrincipal</span> <span class="hljs-operator">=</span> (String) principalCollection.getPrimaryPrincipal();<br>        List&lt;String&gt; permissions = getPermissionsByUsername(primaryPrincipal);<br><br>        <span class="hljs-type">SimpleAuthorizationInfo</span> <span class="hljs-variable">simpleAuthorizationInfo</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SimpleAuthorizationInfo</span>();<br>        simpleAuthorizationInfo.addStringPermissions(permissions);<br>        <span class="hljs-keyword">return</span> simpleAuthorizationInfo;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> String <span class="hljs-title function_">selectPasswordByUsername</span><span class="hljs-params">(String username)</span> &#123;<br>        <span class="hljs-comment">// åº”è¯¥é€šè¿‡MyBatisæ ¹æ®ç”¨æˆ·åæŸ¥è¯¢è·å¾—ç»“æœ</span><br><br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;123456&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> List&lt;String&gt; <span class="hljs-title function_">getPermissionsByUsername</span><span class="hljs-params">(String username)</span> &#123;<br>        <span class="hljs-comment">// åº”è¯¥é€šè¿‡MyBatisæ ¹æ®ç”¨æˆ·åæŸ¥è¯¢è·å¾—ç»“æœ</span><br>        <span class="hljs-keyword">return</span> Arrays.asList(<span class="hljs-string">&quot;admin:user:list&quot;</span>, <span class="hljs-string">&quot;admin:admin:list&quot;</span>);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="è®¤è¯"><a href="#è®¤è¯" class="headerlink" title="è®¤è¯"></a>è®¤è¯</h3><p>åœ¨å¯¹åº”è¯·æ±‚ä¸­è·å¾—subjectï¼Œå¹¶æ‰§è¡Œsubjectçš„loginæ–¹æ³•ã€‚</p>
<ul>
<li>å› ä¸ºç™»å½•è¯·æ±‚ä¸éœ€è¦æƒé™ï¼Œéœ€è¦å°†å…¶æƒé™è®¾ä¸ºanon</li>
<li>subjectå¯¹è±¡å¯ä»¥åœ¨æ‰€æœ‰ç»„ä»¶ä¸­è·å¾—ï¼Œæ–¹å¼ä¸º<code>Subject subject = SecurityUtils.getSubject()</code></li>
<li>åœ¨ç»å¤§å¤šæ•°åœºæ™¯ä¸‹ï¼Œloginæ–¹æ³•çš„å‚æ•°éƒ½ä¸ºAuthenticationTokenæ¥å£ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨å…¶å®ç°ç±»UsernamePasswordTokenï¼š<code> subject.login(new UsernamePasswordToken(username,password))</code></li>
<li>å¦‚æœéœ€è¦è·å¾—sessionIdï¼Œå¯ä»¥ä½¿ç”¨subjectè·å¾—ï¼š<code> subject.getSession().getId()</code></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@PostMapping(&quot;login&quot;)</span><br><span class="hljs-keyword">public</span> BaseRespVo&lt;LoginUserData&gt; <span class="hljs-title function_">login</span><span class="hljs-params">(<span class="hljs-meta">@RequestBody</span> Map map)</span> &#123;<br>    <span class="hljs-type">String</span> <span class="hljs-variable">username</span> <span class="hljs-operator">=</span> (String)map.get(<span class="hljs-string">&quot;username&quot;</span>);<br>    <span class="hljs-type">String</span> <span class="hljs-variable">password</span> <span class="hljs-operator">=</span> (String)map.get(<span class="hljs-string">&quot;password&quot;</span>);<br><br>    <span class="hljs-comment">// æ•´åˆShiro</span><br>    <span class="hljs-comment">// è·å¾—æ“ä½œçš„ä¸»ä½“</span><br>    <span class="hljs-type">Subject</span> <span class="hljs-variable">subject</span> <span class="hljs-operator">=</span> SecurityUtils.getSubject();<br>    <span class="hljs-comment">// loginæ–¹æ³•ä¼ å…¥çš„å‚æ•°AuthenticationToken â†’ è®¤è¯çš„ä»¤ç‰Œ</span><br>    <span class="hljs-comment">// subjectæ‰§è¡Œlogin â†’ è®¤è¯å™¨æ‰§è¡Œè®¤è¯æ–¹æ³• â†’ realm.doGetAuthenticationInfo</span><br>    <span class="hljs-comment">// AuthenticationToken â†’ UsernamePasswordToken â†’ ç›´æ¥å°è£…äº†usernameå’Œpassword</span><br>    <span class="hljs-comment">// usernameå’Œpasswordé€šè¿‡Handleræ–¹æ³•çš„å½¢å‚ä¼ å…¥</span><br>    subject.login(<span class="hljs-keyword">new</span> <span class="hljs-title class_">UsernamePasswordToken</span>(username,password));<br><br>    <span class="hljs-keyword">if</span> (subject.isAuthenticated()) &#123;<br>        System.out.println(<span class="hljs-string">&quot;è®¤è¯æˆåŠŸ&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-type">LoginUserData</span> <span class="hljs-variable">loginUserData</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">LoginUserData</span>();<br>    <span class="hljs-type">AdminInfoBean</span> <span class="hljs-variable">adminInfo</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AdminInfoBean</span>();<br>    adminInfo.setAvatar(<span class="hljs-string">&quot;https://wpimg.wallstcn.com/f778738c-e4f8-4870-b634-56703b4acafe.gif&quot;</span>);<br>    adminInfo.setNickName(<span class="hljs-string">&quot;admin123&quot;</span>);<br>    loginUserData.setAdminInfo(adminInfo);<br>    <span class="hljs-comment">// æºå¸¦SessionIdä¿¡æ¯</span><br>    loginUserData.setToken((String) subject.getSession().getId());<br>    <span class="hljs-keyword">return</span> BaseRespVo.ok(loginUserData);<br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>è®¤è¯åå¯ä»¥é€šè¿‡<code>subject.getPrincipals().getPrimaryPrincipal()</code>æ¥è·å–ç”¨æˆ·åœ¨æ•°æ®åº“ä¸­çš„å…¶ä»–ä¿¡æ¯ã€‚è¯¥æ–¹æ³•çš„è¿”å›å€¼ä¸ºObjectï¼Œå¯ä»¥ç›´æ¥è½¬æ¢ä¸ºå¯¹åº”çš„ç”¨æˆ·ä¿¡æ¯POç±»ã€‚</li>
<li>å¯ä»¥é€šè¿‡<code>subject.logout()</code>ç™»å‡ºç”¨æˆ·ã€‚</li>
</ul>
<h2 id="HibernateValidation"><a href="#HibernateValidation" class="headerlink" title="HibernateValidation"></a>HibernateValidation</h2><p>åœ¨éœ€è¦å¯¹ä¸€äº›å‚æ•°è¿›è¡Œæ ¡éªŒæ—¶ï¼Œå¯ä»¥åœ¨Handleræ–¹æ³•çš„å½¢å‚ä¸Šå¢åŠ æ³¨è§£@Validæˆ–@Validatedï¼Œæˆ–åœ¨å¼•ç”¨ç±»å‹ä¸­çš„æˆå‘˜å˜é‡ä¸Šå¢åŠ æ ¡éªŒåŠŸèƒ½çš„æ³¨è§£ã€‚</p>
<p>å¸¸è§æ³¨è§£å¦‚ä¸‹ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java">å¸¸è§çš„æ³¨è§£ ï¼ˆBean Validation ä¸­å†…ç½®çš„ constraintï¼‰     <br><span class="hljs-meta">@Null</span>   è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»ä¸º <span class="hljs-literal">null</span>     <br><span class="hljs-meta">@NotNull</span>    è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»ä¸ä¸º <span class="hljs-literal">null</span>     <br><span class="hljs-meta">@Size(max=, min=)</span>   è¢«æ³¨é‡Šçš„å…ƒç´ çš„å¤§å°å¿…é¡»åœ¨æŒ‡å®šçš„èŒƒå›´å†…     <br><span class="hljs-meta">@AssertTrue</span>     è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»ä¸º <span class="hljs-literal">true</span>     <br><span class="hljs-meta">@AssertFalse</span>    è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»ä¸º <span class="hljs-literal">false</span>     <br><span class="hljs-meta">@Min(value)</span>     è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œå…¶å€¼å¿…é¡»å¤§äºç­‰äºæŒ‡å®šçš„æœ€å°å€¼     <br><span class="hljs-meta">@Max(value)</span>     è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œå…¶å€¼å¿…é¡»å°äºç­‰äºæŒ‡å®šçš„æœ€å¤§å€¼     <br><span class="hljs-meta">@DecimalMin(value)</span>  è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œå…¶å€¼å¿…é¡»å¤§äºç­‰äºæŒ‡å®šçš„æœ€å°å€¼     <br><span class="hljs-meta">@DecimalMax(value)</span>  è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œå…¶å€¼å¿…é¡»å°äºç­‰äºæŒ‡å®šçš„æœ€å¤§å€¼     <br><span class="hljs-meta">@Digits</span> (integer, fraction)     è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œå…¶å€¼å¿…é¡»åœ¨å¯æ¥å—çš„èŒƒå›´å†…     <br><span class="hljs-meta">@Past</span>   è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»æ˜¯ä¸€ä¸ªè¿‡å»çš„æ—¥æœŸ Date    <br><span class="hljs-meta">@Future</span>     è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»æ˜¯ä¸€ä¸ªå°†æ¥çš„æ—¥æœŸ     <br><span class="hljs-meta">@Pattern(regex=,flag=)</span>  è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»ç¬¦åˆæŒ‡å®šçš„æ­£åˆ™è¡¨è¾¾å¼     <br>Hibernate Validator é™„åŠ çš„ constraint     <br><span class="hljs-meta">@NotBlank(message =)</span>   éªŒè¯å­—ç¬¦ä¸²é<span class="hljs-literal">null</span>ï¼Œä¸”é•¿åº¦å¿…é¡»å¤§äº<span class="hljs-number">0</span>     <br><span class="hljs-meta">@Email</span>  è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»æ˜¯ç”µå­é‚®ç®±åœ°å€     <br><span class="hljs-meta">@Length(min=,max=)</span>  è¢«æ³¨é‡Šçš„å­—ç¬¦ä¸²çš„å¤§å°å¿…é¡»åœ¨æŒ‡å®šçš„èŒƒå›´å†…     <br><span class="hljs-meta">@NotEmpty</span>   è¢«æ³¨é‡Šçš„å­—ç¬¦ä¸²çš„å¿…é¡»éç©º     <br><span class="hljs-meta">@Range(min=,max=,message=)</span>  è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»åœ¨åˆé€‚çš„èŒƒå›´å†…<br></code></pre></td></tr></table></figure>


  </article>

  
      
    <div class="nexmoe-post-copyright">
        <strong>æœ¬æ–‡ä½œè€…ï¼š</strong>Ykuri98<br>
        <strong>æœ¬æ–‡é“¾æ¥ï¼š</strong><a href="https://ykuri98.github.io/2022/07/04/%E5%AD%A6%E4%B9%A0%E6%80%BB%E7%BB%93%EF%BC%882022-06-15-2022-06-24%EF%BC%89/" title="https:&#x2F;&#x2F;ykuri98.github.io&#x2F;2022&#x2F;07&#x2F;04&#x2F;%E5%AD%A6%E4%B9%A0%E6%80%BB%E7%BB%93%EF%BC%882022-06-15-2022-06-24%EF%BC%89&#x2F;" target="_blank" rel="noopener">https:&#x2F;&#x2F;ykuri98.github.io&#x2F;2022&#x2F;07&#x2F;04&#x2F;%E5%AD%A6%E4%B9%A0%E6%80%BB%E7%BB%93%EF%BC%882022-06-15-2022-06-24%EF%BC%89&#x2F;</a><br>
        
            <strong>ç‰ˆæƒå£°æ˜ï¼š</strong>æœ¬æ–‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/cn/deed.zh" target="_blank">CC BY-NC-SA 3.0 CN</a> åè®®è¿›è¡Œè®¸å¯
        
    </div>


  
  
  <div class="nexmoe-post-meta nexmoe-rainbow">
    
        <a class="nexmoefont icon-appstore-fill -link" href="/categories/%E6%8A%80%E6%9C%AF/">æŠ€æœ¯</a>
    
    
        <a class="nexmoefont icon-tag-fill -none-link" href="/tags/JavaEE/" rel="tag">JavaEE</a> <a class="nexmoefont icon-tag-fill -none-link" href="/tags/Spring/" rel="tag">Spring</a>
    
</div>

  
      <div class="nexmoe-post-footer">
          <section class="nexmoe-comment">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.css">
<div id="gitalk"></div>
<script src="https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js"></script>
<script type="text/javascript">
    var gitalk = new Gitalk({
        clientID: 'ff024b5293a92e4461fd',
        clientSecret: 'c749602a0b62efd70c6ec86e7c4f0f62a5a8904c',
        id: window.location.pathname,
        repo: 'issue_repository',
        owner: 'Ykuri98',
        admin: 'Ykuri98'
    })
    gitalk.render('gitalk')
</script>
</section>
      </div>
  
</div>
            <div class="nexmoe-post-right">
              <div class="nexmoe-fixed">
                  <div class="nexmoe-tool"> 
                    
                      
                        
                          
                          
                              <button class="mdui-fab catalog" style="overflow:unset;">
                                  <i class="nexmoefont icon-i-catalog"></i>
                                  <div class="nexmoe-toc">
                                      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86"><span class="toc-number">1.</span> <span class="toc-text">åŠ¨æ€ä»£ç†</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#JDK%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86"><span class="toc-number">1.1.</span> <span class="toc-text">JDKåŠ¨æ€ä»£ç†</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Cglib%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86"><span class="toc-number">1.2.</span> <span class="toc-text">CglibåŠ¨æ€ä»£ç†</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#IOC-x2F-DI"><span class="toc-number">2.</span> <span class="toc-text">IOC&#x2F;DI</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#XML"><span class="toc-number">2.1.</span> <span class="toc-text">XML</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B3%A8%E8%A7%A3"><span class="toc-number">2.2.</span> <span class="toc-text">æ³¨è§£</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E7%B1%BB"><span class="toc-number">2.3.</span> <span class="toc-text">é…ç½®ç±»</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Autowired"><span class="toc-number">2.4.</span> <span class="toc-text">@Autowired</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%84%E4%BB%B6%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="toc-number">3.</span> <span class="toc-text">ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#AOP"><span class="toc-number">4.</span> <span class="toc-text">AOP</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%87%E5%85%A5%E7%82%B9Pointcut"><span class="toc-number">4.1.</span> <span class="toc-text">åˆ‡å…¥ç‚¹Pointcut</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%9A%E7%9F%A5%E5%99%A8Advisor"><span class="toc-number">4.2.</span> <span class="toc-text">é€šçŸ¥å™¨Advisor</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%87%E9%9D%A2Aspect"><span class="toc-number">4.3.</span> <span class="toc-text">åˆ‡é¢Aspect</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%9E%E6%8E%A5%E7%82%B9JoinPoint"><span class="toc-number">4.4.</span> <span class="toc-text">è¿æ¥ç‚¹JoinPoint</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Spring%E4%BA%8B%E5%8A%A1"><span class="toc-number">5.</span> <span class="toc-text">Springäº‹åŠ¡</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SpringMVC"><span class="toc-number">6.</span> <span class="toc-text">SpringMVC</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#RequestMapping"><span class="toc-number">6.1.</span> <span class="toc-text">@RequestMapping</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ResponseBody"><span class="toc-number">6.2.</span> <span class="toc-text">@ResponseBody</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0%E7%9A%84%E6%8E%A5%E6%94%B6"><span class="toc-number">6.3.</span> <span class="toc-text">è¯·æ±‚å‚æ•°çš„æ¥æ”¶</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PathVariable"><span class="toc-number">6.4.</span> <span class="toc-text">@PathVariable</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Converter"><span class="toc-number">6.5.</span> <span class="toc-text">Converter</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ResourceHandler"><span class="toc-number">6.6.</span> <span class="toc-text">ResourceHandler</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HandlerInterceptor"><span class="toc-number">6.7.</span> <span class="toc-text">HandlerInterceptor</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86"><span class="toc-number">6.8.</span> <span class="toc-text">å¼‚å¸¸å¤„ç†</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SpringBoot"><span class="toc-number">7.</span> <span class="toc-text">SpringBoot</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B"><span class="toc-number">8.</span> <span class="toc-text">é€†å‘å·¥ç¨‹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#TypeHandler"><span class="toc-number">9.</span> <span class="toc-text">TypeHandler</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Shiro%E6%A1%86%E6%9E%B6"><span class="toc-number">10.</span> <span class="toc-text">Shiroæ¡†æ¶</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Realm"><span class="toc-number">10.1.</span> <span class="toc-text">Realm</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%A4%E8%AF%81"><span class="toc-number">10.2.</span> <span class="toc-text">è®¤è¯</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HibernateValidation"><span class="toc-number">11.</span> <span class="toc-text">HibernateValidation</span></a></li></ol>
                                  </div>
                              </button>
                          
                          
                      
                    
                      <a href="#nexmoe-content" class="toc-link" aria-label="å›åˆ°é¡¶éƒ¨" title="top"><button class="mdui-fab mdui-ripple"><i class="nexmoefont icon-caret-top"></i></button></a>
                  </div>
              </div>
            </div>
        </div>
    </div>
     
    <div id="nexmoe-search-space">
        <div class="search-container">
            <div class="search-header">
                <div class="search-input-container">
                    <input class="search-input" type="text" placeholder="æœç´¢" oninput="sinput();">
                </div>
                <a class="search-close" onclick="sclose();">Ã—</a>
            </div>
            <div class="search-body"></div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/mdui@0.4.3/dist/js/mdui.min.js?v=1"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@4.0/dist/fancybox.umd.js"></script>

 

<script async src="/js/app.js?v=1693554741067"></script>


	<script async src="/js/search.js?v=1693554741067"></script>


<script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js"></script>
<script>
	$(".justified-gallery").justifiedGallery({
		rowHeight: 160,
		margins: 10,
	});
</script>


    





    <!-- baidu Analytics -->
<script>
    var _hmt = _hmt || [];
    (function() {var hm = document.createElement('script');
    hm.src = 'https://hm.baidu.com/hm.js?ed4931f4a887a0876dd7a237254a9600';
    var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/hijiki.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false});</script></body>

</html>
